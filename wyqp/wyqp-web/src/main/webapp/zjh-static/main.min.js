var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),DComponent=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.Sprite);__reflect(DComponent.prototype,"DComponent");var IFrameBase=function(t){function e(){var e=t.call(this)||this;return e._groupName="",e.iframeWidth=0,e.iframeHeight=0,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.init=function(t){void 0===t&&(t=""),this._groupName=t,RES.isGroupLoaded(this._groupName)||""==this._groupName?this.showComplete():(RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup(this._groupName))},e.prototype.hide=function(){this.parent&&this.parent.removeChild(this)},e.prototype.show=function(){},e.prototype.showComplete=function(){},e.prototype.onResourceLoadComplete=function(t){t.groupName==this._groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.showComplete())},e.prototype.onResourceLoadError=function(t){t.groupName==this._groupName&&(console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t))},e.prototype.onResourceProgress=function(t){t.groupName==this._groupName},e}(egret.Sprite);__reflect(IFrameBase.prototype,"IFrameBase");var HashMap=function(){function t(){this._dict=null,this._keyList=null,this._dict={},this._keyList=[]}return t.prototype.put=function(t,e){null!=t?(-1==this._keyList.indexOf(t)&&this._keyList.push(t),this._dict[t]=e):console.log("HashMap::Cannot put a value with undefined or null key!")},t.prototype.remove=function(t){var e=this._keyList.indexOf(t);return this._dict[t]&&delete this._dict[t],this._keyList.splice(e,1)},t.prototype.clear=function(){this._keyList.length=0,this._keyList=[];for(var t in this._dict)delete this._dict[t]},t.prototype.get=function(t){return this._dict[t]},Object.defineProperty(t.prototype,"keys",{get:function(){return this._keyList},enumerable:!0,configurable:!0}),t.prototype.values=function(){for(var t=this.keys.length,e=[],i=0;t>i;i++)e=e.concat(this.get(this.keys[i]));return e},t.prototype.indexOf=function(t){var e=0;for(var i in this._dict){if(this._dict[this._dict[i]]==t)return e;e++}return-1},t.prototype.size=function(){return this._keyList.length},t.prototype.isEmpty=function(){return 0==this._keyList.length},t.prototype.clone=function(){var e=new t;for(var i in this._keyList)e.keys.push(this._keyList[i]),e.put(this._keyList[i],this._dict[this._keyList[i]]);return e},t.prototype.containsKey=function(t){for(var e in this._keyList)if(this._keyList[e]===t)return!0;return!1},t.prototype.containsValue=function(t){for(var e in this._dict)if(this._dict[e]===t)return!0;return!1},t.prototype.toString=function(){var t="HashMap Content:\n";for(var e in this._keyList)t+=e+" -> "+this._dict[this._keyList[e]]+"\n";return t},t}();__reflect(HashMap.prototype,"HashMap");var PlayerView=function(t){function e(){var i=t.call(this)||this;return i._position=0,i._betNum=0,i._status=e.NOT_READY,i.isKanpai=!1,i._isZhuang=!1,i._isFang=!1,i.initView(),i}return __extends(e,t),e.prototype.showRecord=function(t){this._recordIcon.visible=t},e.prototype.updateBetNum=function(t){this._betNum+=t,console.log("this._betNum = "+t),this._goldTF.text="已下："+this._betNum},e.prototype.clearBetNum=function(){this._betNum=0,this._goldTF.text="已下："+this._betNum},e.prototype.updateScore=function(t){void 0==t&&(t=0),this._scoreTF.text="总分："+t.toString()},e.prototype.setOffline=function(t){this._offlineFlag.visible=t},e.prototype.isOffline=function(){return this._offlineFlag.visible},e.prototype.showChatMsg=function(t,e){var i=this;LogUtils.log("showChatMsg::"),this._chatPaopao&&this.contains(this._chatPaopao)&&(egret.Tween.removeTweens(this._chatPaopao),this.removeChild(this._chatPaopao),this._chatPaopao=null),egret.Tween.removeTweens(this._emotionImg),this._emotionImg.visible=!1;var n=0;n=2==this._position||3==this._position||4==this._position||5==this._position||6==this._position?1:0,1==t||3==t?(this._chatPaopao=new ChatPaopao(n),this.addChild(this._chatPaopao),this._chatPaopao.show(e,t),1==n?(this._chatPaopao.x=-53,this._chatPaopao.y=-23):(this._chatPaopao.x=22,this._chatPaopao.y=-23),this._chatPaopao.alpha=1,egret.Tween.get(this._chatPaopao).wait(2e3).to({alpha:0},1e3).call(function(){i.removeChild(i._chatPaopao),i._chatPaopao=null},this)):6==t?this.showRecord(!0):(this._emotionImg.visible=!0,this._emotionImg.texture=RES.getRes("emotion_json."+e),this._emotionImg.alpha=1,this.addChild(this._emotionImg),egret.Tween.get(this._emotionImg).wait(2e3).to({alpha:0},800).call(function(){i._emotionImg.visible=!1},this))},e.prototype.getStatus=function(){return this._status},e.prototype.updateStatus=function(t){this._status=t,this._readyFlag.visible=this._kanpaied.visible=this._giveuped.visible=!1,this._bipaiFail.visible=!1,this.isKanpai=!1,this._cardGroup.alpha=1,t==e.NOT_READY?(this._readyFlag.visible=!1,this._betNum=0,this._goldTF.text="已下："+this._betNum):t==e.READYED?(this._readyFlag.visible=!0,this._betNum=0,this._goldTF.text="已下："+this._betNum):t==e.NOT_LOOK?this._cardGroup.visible=!0:t==e.LOOKED?(this._kanpaied.visible=!0,this.isKanpai=!0,this._cardGroup.visible=!0):t==e.GIVEUP?(this._giveuped.visible=!0,this._cardGroup.visible=!0):t==e.GIVEUP2&&(this._bipaiFail.visible=!0,this._cardGroup.alpha=.5,this._cardGroup.visible=!0)},e.prototype.lookPoker=function(t,e){void 0===e&&(e=!0),void 0!=t&&null!=t&&(this._cardGroup.setPokerData(t),this._cardGroup.showPokerValue(!0,e),t.length>0&&(this.isKanpai=!0))},e.prototype.sayPoker=function(){this._readyFlag.visible=this._kanpaied.visible=this._giveuped.visible=!1,this._cardGroup.visible=!0,this._cardGroup.showPokerValue(!1,!1)},e.prototype.showMyTurn=function(t){this._selectImg.visible=t},e.prototype.reset=function(){this.isKanpai=!1,this._betNum=0,this.isFang=!1,this.isZhuang=!1,this._goldTF.text="",this._nickNameTF.text="...",this._faceImg.texture=RES.getRes("game_json.testFace"),this._faceImg.touchEnabled=!0,this._readyFlag.visible=this._kanpaied.visible=this._giveuped.visible=!1,this._bipaiFail.visible=!1,this._cardGroup.reset(),this._cardGroup.showPokerValue(!1,!1),this.updateScore(0),this._cardGroup.alpha=1,this.updateStatus(e.NOT_READY),this.showRecord(!1),this._isZhuang=!1,this._isFang=!1},Object.defineProperty(e.prototype,"isZhuang",{set:function(t){this._isZhuang=t,this._zhuangFlag.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFang",{set:function(t){this._isFang=t,this._fangFlag.visible=t},enumerable:!0,configurable:!0}),e.prototype.getChipBornPos=function(){return[this.x+this._faceImg.x+.5*this._faceImg.width,this.y+this._faceImg.y+.5*this._faceImg.height]},e.prototype.setData=function(t){this._data=t,this._betNum=0,this._nickNameTF.text=t.nickName;t.order;this.updateStatus(t.status);var e=this._data.headImgUrl;null!=e&&this.loadFace(e)},e.prototype.getData=function(){return this._data},e.prototype.onTouchTap=function(t){if(console.log("onTouchFace...this._data = "+this._data),null!=this._data)if(this._data.playerId==MyUserInfo.getInstance().userId){GameGlobal.iframeLayer.showIFrame(PlayerInfoView);var e=GameGlobal.iframeLayer.getIFrame(PlayerInfoView);e.setData(this._data,!0)}else{GameGlobal.iframeLayer.showIFrame(PlayerInfoView2);var i=GameGlobal.iframeLayer.getIFrame(PlayerInfoView2);i.setData(this._data)}},e.prototype.loadFace=function(t){var e=new egret.ImageLoader;e.addEventListener(egret.Event.COMPLETE,this.imageComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFaceError,this),e.load(t)},e.prototype.onLoadFaceError=function(t){console.log("load face ioerror")},e.prototype.imageComplete=function(t){console.log("load face complete"),this._faceImg.texture=t.target.data,this._faceImg.width=63,this._faceImg.height=61},e.prototype.initView=function(){this._faceBg=new egret.Bitmap,this._faceBg.texture=RES.getRes("game_json.faceBg"),this.addChild(this._faceBg);var t=new egret.Bitmap;t.texture=RES.getRes("game_json.testFace"),t.x=7,t.y=28,this.addChild(t),this._faceImg=new egret.Bitmap,this._faceImg.texture=RES.getRes("game_json.testFace"),this._faceImg.x=7,this._faceImg.y=28,this.addChild(this._faceImg),this._faceImg.touchEnabled=!0,this._faceImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._faceImg.mask=t,this._nickNameTF=new egret.TextField,this._nickNameTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._nickNameTF.size=14,this._nickNameTF.textColor=16777215,this._nickNameTF.textAlign=egret.HorizontalAlign.CENTER,this._nickNameTF.width=64,this._nickNameTF.x=6,this._nickNameTF.y=4,this.addChild(this._nickNameTF),this._nickNameTF.text="...",this._nickNameTF.lineSpacing=5,this._goldTF=new egret.TextField,this._goldTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._goldTF.size=16,this._goldTF.textColor=16767830,this._goldTF.textAlign=egret.HorizontalAlign.CENTER,this._goldTF.width=64,this._goldTF.x=6,this._goldTF.y=91,this.addChild(this._goldTF),this._goldTF.text="",this._scoreTF=new egret.TextField,this._scoreTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._scoreTF.size=16,this._scoreTF.textColor=16767830,this._scoreTF.textAlign=egret.HorizontalAlign.CENTER,this._scoreTF.width=92,this._scoreTF.x=2,this._scoreTF.y=this._goldTF.y+this._goldTF.height+15,this.addChild(this._scoreTF),this._scoreTF.text="总分：0",this._emotionImg=new egret.Bitmap,this.addChild(this._emotionImg),this._emotionImg.scaleX=this._emotionImg.scaleY=.5,this._emotionImg.anchorOffsetX=15,this._emotionImg.anchorOffsetY=15,this._emotionImg.x=this._faceImg.x+.5*this._faceImg.width,this._emotionImg.y=this._faceImg.y+.5*this._faceImg.height,this._emotionImg.touchEnabled=!1,this._fangFlag=new egret.Bitmap,this._fangFlag.texture=RES.getRes("game_json.fangka2"),this.addChild(this._fangFlag),this._fangFlag.visible=!1,this._zhuangFlag=new egret.Bitmap,this._zhuangFlag.texture=RES.getRes("game_json.zhuang_icon"),this.addChild(this._zhuangFlag),this._zhuangFlag.x=10,this._zhuangFlag.y=28,this._zhuangFlag.visible=!1,this._fangFlag.x=46,this._fangFlag.y=-24,this._selectImg=new egret.Bitmap,this.addChild(this._selectImg),this._selectImg.texture=RES.getRes("game_json.selectPlayerBg"),this._selectImg.scaleX=this._selectImg.scaleY=90/161,this._selectImg.x=-9,this._selectImg.y=-7,this._selectImg.visible=!1,egret.Tween.get(this._selectImg,{loop:!0}).to({alpha:0},800).to({alpha:1},800),this._selectImg.touchEnabled=!1,this._readyFlag=new egret.Bitmap,this._readyFlag.texture=RES.getRes("game_json.readyed2"),this._readyFlag.x=40,this._readyFlag.y=73,this.addChild(this._readyFlag),this._readyFlag.visible=!1,this._cardGroup=new CardGroup,this.addChild(this._cardGroup),this._cardGroup.x=85,this._cardGroup.y=36,this._cardGroup.visible=!1,this.addChild(this._faceImg),this.addChild(this._emotionImg),this.addChild(this._nickNameTF),this.addChild(this._zhuangFlag),this.addChild(this._fangFlag),this.addChild(this._selectImg),this.addChild(this._readyFlag),this._kanpaied=new egret.Bitmap,this.addChild(this._kanpaied),this._kanpaied.texture=RES.getRes("game_json.kanpaied"),this._kanpaied.scaleX=this._kanpaied.scaleY=.8,this._giveuped=new egret.Bitmap,this.addChild(this._giveuped),this._giveuped.texture=RES.getRes("game_json.giveuped"),this._giveuped.scaleX=this._giveuped.scaleY=.8,this._bipaiFail=new egret.Bitmap,this.addChild(this._bipaiFail),this._bipaiFail.scaleX=this._bipaiFail.scaleY=.8,this._bipaiFail.texture=RES.getRes("game_json.bipaiFail"),this._offlineFlag=new egret.Bitmap,this.addChild(this._offlineFlag),this._offlineFlag.texture=RES.getRes("game_json.offlineFlag"),this._offlineFlag.scaleX=this._offlineFlag.scaleY=.5,this._offlineFlag.anchorOffsetX=.5*this._offlineFlag.width,this._offlineFlag.anchorOffsetY=.5*this._offlineFlag.height,this._offlineFlag.x=this.x+this._faceImg.x+.5*this._faceImg.width,this._offlineFlag.y=this.y+this._faceImg.y+.5*this._faceImg.height,this._offlineFlag.visible=!1,this._recordIcon=new egret.Bitmap,this._recordIcon.texture=RES.getRes("game_json.yuyinIcon"),this.addChild(this._recordIcon),this._recordIcon.x=this._faceBg.x+10+this._faceBg.width,this._recordIcon.y=this._faceBg.y+this._faceBg.height-10,this._recordIcon.visible=!1,this._kanpaied.x=this._cardGroup.x+(this._cardGroup.width-96>>1),this._kanpaied.y=77,this._giveuped.x=this._cardGroup.x+(this._cardGroup.width-96>>1),this._giveuped.y=77,this._bipaiFail.x=this._cardGroup.x+(this._cardGroup.width-96>>1),this._bipaiFail.y=77,this._kanpaied.visible=this._bipaiFail.visible=this._giveuped.visible=!1},e.WATCHER=0,e.NOT_READY=1,e.READYED=2,e.NOT_LOOK=3,e.LOOKED=4,e.GIVEUP=5,e.GIVEUP2=6,e}(egret.Sprite);__reflect(PlayerView.prototype,"PlayerView");var qr;!function(t){var e=function(){function e(t,e){this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}return e.prototype.addData=function(e){var i=new t.QR8bitByte(e);this.dataList.push(i),this.dataCache=null},e.prototype.isDark=function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},e.prototype.getModuleCount=function(){return this.moduleCount},e.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},e.prototype.makeImpl=function(t,i){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++)this.modules[n][a]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,i),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,i)},e.prototype.setupPositionProbePattern=function(t,e){for(var i=-1;7>=i;i++)if(!(-1>=t+i||this.moduleCount<=t+i))for(var n=-1;7>=n;n++)-1>=e+n||this.moduleCount<=e+n||(i>=0&&6>=i&&(0==n||6==n)||n>=0&&6>=n&&(0==i||6==i)||i>=2&&4>=i&&n>=2&&4>=n?this.modules[t+i][e+n]=!0:this.modules[t+i][e+n]=!1)},e.prototype.getBestMaskPattern=function(){for(var e=0,i=0,n=0;8>n;n++){this.makeImpl(!0,n);var a=t.QRUtil.getLostPoint(this);(0==n||e>a)&&(e=a,i=n)}return i},e.prototype.createMovieClip=function(t,e,i){var n=t.createEmptyMovieClip(e,i),a=1;this.make();for(var s=0;s<this.modules.length;s++)for(var o=s*a,r=0;r<this.modules[s].length;r++){var h=r*a,l=this.modules[s][r];l&&(n.beginFill(0,100),n.moveTo(h,o),n.lineTo(h+a,o),n.lineTo(h+a,o+a),n.lineTo(h,o+a),n.endFill())}return n},e.prototype.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},e.prototype.setupPositionAdjustPattern=function(){for(var e=t.QRUtil.getPatternPosition(this.typeNumber),i=0;i<e.length;i++)for(var n=0;n<e.length;n++){var a=e[i],s=e[n];if(null==this.modules[a][s])for(var o=-2;2>=o;o++)for(var r=-2;2>=r;r++)-2==o||2==o||-2==r||2==r||0==o&&0==r?this.modules[a+o][s+r]=!0:this.modules[a+o][s+r]=!1}},e.prototype.setupTypeNumber=function(e){for(var i=t.QRUtil.getBCHTypeNumber(this.typeNumber),n=0;18>n;n++){var a=!e&&1==(i>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=a}for(var n=0;18>n;n++){var a=!e&&1==(i>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=a}},e.prototype.setupTypeInfo=function(e,i){for(var n=this.errorCorrectLevel<<3|i,a=t.QRUtil.getBCHTypeInfo(n),s=0;15>s;s++){var o=!e&&1==(a>>s&1);6>s?this.modules[s][8]=o:8>s?this.modules[s+1][8]=o:this.modules[this.moduleCount-15+s][8]=o}for(var s=0;15>s;s++){var o=!e&&1==(a>>s&1);8>s?this.modules[8][this.moduleCount-s-1]=o:9>s?this.modules[8][15-s-1+1]=o:this.modules[8][15-s-1]=o}this.modules[this.moduleCount-8][8]=!e},e.prototype.mapData=function(e,i){for(var n=-1,a=this.moduleCount-1,s=7,o=0,r=this.moduleCount-1;r>0;r-=2)for(6==r&&r--;;){for(var h=0;2>h;h++)if(null==this.modules[a][r-h]){var l=!1;o<e.length&&(l=1==(e[o]>>>s&1));var c=t.QRUtil.getMask(i,a,r-h);c&&(l=!l),this.modules[a][r-h]=l,s--,-1==s&&(o++,s=7)}if(a+=n,0>a||this.moduleCount<=a){a-=n,n=-n;break}}},e.createData=function(i,n,a){for(var s=t.QRRSBlock.getRSBlocks(i,n),o=new t.QRBitBuffer,r=0;r<a.length;r++){var h=a[r];o.put(h.mode,4),o.put(h.getLength(),t.QRUtil.getLengthInBits(h.mode,i)),h.write(o)}for(var l=0,r=0;r<s.length;r++)l+=s[r].dataCount;if(o.getLengthInBits()>8*l)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+8*l+")");for(o.getLengthInBits()+4<=8*l&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*l)&&(o.put(e.PAD0,8),!(o.getLengthInBits()>=8*l));)o.put(e.PAD1,8);return e.createBytes(o,s)},e.createBytes=function(e,i){for(var n=0,a=0,s=0,o=new Array(i.length),r=new Array(i.length),h=0;h<i.length;h++){var l=i[h].dataCount,c=i[h].totalCount-l;a=Math.max(a,l),s=Math.max(s,c),o[h]=new Array(l);for(var d=0;d<o[h].length;d++)o[h][d]=255&e.buffer[d+n];n+=l;var _=t.QRUtil.getErrorCorrectPolynomial(c),g=new t.QRPolynomial(o[h],_.getLength()-1),u=g.mod(_);r[h]=new Array(_.getLength()-1);for(var d=0;d<r[h].length;d++){var p=d+u.getLength()-r[h].length;r[h][d]=p>=0?u.get(p):0}}for(var m=0,d=0;d<i.length;d++)m+=i[d].totalCount;for(var f=new Array(m),T=0,d=0;a>d;d++)for(var h=0;h<i.length;h++)d<o[h].length&&(f[T++]=o[h][d]);for(var d=0;s>d;d++)for(var h=0;h<i.length;h++)d<r[h].length&&(f[T++]=r[h][d]);return f},e.PAD0=236,e.PAD1=17,e}();t.QRCodeModel=e,__reflect(e.prototype,"qr.QRCodeModel")}(qr||(qr={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function a(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var AlertView=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.setConfirmCallBack=function(t,e){this._confirmCallBackFun=t,this._thisObj=e},e.prototype.setCancelCallBack=function(t,e){this._cancelCallBackFun=t,this._thisObj=e},e.prototype.show=function(t,i){void 0===i&&(i=e.ALERT_MODE),this._messageTF.text=t,GameGlobal.stage.addChild(this),i==e.ALERT_MODE?(this._confirmBtn2.visible=!0,this._cancelBtn.visible=this._confirmBtn.visible=!1):(this._confirmBtn2.visible=!1,this._cancelBtn.visible=this._confirmBtn.visible=!0)},e.prototype.hide=function(){this.stage&&GameGlobal.stage.removeChild(this),this._confirmCallBackFun=null,this._cancelCallBackFun=null},e.prototype.initView=function(){var t=this;this._bg=new egret.Shape,this._bg.graphics.beginFill(0,.5),this._bg.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),this._bg.graphics.endFill(),this.addChild(this._bg);var e=new egret.Sprite;this.addChild(e),this._kuang=new egret.Bitmap,this._kuang.texture=RES.getRes("alertBg_png"),e.addChild(this._kuang),this._messageTF=new egret.TextField,this._messageTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._messageTF.multiline=!0,this._messageTF.height=158,this._messageTF.width=405,this._messageTF.wordWrap=!0,this._messageTF.textAlign=egret.HorizontalAlign.CENTER,this._messageTF.size=25,this._messageTF.textColor=6502154,this._messageTF.y=127,this._messageTF.x=56,this._messageTF.text="系统提示",e.addChild(this._messageTF),this._messageTF.lineSpacing=8,this._confirmBtn=new egret.Bitmap,this._confirmBtn.texture=RES.getRes("ui_json.confirmBtn"),this._confirmBtn.x=107,this._confirmBtn.y=291,e.addChild(this._confirmBtn),this._confirmBtn.touchEnabled=!0,this._confirmBtn2=new egret.Bitmap,this._confirmBtn2.texture=RES.getRes("ui_json.confirmBtn"),this._confirmBtn2.x=360,this._confirmBtn2.y=291,e.addChild(this._confirmBtn2),this._confirmBtn2.touchEnabled=!0,this._confirmBtn2.visible=!1,this._cancelBtn=new egret.Bitmap,this._cancelBtn.texture=RES.getRes("ui_json.cancelBtn"),this._cancelBtn.x=293,this._cancelBtn.y=291,e.addChild(this._cancelBtn),this._cancelBtn.touchEnabled=!0,this._cancelBtn.visible=!1,this._confirmBtn2.x=.5*(e.width-this._confirmBtn2.width),e.x=GameGlobal.stageW-e.width>>1,e.y=164,this._confirmBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){null!=t._confirmCallBackFun&&t._confirmCallBackFun.call(t._thisObj),t.hide()},this),this._cancelBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){null!=t._cancelCallBackFun&&t._cancelCallBackFun.call(t._thisObj),t.hide()},this),this._confirmBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){null!=t._confirmCallBackFun&&t._confirmCallBackFun.call(t._thisObj),t.hide()},this),this.touchEnabled=!0},e.ALERT_MODE=1,e.CONFIRM_MODE=2,e._instance=null,e}(egret.Sprite);__reflect(AlertView.prototype,"AlertView");var DataLoading=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.show=function(){GameGlobal.stage.addChild(this)},e.prototype.hide=function(){this.stage&&GameGlobal.stage.removeChild(this)},e.prototype.initView=function(){this._bg=new egret.Shape,this._bg.graphics.beginFill(0,.1),this._bg.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),this._bg.graphics.endFill(),this.addChild(this._bg),this.touchEnabled=!0,this._icon2=new egret.Bitmap,this._icon2.texture=RES.getRes("dataLoading_png"),this.addChild(this._icon2),this._icon2.anchorOffsetX=.5*this._icon2.width,this._icon2.anchorOffsetY=.5*this._icon2.height,this._icon2.x=.5*GameGlobal.stage.stageWidth,this._icon2.y=.5*GameGlobal.stage.stageHeight,egret.Tween.get(this._icon2,{loop:!0}).to({rotation:360},800)},e._instance=null,e}(egret.Sprite);__reflect(DataLoading.prototype,"DataLoading");var DButton=function(t){function e(e,i){void 0===i&&(i="");var n=t.call(this)||this;return n._disableSkinName="",n._defaultSkinName="",n._isEnabled=!0,n._defaultSkinName=e,n._disableSkinName=i,n._skin=new egret.Bitmap(RES.getRes(e)),n.addChild(n._skin),n.touchEnabled=!0,n.touchChildren=!1,n.addEventListener(egret.TouchEvent.TOUCH_TAP,n.onTouchTap,n),n}return __extends(e,t),e.prototype.onTouchTap=function(t){try{SoundManager.instance.playSound("button_mp3")}catch(e){}},e.prototype.setEnabled=function(t){this._isEnabled=t,this._isEnabled?this._skin.texture=RES.getRes(this._defaultSkinName):this._skin.texture=RES.getRes(this._disableSkinName),this.touchEnabled=this.touchChildren=t},e.prototype.isEnabled=function(){return this._isEnabled},e.prototype.setSkin=function(t,e){void 0===e&&(e=""),this._defaultSkinName=t,this._disableSkinName=e,this._skin.texture=RES.getRes(t),this.setEnabled(this._isEnabled)},e}(DComponent);__reflect(DButton.prototype,"DButton");var DCheckBox=function(t){function e(){var e=t.call(this)||this;return e._selected=!1,e._chkImgName="ui_json.check-xieyi-icon2",e._chkImgName2="ui_json.check-xieyi-icon",e.initView(),e}return __extends(e,t),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected=t,this._skin.texture=this._selected?RES.getRes(this._chkImgName):RES.getRes(this._chkImgName2)},enumerable:!0,configurable:!0}),e.prototype.setLabel=function(t,e,i,n){void 0===e&&(e=!0),void 0===i&&(i=1),void 0===n&&(n=-1),e?(this._label.texture=RES.getRes(t),this._label.x=i,this._label.y=n):(null==this._labelTF&&(this._labelTF=new egret.TextField),this._labelTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._labelTF.textColor=9063179,this._labelTF.size=21,this._labelTF.textAlign=egret.HorizontalAlign.LEFT,this._labelTF.x=i,this._labelTF.y=n,this._labelTF.text=t,this.addChild(this._labelTF),this._touchAreShape.width=this._labelTF.textWidth+this._label.x,this._touchAreShape.y=2*-this._skin.height*.5,this._touchAreShape.x=.5*-this._touchAreShape.width)},e.prototype.setSkin=function(t,e){this._chkImgName=t,this._chkImgName2=e,this._skin.texture=RES.getRes(t)},e.prototype.initView=function(){var t=this;this.touchEnabled=!0,this._skin=new egret.Bitmap,this._skin.texture=RES.getRes(this._chkImgName2),this.addChild(this._skin),this._label=new egret.Bitmap,this._label.x=34,this._label.y=0,this.addChild(this._label),this._touchAreShape=new egret.Shape,this._touchAreShape.graphics.beginFill(0),this._touchAreShape.graphics.drawRect(0,0,100,2*this._skin.height),this._touchAreShape.graphics.endFill(),this.addChild(this._touchAreShape),this._touchAreShape.alpha=0,this._touchAreShape.y=2*-this._skin.height*.5,this._touchAreShape.x=-50,this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.selected=!t.selected,t.dispatchEvent(new DEvent(GameEventManager.SELECTED))},this)},e}(DComponent);__reflect(DCheckBox.prototype,"DCheckBox");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?n(a):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var DGoldValue=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.setValue=function(t){this._valueTF.text=t.toString()},e.prototype.setType=function(t){void 0===t&&(t=0),t==e.DIAMOND?this._iconImg.texture=RES.getRes("main_json.diamondIcon"):this._iconImg.texture=RES.getRes("main_json.moneyIcon")},e.prototype.initView=function(){this._bg=new egret.Bitmap,this.addChild(this._bg),this._bg.x=5,this._bg.y=1,this._bg.texture=RES.getRes("main_json.goldValueBg"),this._iconImg=new egret.Bitmap,this.addChild(this._iconImg),this._iconImg.texture=RES.getRes("main_json.moneyIcon"),this._iconImg.x=0,this._iconImg.y=1,this._valueTF=new egret.TextField,this._valueTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._valueTF.size=24,this._valueTF.textColor=16777215,this.addChild(this._valueTF),this._valueTF.textAlign=egret.HorizontalAlign.CENTER,this._valueTF.text="0",this._valueTF.width=126,this._valueTF.x=42,this._valueTF.y=7,this._addBtn=new egret.Bitmap,this._addBtn.touchEnabled=!0,this.addChild(this._addBtn),this._addBtn.x=162,this._addBtn.y=0,this._addBtn.texture=RES.getRes("main_json.main_addicon"),this._addBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onTouchTap=function(t){AlertView.getInstance().show("开发中，敬请期待！")},e.GOLD=0,e.DIAMOND=1,e}(egret.Sprite);__reflect(DGoldValue.prototype,"DGoldValue");var DProgressBar=function(t){function e(){var e=t.call(this)||this;return e._maxValue=100,e._value=0,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this._background=new egret.Bitmap,this._background.texture=RES.getRes("sz_jd_1a_png"),this.addChild(this._background),this._foreground=new egret.Bitmap,this._foreground.texture=RES.getRes("sz_jd_1b_png"),this.addChild(this._foreground),this._maskImg=new egret.Shape,this._maskImg.graphics.beginFill(0,1),this._maskImg.graphics.drawRect(0,0,this._foreground.width,40),this._maskImg.graphics.endFill(),this.addChild(this._maskImg),this._maskImg.x=7,this._maskImg.y=5,this._foreground.x=7,this._foreground.y=5,this._foreground.mask=this._maskImg},e.prototype.setMaxValue=function(t){this._maxValue=t},e.prototype.setValue=function(t,e){void 0===e&&(e=100),this._value=t,this._maxValue=e;var i=this._value/this._maxValue;this._maskImg.scaleX=i},e}(DComponent);__reflect(DProgressBar.prototype,"DProgressBar");var DToggleButton=function(t){function e(){var e=t.call(this)||this;return e._selected=!0,e.initView(),e}return __extends(e,t),Object.defineProperty(e.prototype,"isSelected",{get:function(){return this._selected},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this._bg=new egret.Bitmap,this.addChild(this._bg),this._bg.texture=RES.getRes("ui_json.toggleOn"),this._bg2=new egret.Bitmap,this.addChild(this._bg2),this._bg2.texture=RES.getRes("ui_json.toggleOff"),this._bg2.visible=!1,this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onTouchTap=function(t){this._selected=!this._selected,this._selected?(this._bg.visible=!0,this._bg2.visible=!1):(this._bg.visible=!1,this._bg2.visible=!0),this.dispatchEvent(new DEvent(DEvent.CHANGE))},e}(DComponent);__reflect(DToggleButton.prototype,"DToggleButton");var MessagePop=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.show=function(t){var i;i=e.pool.length>0?e.pool.pop():new e,i&&(i.show(t),GameGlobal.topLayer.addChild(i))},e.prototype.show=function(t){this.y=GameGlobal.stage.stageHeight-this.height>>1,this.alpha=1,egret.Tween.get(this).wait(1e3).to({y:this.y-100,alpha:0},1e3,egret.Ease.quadIn).call(this.tweenEnd,this)},e.prototype.tweenEnd=function(){this.parent&&(this.parent.removeChild(this),e.pool.push(this))},e.prototype.initView=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("messageBg_png"),this.addChild(this._bg),this._contentTF=new egret.TextField,this._contentTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._contentTF.textColor=0,this._contentTF.size=30,this._contentTF.text="message...",this.addChild(this._contentTF)},e.pool=[],e}(DComponent);__reflect(MessagePop.prototype,"MessagePop");var NumImg=function(t){function e(){var e=t.call(this)||this;return e._type=1,e._num=0,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this._img=new egret.Bitmap,this.addChild(this._img)},e.prototype.setNum=function(t,e){this._num=e,this._img.texture=RES.getRes("num_json.num"+t+"_"+e)},e}(egret.Sprite);__reflect(NumImg.prototype,"NumImg");var Dstrings=function(){function t(){}return t.TXT_PRESTR1="请输入",t.TXT_INPUTTIP_PHONE="已注册手机号",t.TXT_INPUTTIP_CERTNO="已绑定的身份证编号",t.TXT_INPUTTIP_VERRIFYCODE="验证码",t.TXT_INPUTTIP_PASSWRORD="登录密码",t.TXT_INPUTTIP_REPEATPASSWRORD="确认登录密码",t.TXT_INPUTTIP_WRONGREPEATPASSWRORD="确认登陆密码有误",t.TXT_INPUTTIP_WRONGPASSWRORD="两次密码输入不一致",t.TXT_INPUTTIP_FAILPASSBACK="找回密码失败",t.TXT_INPUTTIP_FAILSMD="获取短信验证码失败",t}();__reflect(Dstrings.prototype,"Dstrings");var Card=function(){function t(t,e){this._num=0,this._color=0,this._num=t,this._color=e}return t.prototype.setNum=function(t){this._num=t},t.prototype.getNum=function(){return this._num},t.prototype.setColor=function(t){this._color=t},t.prototype.getColor=function(){return this._color},t.HEITAO=4,t.HONGTAO=3,t.MEIHUA=2,t.FANGKUAI=1,t.NUM_A=14,t.NUM_K=13,t.NUM_Q=12,t.NUM_J=11,t.NUM_10=10,t.NUM_9=9,t.NUM_8=8,t.NUM_7=7,t.NUM_6=6,t.NUM_5=5,t.NUM_4=4,t.NUM_3=3,t.NUM_2=2,t}();__reflect(Card.prototype,"Card");var GameRule=function(){function t(){}return t.getBombValue=function(t){return t.cards[0].getNum()+PlayerType.STRAIGHT_FLUSH_MAX_VALUE},t.getStraightFlushValue=function(t){return t.isA32()?1+PlayerType.FLUSH_MAX_VALUE:t.cards[2].getNum()+PlayerType.FLUSH_MAX_VALUE},t.getFlushValue=function(t){return 256*t.cards[0].getNum()+16*t.cards[1].getNum()+t.cards[2].getNum()+PlayerType.STRAIGHT_MAX_VALUE
},t.getStraightValue=function(t){return t.isA32()?1+PlayerType.DOUBLE_MAX_VALUE:t.cards[2].getNum()+PlayerType.DOUBLE_MAX_VALUE},t.getDoubleValue=function(t){return 16*t.cards[1].getNum()+t.cards[2].getNum()+PlayerType.NORMAL_MAX_VALUE},t.getNormalValue=function(t){return 256*t.cards[0].getNum()+16*t.cards[1].getNum()+t.cards[2].getNum()},t.isFlush=function(t){return t.cards[0].getColor()==t.cards[1].getColor()&&t.cards[1].getColor()==t.cards[2].getColor()},t.isStraight=function(t){var e=t.cards[0].getNum()==t.cards[1].getNum()+1&&t.cards[1].getNum()==t.cards[2].getNum()+1,i=t.cards[0].getNum()==Card.NUM_A&&t.cards[1].getNum()==Card.NUM_3&&t.cards[2].getNum()==Card.NUM_2;return i&&t.setA32(!0),e||i},t.isBomb=function(t){return t.cards[0].getNum()==t.cards[1].getNum()&&t.cards[1].getNum()==t.cards[2].getNum()},t.isDouble=function(t){return t.cards[0].getNum()==t.cards[1].getNum()||t.cards[1].getNum()==t.cards[2].getNum()},t.isSpecial=function(t){return t.cards[0].getNum()==Card.NUM_5&&t.cards[1].getNum()==Card.NUM_3&&t.cards[2].getNum()==Card.NUM_2},t}();__reflect(GameRule.prototype,"GameRule");var Player=function(){function t(){this.cards=new Array(3),this._cardType=0,this._isSpecial=!1,this._isA32=!1,this._value=0}return t.prototype.setCards=function(t,e,i){this.cards[0]=t,this.cards[1]=e,this.cards[2]=i},t.prototype.isA32=function(){return this._isA32},t.prototype.setA32=function(t){this._isA32=t},t.prototype.setValue=function(t){this._value=t},t.prototype.getValue=function(){return this._value},t.prototype.isSpecial=function(){return this._isSpecial},t.prototype.setSpecial=function(t){this._isSpecial=t},t.prototype.getCardType=function(){return this._cardType},t.prototype.setCardType=function(t){this._cardType=t},t}();__reflect(Player.prototype,"Player");var PlayerType=function(){function t(){}return t.getPokerTypeName=function(e){var i="普通牌";switch(e){case t.NORMAL:i="普通牌";break;case t.DOUBLE:i="对子";break;case t.STRAIGHT:i="顺子";break;case t.FLUSH:i="金花";break;case t.STRAIGHT_FLUSH:i="同花顺";break;case t.BOMB:i="豹子"}return i},t.BOMB=7,t.BOMB_MAX_VALUE=7881,t.STRAIGHT_FLUSH=6,t.STRAIGHT_FLUSH_MAX_VALUE=7867,t.FLUSH=5,t.FLUSH_MAX_VALUE=7855,t.STRAIGHT=4,t.STRAIGHT_MAX_VALUE=4052,t.DOUBLE=3,t.DOUBLE_MAX_VALUE=4040,t.NORMAL=2,t.NORMAL_MAX_VALUE=3803,t}();__reflect(PlayerType.prototype,"PlayerType");var PlayerUtils=function(){function t(){}return t.sortCardByValue=function(t){for(var e=0;3>e;e++)for(var i=0;3-e-1>i;i++){var n=t.cards[i].getNum(),a=t.cards[i+1].getNum();if(a>n){var s=t.cards[i];t.cards[i]=t.cards[i+1],t.cards[i+1]=s}}},t.sortCardByColor=function(t){for(var e=0;3>e;e++)for(var i=0;3-e-1>i;i++){var n=t.cards[i].getColor(),a=t.cards[i+1].getColor();if(a>n){var s=t.cards[i];t.cards[i]=t.cards[i+1],t.cards[i+1]=s}}},t.moveDouble2Front=function(t){if(t.cards[1].getNum()==t.cards[2].getNum()){var e=t.cards[0];t.cards[0]=t.cards[2],t.cards[2]=e}},t.exchangeSortedDoubleFlower=function(t){if(t.cards[0].getColor()<t.cards[1].getColor()){var e=t.cards[0];t.cards[0]=t.cards[1],t.cards[1]=e}},t}();__reflect(PlayerUtils.prototype,"PlayerUtils");var GameModel=function(t){function e(){var e=t.call(this)||this;return e.fromUserId="",e.fromRoomId="",e.token="",e.code="",e.deviceType="android",e.roomId=0,e.myOrder=1,e.testRoomData={roomId:498286,roomOwnerId:1004,curPlayerId:1004,roomBankerId:1005,totalGames:10,curGame:2,stakeButtom:1,stakeLimit:10,stakeTimesLimit:30,payType:2,status:2,playerList:[{playerId:1004,headImgUrl:"http://wx.qlogo.cn/mmopen/v6XbW38nFORhJxJWNL96oIUwnHe0XNhiaURbbcNgqdQQ7icqklNRQcyiaZ4DGGibgZV5VWNZ9Jo6mnFGKx7FEt0Cb5m04P0KrrOA/0",nickName:"陶教主",order:1,level:1,status:4,cardList:[{cardSuit:3,cardSuitName:"红桃",cardValue:3,cardIndex:27},{cardSuit:2,cardSuitName:"梅花",cardValue:6,cardIndex:17},{cardSuit:1,cardSuitName:"方块",cardValue:10,cardIndex:8}],curStakeScore:0,totalScore:-1,stakeTimes:0,roomCardNum:10},{playerId:1005,headImgUrl:"http://wx.qlogo.cn/mmopen/wibbRT31wkCT6RaBQYwZjyYt871hHuMm3ymOd0yo3e0Cg3hzkibTiafHJXxkXIWXkia3piaeEbmoxlTSLSWoEpda7bJNu4e6aJjat/0",nickName:"13092743889",order:2,level:1,status:4,curStakeScore:0,totalScore:1,stakeTimes:0,roomCardNum:10}]},e}return __extends(e,t),e.instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}(egret.EventDispatcher);__reflect(GameModel.prototype,"GameModel");var MyUserInfo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.longitude="",e.latitude="",e.city="",e.mySideId=0,e._userName="",e._gender=0,e._lv=1,e._exp=0,e._gold=0,e._diamond=0,e._userId="",e._ip="127.0.0.1",e._mobile="",e._faceUrl="",e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},Object.defineProperty(e.prototype,"userName",{get:function(){return this._userName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gender",{get:function(){return this._gender},set:function(t){this._gender=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._lv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exp",{get:function(){return this._exp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gold",{get:function(){return this._gold},set:function(t){this._gold=t,GameEventManager.dispatchEvent(GameEventManager.UPDATE_USER_GOLD)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diamond",{get:function(){return this._diamond},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userId",{get:function(){return this._userId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ip",{get:function(){return this._ip},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mobile",{get:function(){return this._mobile},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"faceUrl",{get:function(){return this._faceUrl},set:function(t){this._faceUrl=t},enumerable:!0,configurable:!0}),e.prototype.init=function(t){null!=t&&(this._userId=t.playerId,this._userName=t.nickName,this._gold=t.roomCardNum,this._faceUrl=t.headImgUrl,this._lv=t.level)},e}(egret.EventDispatcher);__reflect(MyUserInfo.prototype,"MyUserInfo");var ClientDB=function(){function t(){this._database=new HashMap}return Object.defineProperty(t,"instance",{get:function(){return null==t._instance?t._instance=new t:t._instance},enumerable:!0,configurable:!0}),t.prototype.initDB=function(t){for(t.position=0,t.endian=egret.Endian.LITTLE_ENDIAN;t.bytesAvailable>0;){var e=t.readInt(),i=t.readInt(),n=t.readUTFBytes(e),a=t.readUTFBytes(i);this._database.put(n,a)}t.length=0},t.prototype.read=function(t){var e=this._database.get(t);return e instanceof String&&(e=JSON.parse(e),this._database.put(t,e)),e},t}();__reflect(ClientDB.prototype,"ClientDB");var DBGlobal=function(){function t(){}return t.getDbValue=function(t,e){var i=ClientDB.instance.read(t);return i[e]},t.getDbAsHashmap=function(t,e,i,n,a){void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=null);var s,o,r=egret.getTimer(),h=new HashMap,l=ClientDB.instance.read(t),c=l;if(null!=i&&""!=i){c=l[i],null!=n&&""!=n&&(c=c[n]);for(s in c)o=c[s],h.put(o[e],o)}else for(s in c){o=c[s];for(var d in o){var _=o[d];_[e]&&h.put(_[e],_)}}egret.getTimer()-r;return h},t}();__reflect(DBGlobal.prototype,"DBGlobal");var DBMessageData=function(){function t(){}return t}();__reflect(DBMessageData.prototype,"DBMessageData");var DBServerMessage=function(){function t(){}return t.getData=function(t){var e="系统错误";switch(t){case 10001:e="登陆账号不存在";break;case 10002:e="登陆密码错误";break;case 10003:e="写入token不成功，登陆失败";break;case 10011:e="注册账号已存在";break;case 10012:e="注册失败";break;case 10021:e="排队不成功，没有登陆";break;case 10022:e="排队不成功，userId不存在";break;case 10023:e="离开排队不成功，没有登陆";break;case 10024:e="创建房间或加入房间失败，参数不正确";break;case 10025:e="加入房间失败，房间未找到";break;case 10026:e="加入房间失败，房间人满";break;case 10027:e="匹配类型不存在或已禁用";break;case 10031:e="找不到房间信息，非正常请求可能发生";break;case 10033:e="已经在房间中，不能反复加入";break;case 10034:e="还有人没加入，不能点准备";break;case 10035:e="还没开局，不能进行操作";break;case 10036:e="找不到玩家信息，非正常请求可能发生";break;case 10037:e="没有房间ID，非正常请求可能发生";break;case 10038:e="没轮到你抢地主，或已经不在抢地主阶段";break;case 10039:e="没轮到你叫分，或已经不在叫分阶段";break;case 10041:e="当前不由你出牌";break;case 10042:e="不能再pass了";break;case 10043:e="牌型错误";break;case 10044:e="牌型不一致";break;case 10045:e="不大于上家";break;case 10046:e="迷之出牌错误"}return e},t.NORMAL=0,t}();__reflect(DBServerMessage.prototype,"DBServerMessage");var DBTest=function(){function t(){}return Object.defineProperty(t,"db",{get:function(){return null==t._db&&(t._db=DBGlobal.getDbAsHashmap("DescriptionDic","Idx","ActiveInfoEntity")),t._db},enumerable:!0,configurable:!0}),t.allIds=function(){return t.db.keys},t.getData=function(e){if(!t.db.containsKey(e))return null;var i=t.db.get(e);if(i instanceof DBTestData)return i;var n=new DBTestData(i);return t.db.put(e,n),n},t}();__reflect(DBTest.prototype,"DBTest");var DBTestData=function(){function t(t){}return t}();__reflect(DBTestData.prototype,"DBTestData");var DBitmap=function(t){function e(e,i,n,a,s){void 0===i&&(i=!1),void 0===n&&(n=null),void 0===a&&(a=0),void 0===s&&(s=0);var o=t.call(this)||this;return o.texture=RES.getRes(e),o.anchorOffsetX=.5*o.width,o.anchorOffsetY=.5*o.height,o.x=a,o.y=s,o.touchEnabled=i,n&&o.addEventListener(egret.TouchEvent.TOUCH_TAP,n,o),o.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){var e=t.currentTarget;e.scaleX=e.scaleY=.9},o),o.addEventListener(egret.TouchEvent.TOUCH_END,function(t){var e=t.currentTarget;e.scaleX=e.scaleY=1},o),o.addEventListener(egret.TouchEvent.TOUCH_CANCEL,function(t){var e=t.currentTarget;e.scaleX=e.scaleY=1},o),o.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(t){var e=t.currentTarget;e.scaleX=e.scaleY=1},o),o}return __extends(e,t),e}(egret.Bitmap);__reflect(DBitmap.prototype,"DBitmap");var DSprite=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getClientProperty=function(t){return null==this.clientProperty?null:this.clientProperty.get(t)},e.prototype.putClientProperty=function(t,e){null==this.clientProperty&&(this.clientProperty=new HashMap),this.clientProperty.put(t,e)},e.prototype.removeAllClientProperty=function(){this.clientProperty&&(this.clientProperty.clear(),this.clientProperty=null)},e.prototype.addClickListener=function(t,e){this.addEventListene(egret.TouchEvent.TOUCH_TAP,t,e)},e.prototype.addEventListene=function(t,e,i,n,a){void 0===n&&(n=!1),void 0===a&&(a=0),null==this._listeners&&(this._listeners=[]),this._listeners.push([t,e,i,n,a]),this.addEventListener(t,e,i,n,a)},e.prototype.removeEventListene=function(t,e,i,n){if(void 0===n&&(n=!1),null!=this._listeners)for(var a=this._listeners.length,s=0;a>s;s++){var o=this._listeners[s];if(o[0]==t&&o[1]==e&&o[2]==i&&o[3]==n){this.removeEventListener(t,e,i,n),this._listeners.splice(s,1);break}}},e.prototype.removeAllEventListener=function(){if(null!=this._listeners){for(var t=this._listeners.length,e=0;t>e;e++){var i=this._listeners[e];this.removeEventListener(i[0],i[1],i[2],i[3])}this._listeners=null}},e.prototype.setLocation=function(t){this.setLocationXY(t.x,t.y)},e.prototype.getLocation=function(){return new egret.Point(this.x,this.y)},e.prototype.setLocationXY=function(t,e){this.x=t,this.y=e},e.prototype.removeAllChild=function(){for(var t=new Array;this.numChildren>0;)t.push(this.removeChildAt(0));return t},Object.defineProperty(e.prototype,"factor",{get:function(){return 0},set:function(t){this.x=(1-t)*(1-t)*100+2*t*(1-t)*300+t*t*100,this.y=(1-t)*(1-t)*100+2*t*(1-t)*300+t*t*500},enumerable:!0,configurable:!0}),e}(egret.Sprite);__reflect(DSprite.prototype,"DSprite");var DEvent=function(t){function e(e,i,n,a){void 0===i&&(i=null),void 0===n&&(n=!1),void 0===a&&(a=!1);var s=t.call(this,e,n,a)||this;return s.data=i,s}return __extends(e,t),e.ACTION_CHANGE="action_change",e.CARD_ACTION_CHANGE="card_action_change",e.USER_SELECT_CARDS_UPDATE="user_select_cards_update",e.BET_ACTION="betAction",e}(egret.Event);__reflect(DEvent.prototype,"DEvent");var AbstractIFrame=function(t){function e(){var e=t.call(this)||this;return e._modal=!0,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.getIframeName=function(){return this._iframeName},e.prototype.setIframeName=function(t){this._iframeName=t},e.prototype.setModal=function(t){this._modal=t,this._drawModalArea()},e.prototype.isModal=function(){return this._modal},e.prototype._drawModalArea=function(){},e.prototype.onShow=function(){},e.prototype.onShowComplete=function(){},e.prototype.onStop=function(){},e.prototype.onStopComplete=function(){},e.prototype.getSelf=function(){return this},e.prototype.getWidth=function(){return this._frameWidth},e.prototype.getHeight=function(){return this._frameHeight},e.prototype.showNewbeeGuide=function(){return!1},e}(egret.Sprite);__reflect(AbstractIFrame.prototype,"AbstractIFrame");var GameGlobal=function(){function t(){}return t.init=function(e,i,n){void 0===n&&(n=null),t.root=e,t.stage=i,n&&(t.debug=1==n.debug,t.version=n.version),t.stage.addEventListener(egret.Event.RESIZE,this.onStageSizeChanged,this,!1,Number.MAX_VALUE),this.onStageSizeChanged()},t.onStageSizeChanged=function(e){void 0===e&&(e=null),t.stageW=t.stage.stageWidth,t.stageH=t.stage.stageHeight,t.halfStageW=t.stageW/2,t.halfStageH=t.stageH/2},t.HTTP_API_URL="http://platform.sjsj.worldwalker.cn/",t.UPDATE_VOICE_API="",t.SOCKET_IP="119.23.57.236",t.SOCKET_PORT=3389,t.HTTP_PORT=8080,t.CDN_URL="",t.platform="default",t.version="1.5",t.DEFAULT_FONT_NAME="微软雅黑",t.APPName="zhajinhua",t.debug=!1,t.stageW=1136,t.stageH=640,t.useWeixin=!0,t.token="40bbd79749bf5893c3d59da7b8b8268f",t.roomId="",t.playerNumLimit=12,t.designW=1136,t.designH=640,t.mapLayer=null,t.mapBGLayer=null,t.mapUILayer=null,t.iframeLayer=null,t.story_flag=!0,t.newbee_flag=!0,t.NEED_PLAYER_COUNT=2,t.GAME_TYPE=3,t.inviteDesc="{0}人房间，房号:{1},局数:{2},封顶:{3}",t.resultImgBase64="",t}();__reflect(GameGlobal.prototype,"GameGlobal");var I18n=function(){function t(){}return t.setLocale=function(t,e){void 0===e&&(e=null),this._locale=t,this.mappingForLocale=this.MAPPING_LOOKUP[this._locale]},t.t=function(e,i){void 0===i&&(i=null);var n=e;if(this._locale&&this._locale!=t.ZH_CN&&this.mappingForLocale.hasOwnProperty(e)&&(n=this.mappingForLocale[e]),null==i)return n;for(var a=i.length,s=0;a>s;s++)n=n.replace(/'%s' + (i + 1)/g,i[s]);return n},t.ZH_CN="zh_CN",t.EN_US="en_US",t.CHINESE={},t.ENGLISH={},t.MAPPING_LOOKUP={zh_CN:t.CHINESE,en_US:t.ENGLISH},t}();__reflect(I18n.prototype,"I18n");var WIN_OPERATOR;!function(t){t[t.WIN_OPEN_NEW=0]="WIN_OPEN_NEW",t[t.WIN_CLOSE_DELETE=1]="WIN_CLOSE_DELETE",t[t.WIN_CLOSE_HIDE=2]="WIN_CLOSE_HIDE",t[t.WIN_OPEN_SHOW=3]="WIN_OPEN_SHOW",t[t.WIN_OPEN_SHOW_OR_HIDE=4]="WIN_OPEN_SHOW_OR_HIDE"}(WIN_OPERATOR||(WIN_OPERATOR={}));var WIN_EFFECT;!function(t){t[t.EFFECT_WIN_CLOSE_BEGIN=0]="EFFECT_WIN_CLOSE_BEGIN",t[t.EFFECT_WIN_CLOSE_MOVE_LEFT=1]="EFFECT_WIN_CLOSE_MOVE_LEFT",t[t.EFFECT_WIN_CLOSE_MOVE_RIGHT=2]="EFFECT_WIN_CLOSE_MOVE_RIGHT",t[t.EFFECT_WIN_CLOSE_MOVE_UP=3]="EFFECT_WIN_CLOSE_MOVE_UP",t[t.EFFECT_WIN_CLOSE_MOVE_DOWN=4]="EFFECT_WIN_CLOSE_MOVE_DOWN",t[t.EFFECT_WIN_CLOSE_SCALE=5]="EFFECT_WIN_CLOSE_SCALE",t[t.EFFECT_WIN_CLOSE_END=6]="EFFECT_WIN_CLOSE_END",t[t.EFFECT_WIN_OPEN_MOVE_LEFT=7]="EFFECT_WIN_OPEN_MOVE_LEFT",t[t.EFFECT_WIN_OPEN_MOVE_RIGHT=8]="EFFECT_WIN_OPEN_MOVE_RIGHT",t[t.EFFECT_WIN_OPEN_MOVE_UP=9]="EFFECT_WIN_OPEN_MOVE_UP",t[t.EFFECT_WIN_OPEN_MOVE_DOWN=10]="EFFECT_WIN_OPEN_MOVE_DOWN",t[t.EFFECT_WIN_OPEN_SCALE=11]="EFFECT_WIN_OPEN_SCALE",t[t.EFFECT_WIN_OPEN_ALPHA=12]="EFFECT_WIN_OPEN_ALPHA",t[t.EFFECT_WIN_OPEN_END=13]="EFFECT_WIN_OPEN_END"}(WIN_EFFECT||(WIN_EFFECT={}));var IFrameLayer=function(t){function e(){var e=t.call(this)||this;return e._iframes=[],e.touchEnabled=!1,e}return __extends(e,t),e.prototype.isIframeShow=function(t){var e=this.getIFrame(t);return null!=e?null!=e.stage:!1},e.prototype.getIFrame=function(t){for(var e=null,i=this._iframes.length,n=0;i>n;n++)if(this._iframes[n]instanceof t){e=this._iframes[n];break}return e},e.prototype.hideIFrame=function(t,e){void 0===e&&(e=WIN_EFFECT.EFFECT_WIN_CLOSE_SCALE);var i=this.getIFrame(t);null!=i&&this.setIFrameShowEffect(i,e,!1)},e.prototype.showIFrame=function(t,e){void 0===e&&(e=WIN_EFFECT.EFFECT_WIN_OPEN_SCALE);for(var i=this._iframes.length,n=null,a=0;i>a;a++)if(this._iframes[a]instanceof t){n=this._iframes[a];break}null==n&&(n=new t,this._iframes.push(n)),this.setIFrameShowEffect(n,e)},e.prototype.setIFrameShowEffect=function(t,i,n){if(void 0===n&&(n=!0),0==i||null==i)return void(n?this.addChild(t):t.hide());var a=null;if(i>WIN_EFFECT.EFFECT_WIN_CLOSE_END&&i<WIN_EFFECT.EFFECT_WIN_OPEN_END){switch(this.addChild(t),i){case WIN_EFFECT.EFFECT_WIN_OPEN_MOVE_LEFT:t.x=-GameGlobal.stage.stageWidth,t.y=0,t.scaleX=1,t.scaleY=1,a=egret.Ease.bounceOut;break;case WIN_EFFECT.EFFECT_WIN_OPEN_MOVE_RIGHT:t.x=GameGlobal.stage.stageWidth,t.y=0,t.scaleX=1,t.scaleY=1,a=egret.Ease.bounceOut;break;case WIN_EFFECT.EFFECT_WIN_OPEN_MOVE_UP:t.x=0,t.y=-GameGlobal.stage.stageHeight,t.scaleX=1,t.scaleY=1,a=egret.Ease.bounceOut;break;case WIN_EFFECT.EFFECT_WIN_OPEN_MOVE_DOWN:t.x=0,t.y=GameGlobal.stage.stageHeight,t.scaleX=1,t.scaleY=1,a=egret.Ease.bounceOut;break;case WIN_EFFECT.EFFECT_WIN_OPEN_SCALE:t.x=GameGlobal.stage.stageWidth>>1,t.y=GameGlobal.stage.stageHeight>>1,t.scaleX=0,t.scaleY=0;break;case WIN_EFFECT.EFFECT_WIN_OPEN_ALPHA:t.alpha=.5}var s=GameGlobal.stage.stageWidth-t.iframeWidth>>1,o=GameGlobal.stage.stageHeight-t.iframeHeight>>1;egret.Tween.get(t).to({x:s,y:o,scaleX:1,scaleY:1,alpha:1},e.TWEEN_DURATION,egret.Ease.backOut).call(function(){t.show()},this)}else{var r=GameGlobal.stage.stageWidth>>1,h=GameGlobal.stage.stageHeight>>1,l=1,c=1;switch(i){case WIN_EFFECT.EFFECT_WIN_CLOSE_MOVE_LEFT:r=-GameGlobal.stage.stageWidth,h=t.y,l=1,c=1,a=egret.Ease.bounceIn;break;case WIN_EFFECT.EFFECT_WIN_CLOSE_MOVE_RIGHT:r=GameGlobal.stage.stageWidth,h=0,l=1,c=1,a=egret.Ease.bounceIn;break;case WIN_EFFECT.EFFECT_WIN_CLOSE_MOVE_UP:r=0,h=-GameGlobal.stage.stageHeight,l=1,c=1,a=egret.Ease.bounceIn;break;case WIN_EFFECT.EFFECT_WIN_CLOSE_MOVE_DOWN:r=0,h=GameGlobal.stage.stageHeight,l=1,c=1,a=egret.Ease.bounceIn;break;case WIN_EFFECT.EFFECT_WIN_CLOSE_SCALE:l=0,c=0}egret.Tween.get(t).to({x:r,y:h,scaleX:l,scaleY:c},e.TWEEN_DURATION,egret.Ease.backIn).call(function(){t.hide()},this)}},e.TWEEN_DURATION=250,e}(egret.DisplayObjectContainer);__reflect(IFrameLayer.prototype,"IFrameLayer");var MapBgLayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.Sprite);__reflect(MapBgLayer.prototype,"MapBgLayer");var MapLayer=function(t){function e(){var e=t.call(this)||this;return GameGlobal.mapBGLayer=new MapBgLayer,e.addChild(GameGlobal.mapBGLayer),GameEventManager.addEvent(NetAction.dissolveRoom.toString(),e.dissolveRoomResponse,e),GameEventManager.addEvent(NetAction.dissolveRoomSuccess.toString(),e.dissolveRoomSuccessResponse,e),GameEventManager.addEvent(GameEventManager.QUIT_ROOM,e.onQuitGame,e),e}return __extends(e,t),e.prototype.resize=function(){this._gameView&&this._gameView.resize()},e.prototype.onQuitGame=function(t){this.hideBattle(),GameGlobal.mapUILayer.visible=!0,SoundManager.instance.stopMusic(),GameGlobal.jssdk.setTitle("玩游戏","无需下载安装，立即组局，邀请朋友打牌！")},e.prototype.dissolveRoomResponse=function(t){var e=t.data,i=e.data,n=i.playerId;if(n!=MyUserInfo.getInstance().userId){var a=this._gameView.getPlayerInfoById(n),s=a.nickName;AlertView.getInstance().setConfirmCallBack(this.agreeDissolveRoom,this),AlertView.getInstance().setCancelCallBack(this.disagreeDissolveRoom,this),AlertView.getInstance().show("玩家"+s+"请求解散房间，是否同意？",AlertView.CONFIRM_MODE)}},e.prototype.agreeDissolveRoom=function(){var t={};t.msgType=NetAction.agreeDissolveRoom,t.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(t)},e.prototype.disagreeDissolveRoom=function(){var t={};t.msgType=NetAction.disagreeDissolveRoom,t.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(t)},e.prototype.dissolveRoomSuccessResponse=function(t){var e=t.data,i=e.data;if(null!=i&&i.hasOwnProperty("roomInfo")){GameGlobal.iframeLayer.showIFrame(JieSuanView);var n=GameGlobal.iframeLayer.getIFrame(JieSuanView);n.setData(i.roomInfo,!0)}else this.hideBattle(),GameGlobal.mapUILayer.visible=!0,SoundManager.instance.stopMusic()},e.prototype.hideBattle=function(){GameGlobal.iframeLayer.hideIFrame(GameResult),GameGlobal.iframeLayer.hideIFrame(JieSuanView),this._gameView&&this._gameView.stage&&(this._gameView.dispose(),this.removeChild(this._gameView)),SoundManager.instance.stopMusic()},e.prototype.getBattle=function(){return this._gameView},e.prototype.showBattle=function(t){void 0===t&&(t=null),null==this._gameView&&(this._gameView=new GameView),this.addChild(this._gameView),this._gameView.init(t)},e}(eui.Component);__reflect(MapLayer.prototype,"MapLayer");var MapUILayer=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.resize=function(){this._hallView.resize()},e.prototype.initView=function(){this._hallView=new HallView,this.addChild(this._hallView),GameEventManager.addEvent(NetAction.createRoom.toString(),this.onCreateRoomResponse,this),GameEventManager.addEvent(NetAction.enterRoom.toString(),this.onEnterRoomResponse,this),GameEventManager.addEvent(GameEventManager.SOCKET_CONNECTED,this.onSocketConnected,this),GameEventManager.addEvent(NetAction.refreshRoom.toString(),this.onRefreshRoomResponse,this),GameEventManager.addEvent(NetAction.enterHall.toString(),this.onEnterHallResponse,this),GameEventManager.addEvent(NetAction.updateFangKa.toString(),this.onUpdateFangKaResponse,this),0!=GameModel.instance().roomId&&this.refreshRoom()},e.prototype.onUpdateFangKaResponse=function(t){var e=t.data,i=e.data,n=i.roomCardNum,a=i.playerId;a==MyUserInfo.getInstance().userId&&(MyUserInfo.getInstance().gold=n)},e.prototype.onEnterHallResponse=function(t){GameGlobal.mapLayer.hideBattle(),GameGlobal.mapUILayer.visible=!0},e.prototype.onSocketConnected=function(t){DataLoading.getInstance().hide(),this.refreshRoom()},e.prototype.refreshRoom=function(){var t={};t.msgType=NetAction.refreshRoom,t.msg={refreshType:1},t.gameType=0,SocketCommand.getInstance().send(t)},e.prototype.onRefreshRoomResponse=function(t){var e=t.data,i=e.data,n=i.status;GameGlobal.iframeLayer.hideIFrame(JoinRoomView),1==n?(GameGlobal.mapUILayer.visible=!1,GameGlobal.mapLayer.showBattle(i)):2==n?(GameGlobal.mapUILayer.visible=!1,GameGlobal.mapLayer.showBattle(i)):3==n?(GameGlobal.mapUILayer.visible=!1,GameGlobal.mapLayer.showBattle(i)):4==n&&(GameGlobal.mapUILayer.visible=!1,GameGlobal.mapLayer.showBattle(i))},e.prototype.onEnterRoomResponse=function(t){DataLoading.getInstance().hide();var e=t.data,i=e.data;GameGlobal.iframeLayer.hideIFrame(JoinRoomView),GameGlobal.mapUILayer.visible=!1,GameGlobal.mapLayer.showBattle(i)},e.prototype.onCreateRoomResponse=function(t){var e=t.data,i=e.data;GameGlobal.iframeLayer.hideIFrame(CreateRoomView),GameGlobal.mapUILayer.visible=!1,GameGlobal.mapLayer.showBattle(i)},e}(egret.DisplayObjectContainer);__reflect(MapUILayer.prototype,"MapUILayer");var NewbeeGuideLayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(NewbeeGuideLayer.prototype,"NewbeeGuideLayer");var TopLayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(TopLayer.prototype,"TopLayer");var CommandManager=function(){function t(){this._commandMap=null,this._commandMap=new HashMap}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){},t.prototype.addCommand=function(t,e){this._commandMap.put(t,e)},t.prototype.removeCommand=function(t){this._commandMap.remove(t)},t.prototype.execute=function(t,e){void 0===e&&(e=null);var i=this._commandMap.get(t);i&&(new i).execute()},t._instance=null,t}();__reflect(CommandManager.prototype,"CommandManager");var CookieManager=function(){function t(){}return t.write=function(e,i){var n=t.COOKIE_NAME+e.toString();egret.localStorage.setItem(n,i.toString())},t.read=function(e){var i=t.COOKIE_NAME+e.toString();egret.localStorage.getItem(i)},t.remove=function(e){var i=t.COOKIE_NAME+e.toString();egret.localStorage.removeItem(i)},t.clear=function(){egret.localStorage.clear()},t.COOKIE_NAME="PearlHarborGame",t}();__reflect(CookieManager.prototype,"CookieManager");var DefaultVersionController=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getVirtualUrl=function(e){return e+="?v="+GameGlobal.version,GameGlobal.CDN_URL+t.prototype.getVirtualUrl.call(this,e)},e}(RES.VersionController);__reflect(DefaultVersionController.prototype,"DefaultVersionController");var EnterFrameManager=function(){function t(){}return t.addEnterFrameHandler=function(t,e,i){void 0===i&&(i=null),0==this._handlers.length&&this._sprite.addEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this,!1,Number.MAX_VALUE),this._handlers.push(t),this._params.push(i),this._thisObjs.push(e)},t.removeEnterFrameHandler=function(t){var e=this._handlers.indexOf(t);-1!=e&&(this._enterFrameRunning?this._needRemoveHandlerArr.push(t):(this._handlers.splice(e,1),this._params.splice(e,1),this._thisObjs.splice(e,1),0==this._handlers.length&&this._sprite.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrameHandler,this)))},t.hasEnterFrameHandler=function(t){return-1!=this._handlers.indexOf(t)},t.enterFrameHandler=function(e){this._needRemoveHandlerArr=[],this._enterFrameRunning=!0;for(var i,n=this._handlers.length,a=0;n>a;a++)if(i=this._handlers[a],-1==this._needRemoveHandlerArr.indexOf(i)){var s=this._params[a];null!=s?i.apply(this._thisObjs[a],s):i.apply(this._thisObjs[a])}this._enterFrameRunning=!1;for(var o in this._needRemoveHandlerArr)t.removeEnterFrameHandler(this._needRemoveHandlerArr[o])},t._sprite=new egret.Sprite,t._handlers=[],t._params=[],t._thisObjs=[],t._needRemoveHandlerArr=[],t._enterFrameRunning=!1,t}();__reflect(EnterFrameManager.prototype,"EnterFrameManager");var GameEventManager=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getInstance=function(){return this._instance||(this._instance=new e)},e.addEvent=function(t,i,n){e.getInstance().addEventListener(t,i,n)},e.removeEvent=function(t,i,n){e.getInstance().removeEventListener(t,i,n)},e.dispatchEvent=function(t,i){void 0===i&&(i=null),e.getInstance().dispatchEvent(new DEvent(t,i))},e._instance=null,e.COMPLETE="complete",e.SELECTED="selected",e.CONTINUE_GAME="continue_game",e.START_BATTLE="start_battle",e.END_BATTLE="end_battle",e.UPDATE_RANK="update_rank",e.UPDATE_USER_GOLD="update_user_gold",e.UPDATE_USER_DIAMOND="update_user_diamond",e.UPDATE_USER_LEVEL="update_user_level",e.SOCKET_CONNECTED="socket_connected",e.LOGIN_SUCCESS="login_success",e.NEXT_ROUND="next_round",e.QUIT_ROOM="quit_room",e}(egret.EventDispatcher);__reflect(GameEventManager.prototype,"GameEventManager");var JSSDK=function(t){function e(){var e=t.call(this)||this;return e.CLASS_NAME="JSSDK",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.init()},Object.defineProperty(e.prototype,"Title",{get:function(){return this.title},set:function(t){this.title=t,this.getSignPackage()},enumerable:!0,configurable:!0}),e.prototype.setTitle=function(t,e){this.link=GameGlobal.HTTP_API_URL+"game/zjh?roomId="+GameModel.instance().roomId+"&playerNumLimit="+GameGlobal.playerNumLimit,this.title=t,this.desc=e,this.getSignPackage()},Object.defineProperty(e.prototype,"Desc",{get:function(){return this.desc},set:function(t){this.desc=t},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.title="微侣-炸金花",this.desc="无需下载安装，立即组局，邀请朋友打牌！",this.link=GameGlobal.HTTP_API_URL+"game/zjh",this.imgUrl=GameGlobal.CDN_URL+"logo.jpg";var t=GameGlobal.HTTP_API_URL+"weixin/getWxConfig?url=";this.url=t+encodeURIComponent(location.href.split("#")[0]),this.getSignPackage()},e.prototype.getSignPackage=function(){var t=this,e=new egret.URLLoader,i=new egret.URLRequest(this.url);e.load(i),i.method=egret.URLRequestMethod.GET,e.addEventListener(egret.Event.COMPLETE,function(e){var i=JSON.parse(e.target.data);t.signPackage=i.data,t.getWeiXinConfig();var n=t,a=function(){n.getWeiXinShareTimeline(),n.getWeiXinShareAppMessage(),n.getWeiXinShareQQ(),n.getWeiXinShareWeiBo()},s=function(t){n.init()};wx.ready(a),wx.error(s)},this)},e.prototype.getWeiXinConfig=function(){var t=new BodyConfig;t.debug=!1,t.appId=this.signPackage.appId,t.timestamp=this.signPackage.timestamp,t.nonceStr=this.signPackage.nonceStr,t.signature=this.signPackage.signature,t.jsApiList=["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","translateVoice","startRecord","stopRecord","playVoice","pauseVoice","stopVoice","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","closeWindow","scanQRCode","chooseWXPay","openProductSpecificView","addCard","chooseCard","openCard"],wx.config(t)},e.prototype.getWeiXinShareTimeline=function(){var t=this,e=new BodyMenuShareTimeline;e.title=this.title,e.link=this.link,e.imgUrl=this.imgUrl,e.trigger=function(){},e.success=function(){t.thisObj.shareComplete()},e.cancel=function(){},e.fail=function(t){},wx.onMenuShareTimeline(e)},e.prototype.getWeiXinShareAppMessage=function(){var t=this,e=new BodyMenuShareAppMessage;e.title=this.title,e.desc=this.desc,e.link=this.link,e.imgUrl=this.imgUrl,e.trigger=function(){},e.success=function(){t.thisObj.shareComplete()},e.cancel=function(){},e.fail=function(t){},wx.onMenuShareAppMessage(e)},e.prototype.selectImageWX=function(){var t=this;wx.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){var i=e.localIds;t.upObj.upImageComplete(i,i[0])}})},e.prototype.uploadImage=function(t){var e=this;wx.uploadImage({localId:t,isShowProgressTips:1,success:function(t){var i=t.serverId;e.upObj.uploadComplete(i)}})},e.prototype.downloadImage=function(){var t=this,e=1;wx.downloadImage({serverId:e,isShowProgressTips:1,success:function(e){var i=e.localId;alert(i),t.upObj.upImageComplete("sd",i)}})},e.prototype.getWeiXinShareQQ=function(){var t=this,e=new BodyMenuShareQQ;e.title=this.title,e.desc=this.desc,e.link=this.link,e.imgUrl=this.imgUrl,e.trigger=function(){},e.complete=function(t){},e.success=function(){t.thisObj.shareComplete()},e.cancel=function(){},e.fail=function(t){},wx.onMenuShareQQ(e)},e.prototype.getWeiXinShareWeiBo=function(){var t=this,e=new BodyMenuShareWeibo;e.title=this.title,e.desc=this.desc,e.link=this.link,e.imgUrl=this.imgUrl,e.trigger=function(){},e.complete=function(t){},e.success=function(){t.thisObj.shareComplete()},e.cancel=function(){},e.fail=function(t){},wx.onMenuShareWeibo(e)},e.prototype.getWeixinShowMenuItems=function(t){void 0===t&&(t=null);var e=["menuItem:share:appMessage","menuItem:share:timeline","menuItem:share:qq","menuItem:share:weiboApp","menuItem:favorite","menuItem:share:facebook","menuItem:share:QZone","menuItem:editTag","menuItem:delete","menuItem:copyUrl","menuItem:originPage","menuItem:readMode","menuItem:openWithQQBrowser","menuItem:openWithSafari","menuItem:share:email","menuItem:share:brand"];null!=t&&(e=t),wx.showMenuItems({menuList:e,success:function(t){},fail:function(t){}})},e.prototype.getWeixinHideMenuItems=function(t){void 0===t&&(t=null);var e=["menuItem:share:appMessage","menuItem:share:timeline","menuItem:share:qq","menuItem:share:weiboApp","menuItem:favorite","menuItem:share:facebook","menuItem:share:QZone","menuItem:editTag","menuItem:delete","menuItem:copyUrl","menuItem:originPage","menuItem:readMode","menuItem:openWithQQBrowser","menuItem:openWithSafari","menuItem:share:email","menuItem:share:brand"];
null!=t&&(e=t),wx.hideMenuItems({menuList:e,success:function(t){},fail:function(t){}})},e}(egret.DisplayObjectContainer);__reflect(JSSDK.prototype,"JSSDK");var ObjectPool=function(){function t(){this._objTable=new HashMap}return t.prototype.getObject=function(t){var e=t.key;console.log(e);var i,n=this._objTable.get(e);return null==n||0==n.length?(i=new t,i.key=e,i):n.pop()},t.prototype.putObject=function(t){var e=t.key,i=this._objTable.get(e);null==i&&this._objTable.put(e,i=new Array),i.push(t)},t}();__reflect(ObjectPool.prototype,"ObjectPool");var SoundManager=function(t){function e(){var e=t.call(this)||this;return e._isMusicOn=!0,e._isSoundOn=!0,e._bgmVoice=.5,e._currentSoundChannel=null,e._currentSoundName="",e._soundLoop=1,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return null==this._instance&&(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.playMusic=function(t,e){void 0===e&&(e=.5),this.isMusicOn&&(this.stopMusic(),this._bgmVoice=e,this._bgSound=RES.getRes(t),this._bgSoundChannel=this._bgSound.play(0,0),this._bgSoundChannel.volume=this._bgmVoice)},Object.defineProperty(e.prototype,"isMusicOn",{get:function(){return this._isMusicOn},set:function(t){this._isMusicOn!=t&&(this._isMusicOn=t,this._isMusicOn?this._bgSoundChannel&&(this._bgSoundChannel.volume=this._bgmVoice):this._bgSoundChannel&&(this._bgSoundChannel.volume=0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSoundOn",{get:function(){return this._isSoundOn},set:function(t){this._isSoundOn=t},enumerable:!0,configurable:!0}),e.prototype.playSound=function(t,e,i,n){if(void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n=!0),this._isSoundOn){this.stopSound();try{var a=RES.getRes(t);this._currentSoundChannel=a.play(0,e),this._currentSoundChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this)}catch(s){}}},e.prototype.onLoadSoundComplete=function(t){var e=t.target;this._currentSoundChannel=e.play(0,this._soundLoop),this._currentSoundChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),this._currentSoundChannel.removeEventListener(egret.Event.COMPLETE,this.onLoadSoundComplete,this),this._currentSoundChannel.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this)},e.prototype.onLoadError=function(t){console.log("onLoadSound IOError!")},e.prototype.onSoundComplete=function(t){this.dispatchEvent(new DEvent(egret.Event.SOUND_COMPLETE))},e.prototype.playSoundByUrl=function(t){this.stopSound()},e.prototype.stopSound=function(){null!=this._currentSoundChannel&&this._currentSoundChannel.stop()},e.prototype.stopMusic=function(){null!=this._bgSoundChannel&&this._bgSoundChannel.stop(),this._bgSoundChannel=null},e}(egret.EventDispatcher);__reflect(SoundManager.prototype,"SoundManager");var TipsManager;!function(t){function e(t,e,n){void 0===e&&(e=""),void 0===n&&(n=0),i(t),null==this._dict&&(this._dict=[]),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.showTips,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.removeTips,this),t.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.removeTips,this),null==this._dict[t.hashCode]&&(this._dict[t.hashCode]=[]),this._dict[t.hashCode].descStr=e,this._dict[t.hashCode].effectType=n}function i(t){t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.showTips,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.removeTips,this),t.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.removeTips,this),a(null)}function n(t){var e=t.currentTarget,i="",n=0;if(null==this._tips){null!=this._dict[e.hashCode]&&(i=this._dict[e.hashCode].descStr,n=this._dict[e.hashCode].effectType),this._tips=new TipsPanel(this._dict[e.hashCode].descStr),GameGlobal.stage.contains(this._tips)||GameGlobal.stage.addChild(this._tips);var a=e.parent.localToGlobal(e.x,e.y);switch(a.x=a.x+e.width/2,a.y=a.y-this._tips.height,a.x+this._tips.width>GameGlobal.stage.stageWidth?a.x=GameGlobal.stage.stageWidth-this._tips.width:a.x<0&&(a.x=0),a.y+this._tips.height>GameGlobal.stage.stageHeight?a.y=GameGlobal.stage.stageHeight-this._tips.height:a.y<0&&(a.y=0),this._tips.x=a.x,this._tips.y=a.y,n){case 0:this._tips.alpha=0,egret.Tween.get(this._tips).to({alpha:1},300);break;case 1:this._tips.alpha=0,this._tips.y+=this._tips.height,egret.Tween.get(this._tips).to({alpha:1,y:this._tips.y-this._tips.height},500,egret.Ease.backOut);break;case 2:this._tips.alpha=0,this._tips.x-=this._tips.width,egret.Tween.get(this._tips).to({alpha:1,x:this._tips.x+this._tips.width},500,egret.Ease.backOut);break;case 3:this._tips.alpha=0,this._tips.x+=this._tips.width,egret.Tween.get(this._tips).to({alpha:1,x:this._tips.x-this._tips.width},500,egret.Ease.backOut)}}}function a(t){if(null!=this._tips){var e=function(){GameGlobal.stage.contains(this._tips)&&(GameGlobal.stage.removeChild(this._tips),this._tips=null)};egret.Tween.get(this._tips).to({alpha:0},300).call(e,this)}}t.registerTips=e,t.unRegisterTips=i,t.showTips=n,t.removeTips=a}(TipsManager||(TipsManager={}));var TipsPanel=function(t){function e(e){void 0===e&&(e="");var i=t.call(this)||this;return i.descStr="",i.descStr=e,i.initUI(),i}return __extends(e,t),e.prototype.initUI=function(){this.bg=new egret.Bitmap,this.bg.texture=RES.getRes("tipsBg"),this.addChild(this.bg),this.bg.touchEnabled=!0,this.descTF=new egret.TextField,this.addChild(this.descTF),this.descTF.textColor=16777215,this.descTF.size=20,this.descTF.x=20,this.descTF.y=10,this.descTF.lineSpacing=6,this.descTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this.descTF.text=this.descStr;var t=new egret.Rectangle(5,5,35,35);this.bg.scale9Grid=t,this.bg.width=this.descTF.width+40,this.bg.height=this.descTF.height+20},e}(egret.Sprite);__reflect(TipsPanel.prototype,"TipsPanel");var HttpCommand=function(){function t(){}return t.send=function(e,i,n){function a(){egret.clearTimeout(t._timerId)}function s(e){DataLoading.getInstance().hide(),egret.clearTimeout(t._timerId);var a=e.target;a.removeEventListener(egret.Event.COMPLETE,s,this),a.removeEventListener(egret.IOErrorEvent.IO_ERROR,o,this);var r=a.response;LogUtils.log("data from server::"+r),r=JSON.parse(r.toString());var h=r.code;h!=DBServerMessage.NORMAL?AlertView.getInstance().show(r.desc,AlertView.ALERT_MODE):null!=n&&n.apply(i,[r])}function o(){DataLoading.getInstance().hide(),egret.clearTimeout(t._timerId),r.removeEventListener(egret.Event.COMPLETE,s,this),r.removeEventListener(egret.IOErrorEvent.IO_ERROR,o,this),AlertView.getInstance().show("请求接口失败：egret.IOErrorEvent.IO_ERROR",AlertView.ALERT_MODE)}void 0===n&&(n=null);var r=new egret.HttpRequest;r.responseType=egret.HttpResponseType.TEXT,r.open(t.rebuild2(e),egret.HttpMethod.GET),r.send(),r.addEventListener(egret.Event.COMPLETE,s,this),r.addEventListener(egret.IOErrorEvent.IO_ERROR,o,this),LogUtils.log("send http request::"+e.action),DataLoading.getInstance().show(),t._timerId=egret.setTimeout(a,this,t.REQUEST_TIMEOUT)},t.rebuild2=function(t){var e=Math.random().toString(),i=t.params,n=t.action+"?",a="";if(i)for(var s in i)a+="&"+s+"="+i[s];return a=a.substring(1),""!=a?GameGlobal.HTTP_API_URL+"game/"+n+a+"&token="+GameGlobal.token+"&deviceType="+GameModel.instance().deviceType+"&v="+e:GameGlobal.HTTP_API_URL+"game/"+n+"token="+GameGlobal.token+"&deviceType="+GameModel.instance().deviceType+"&v="+e},t.rebuild=function(t){var e=(Math.random().toString(),t.params);return e=e||{},e.code=GameModel.instance().token,e.deviceType=GameModel.instance().deviceType,e},t.cookie="",t.LOGIN="login",t.GETIP="getIpByRoomId",t.REQUEST_TIMEOUT=8e3,t._timerId=-1,t}();__reflect(HttpCommand.prototype,"HttpCommand");var CommandVo=function(){function t(t,e){void 0===t&&(t=""),void 0===e&&(e=null),this.module="",this.action="",this.params={},this.action=t,this.params=e}return t}();__reflect(CommandVo.prototype,"CommandVo");var NetAction=function(){function t(){}return t.NORMAL=0,t.enterHall=1,t.dissolveRoomSuccess=12,t.createRoom=5,t.enterRoom=6,t.ready=7,t.sayPoker=8,t.jiesuan=24,t.jiesuan2=25,t.dissolveRoom=9,t.agreeDissolveRoom=10,t.disagreeDissolveRoom=11,t.refreshRoom=13,t.backToHall=16,t.autodissolveRoom=18,t.chatMsg=19,t.hearBeat=20,t.offline=14,t.online=15,t.zhanji=2,t.feedback=3,t.notice=4,t.updateFangKa=21,t.updatePosition=23,t.playerInfo=17,t.mallList=26,t.bind=27,t.checkBind=28,t.buy=29,t.autoCompare=301,t.follow=300,t.look=303,t.compare=302,t.giveup=304,t.countDown=305,t}();__reflect(NetAction.prototype,"NetAction");var SocketCommand=function(){function t(){this._reConnectTime=-1,this._isConnected=!1,this._isReconnect=!1,this._lockReconnect=!1,this._hearBeatTime=-1}return t.getInstance=function(){return this._instance||(this._instance=new t)},t.prototype.onHearBeatTimer=function(){var e=this,i={};i.msgType=NetAction.hearBeat,i.gameType=0,t.getInstance().send(i),egret.clearTimeout(this._reConnectTime),this._reConnectTime=egret.setTimeout(function(){egret.clearTimeout(e._reConnectTime),e._socket.close()},this,6e3)},Object.defineProperty(t.prototype,"isConnected",{get:function(){return this._isConnected},enumerable:!0,configurable:!0}),t.prototype.connect=function(){LogUtils.log("connect socket..."),this._socket&&(this._socket.removeEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketData,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onSocketClosed,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketIOError,this)),this._socket=new egret.WebSocket,this._socket.addEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketData,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClosed,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketIOError,this),this._socket.connect(GameGlobal.SOCKET_IP,GameGlobal.SOCKET_PORT)},t.prototype.onSocketIOError=function(t){LogUtils.log("onSocketIOError"),this.onSocketClosed(null)},t.prototype.send=function(t){if(this.isConnected){t.token=GameModel.instance().token,(void 0==t.gameType||null==t.gameType)&&(t.gameType=GameGlobal.GAME_TYPE);var e=JSON.stringify(t);LogUtils.log("send msg::message = "+e),this._socket.writeUTF(e)}},t.prototype.onSocketConnected=function(t){DataLoading.getInstance().hide(),LogUtils.log("socket connected!!!"),this._isConnected=!0,egret.clearTimeout(this._reConnectTime),egret.clearTimeout(this._hearBeatTime),this._hearBeatTime=egret.setTimeout(this.onHearBeatTimer,this,1e4),GameEventManager.dispatchEvent(GameEventManager.SOCKET_CONNECTED)},t.prototype.onSocketData=function(t){DataLoading.getInstance().hide();var e=this._socket.readUTF(),i=JSON.parse(e),n=i.code;LogUtils.log("msg from server::code = "+n+",msgType = "+i.msgType+",desc = "+i.desc),n==NetAction.NORMAL?(LogUtils.log("data = "+JSON.stringify(i)),GameEventManager.dispatchEvent(i.msgType.toString(),i)):AlertView.getInstance().show(i.desc),egret.clearTimeout(this._reConnectTime),egret.clearTimeout(this._hearBeatTime),this._hearBeatTime=egret.setTimeout(this.onHearBeatTimer,this,1e4)},t.prototype.onSocketClosed=function(t){DataLoading.getInstance().hide(),this._isConnected=!1,LogUtils.log("disconnected from socket server!!!try to reconnect"),this.reconnect()},t.prototype.reconnect=function(){var t=this;DataLoading.getInstance().show(),egret.clearTimeout(this._reConnectTime),this._reConnectTime=egret.setTimeout(function(){t.connect()},this,3e3),this.connect()},t._instance=null,t}();__reflect(SocketCommand.prototype,"SocketCommand");var qr;!function(t){var e=function(){function e(e){this.mode=t.QRMode.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var i=0,n=this.data.length;n>i;i++){var a=[],s=this.data.charCodeAt(i);s>65536?(a[0]=240|(1835008&s)>>>18,a[1]=128|(258048&s)>>>12,a[2]=128|(4032&s)>>>6,a[3]=128|63&s):s>2048?(a[0]=224|(61440&s)>>>12,a[1]=128|(4032&s)>>>6,a[2]=128|63&s):s>128?(a[0]=192|(1984&s)>>>6,a[1]=128|63&s):a[0]=s,this.parsedData.push(a)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return e.prototype.getLength=function(t){return this.parsedData.length},e.prototype.write=function(t){for(var e=0,i=this.parsedData.length;i>e;e++)t.put(this.parsedData[e],8)},e}();t.QR8bitByte=e,__reflect(e.prototype,"qr.QR8bitByte")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){this.buffer=[],this.length=0}return t.prototype.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},t.prototype.put=function(t,e){for(var i=0;e>i;i++)this.putBit(1==(t>>>e-i-1&1))},t.prototype.getLengthInBits=function(){return this.length},t.prototype.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++},t}();t.QRBitBuffer=e,__reflect(e.prototype,"qr.QRBitBuffer")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.create=function(i,n,a,s,o){void 0===n&&(n=0),void 0===a&&(a=200),void 0===s&&(s=200),void 0===o&&(o=2);var r={width:a,height:s,correctLevel:t.QRErrorCorrectLevel.H,color:n},h=new t.QRCodeModel(t.QRUtil._getTypeNumber(i,r.correctLevel),r.correctLevel);return h.addData(i),h.make(),e.draw(h,r)},e.draw=function(t,e){for(var i=new egret.Sprite,e=e,n=t.getModuleCount(),a=e.width/n,s=e.height/n,o=0;n>o;o++)for(var r=0;n>r;r++){var h=t.isDark(o,r);h&&(i.graphics.beginFill(e.color),i.graphics.drawRect(r*a,o*s,a,s),i.graphics.endFill())}return i},e}();t.QRCode=e,__reflect(e.prototype,"qr.QRCode")}(qr||(qr={}));var Game=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){GameGlobal.mapLayer=new MapLayer,this.addChild(GameGlobal.mapLayer),GameGlobal.mapUILayer=new MapUILayer,this.addChild(GameGlobal.mapUILayer),GameGlobal.mapUILayer.visible=!1,0==GameModel.instance().roomId&&(GameGlobal.mapUILayer.visible=!0),GameGlobal.iframeLayer=new IFrameLayer,this.addChild(GameGlobal.iframeLayer),GameGlobal.topLayer=new TopLayer,this.addChild(GameGlobal.topLayer),GameGlobal.newbeeGuideLayer=new NewbeeGuideLayer,this.addChild(GameGlobal.newbeeGuideLayer),MyUserInfo.getInstance(),GameGlobal.stage.addEventListener(egret.Event.RESIZE,this.onResize,this)},e.prototype.onResize=function(t){GameGlobal.mapUILayer.resize(),GameGlobal.mapLayer.resize()},e}(egret.Sprite);__reflect(Game.prototype,"Game");var qr;!function(t){var e=function(){function t(){}return t.L=1,t.M=0,t.Q=3,t.H=2,t}();t.QRErrorCorrectLevel=e,__reflect(e.prototype,"qr.QRErrorCorrectLevel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.PATTERN000=0,t.PATTERN001=1,t.PATTERN010=2,t.PATTERN011=3,t.PATTERN100=4,t.PATTERN101=5,t.PATTERN110=6,t.PATTERN111=7,t}();t.QRMaskPattern=e,__reflect(e.prototype,"qr.QRMaskPattern")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.glog=function(e){return t.isInit||t.init(),1>e&&console.log("错误:n="+e),t.LOG_TABLE[e]},t.gexp=function(e){for(t.isInit||t.init();0>e;)e+=255;for(;e>=256;)e-=255;return t.EXP_TABLE[e]},t.init=function(){t.isInit=!0;for(var e=0;8>e;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;256>e;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;255>e;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e},t.EXP_TABLE=new Array(256),t.LOG_TABLE=new Array(256),t}();t.QRMath=e,__reflect(e.prototype,"qr.QRMath")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.MODE_NUMBER=1,t.MODE_ALPHA_NUM=2,t.MODE_8BIT_BYTE=4,t.MODE_KANJI=8,t}();t.QRMode=e,__reflect(e.prototype,"qr.QRMode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var i=0;i<t.length&&0==t[i];)i++;this.num=new Array(t.length-i+e);for(var n=0;n<t.length-i;n++)this.num[n]=t[n+i]}return e.prototype.get=function(t){return this.num[t]},e.prototype.getLength=function(){return this.num.length},e.prototype.multiply=function(i){for(var n=new Array(this.getLength()+i.getLength()-1),a=0;a<this.getLength();a++)for(var s=0;s<i.getLength();s++)n[a+s]^=t.QRMath.gexp(t.QRMath.glog(this.get(a))+t.QRMath.glog(i.get(s)));return new e(n,0)},e.prototype.mod=function(i){if(this.getLength()-i.getLength()<0)return this;for(var n=t.QRMath.glog(this.get(0))-t.QRMath.glog(i.get(0)),a=new Array(this.getLength()),s=0;s<this.getLength();s++)a[s]=this.get(s);for(var s=0;s<i.getLength();s++)a[s]^=t.QRMath.gexp(t.QRMath.glog(i.get(s))+n);return new e(a,0).mod(i)},e}();t.QRPolynomial=e,__reflect(e.prototype,"qr.QRPolynomial")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.totalCount=t,this.dataCount=e}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,i){var n=e.getRsBlockTable(t,i);if(void 0==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+i);for(var a=n.length/3,s=[],o=0;a>o;o++)for(var r=n[3*o+0],h=n[3*o+1],l=n[3*o+2],c=0;r>c;c++)s.push(new e(h,l));return s},e.getRsBlockTable=function(i,n){switch(n){case t.QRErrorCorrectLevel.L:return e.RS_BLOCK_TABLE[4*(i-1)+0];case t.QRErrorCorrectLevel.M:return e.RS_BLOCK_TABLE[4*(i-1)+1];case t.QRErrorCorrectLevel.Q:return e.RS_BLOCK_TABLE[4*(i-1)+2];case t.QRErrorCorrectLevel.H:return e.RS_BLOCK_TABLE[4*(i-1)+3];default:return}},e}();t.QRRSBlock=e,__reflect(e.prototype,"qr.QRRSBlock")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.getBCHTypeInfo=function(t){for(var i=t<<10;e.getBCHDigit(i)-e.getBCHDigit(e.G15)>=0;)i^=e.G15<<e.getBCHDigit(i)-e.getBCHDigit(e.G15);return(t<<10|i)^e.G15_MASK},e.getBCHTypeNumber=function(t){for(var i=t<<12;e.getBCHDigit(i)-e.getBCHDigit(e.G18)>=0;)i^=e.G18<<e.getBCHDigit(i)-e.getBCHDigit(e.G18);return t<<12|i},e.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},e.getPatternPosition=function(t){return e.PATTERN_POSITION_TABLE[t-1]},e.getMask=function(e,i,n){switch(e){case t.QRMaskPattern.PATTERN000:return(i+n)%2==0;case t.QRMaskPattern.PATTERN001:return i%2==0;case t.QRMaskPattern.PATTERN010:return n%3==0;case t.QRMaskPattern.PATTERN011:return(i+n)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(n/3))%2==0;case t.QRMaskPattern.PATTERN101:return i*n%2+i*n%3==0;case t.QRMaskPattern.PATTERN110:return(i*n%2+i*n%3)%2==0;case t.QRMaskPattern.PATTERN111:return(i*n%3+(i+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},e.getErrorCorrectPolynomial=function(e){for(var i=new t.QRPolynomial([1],0),n=0;e>n;n++)i=i.multiply(new t.QRPolynomial([1,t.QRMath.gexp(n)],0));return i},e.getLengthInBits=function(e,i){if(i>=1&&10>i)switch(e){case t.QRMode.MODE_NUMBER:return 10;case t.QRMode.MODE_ALPHA_NUM:return 9;case t.QRMode.MODE_8BIT_BYTE:return 8;case t.QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>i)switch(e){case t.QRMode.MODE_NUMBER:return 12;case t.QRMode.MODE_ALPHA_NUM:return 11;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>i))throw new Error("type:"+i);switch(e){case t.QRMode.MODE_NUMBER:return 14;case t.QRMode.MODE_ALPHA_NUM:return 13;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},e.getLostPoint=function(t){for(var e=t.getModuleCount(),i=0,n=0;e>n;n++)for(var a=0;e>a;a++){for(var s=0,o=t.isDark(n,a),r=-1;1>=r;r++)if(!(0>n+r||n+r>=e))for(var h=-1;1>=h;h++)0>a+h||a+h>=e||(0!=r||0!=h)&&o==t.isDark(n+r,a+h)&&s++;s>5&&(i+=3+s-5)}for(var n=0;e-1>n;n++)for(var a=0;e-1>a;a++){var l=0;t.isDark(n,a)&&l++,t.isDark(n+1,a)&&l++,t.isDark(n,a+1)&&l++,t.isDark(n+1,a+1)&&l++,(0==l||4==l)&&(i+=3)}for(var n=0;e>n;n++)for(var a=0;e-6>a;a++)t.isDark(n,a)&&!t.isDark(n,a+1)&&t.isDark(n,a+2)&&t.isDark(n,a+3)&&t.isDark(n,a+4)&&!t.isDark(n,a+5)&&t.isDark(n,a+6)&&(i+=40);for(var a=0;e>a;a++)for(var n=0;e-6>n;n++)t.isDark(n,a)&&!t.isDark(n+1,a)&&t.isDark(n+2,a)&&t.isDark(n+3,a)&&t.isDark(n+4,a)&&!t.isDark(n+5,a)&&t.isDark(n+6,a)&&(i+=40);for(var c=0,a=0;e>a;a++)for(var n=0;e>n;n++)t.isDark(n,a)&&c++;var d=Math.abs(100*c/e/e-50)/5;return i+=10*d},e.prototype.static_isSupportCanvas=function(){return"undefined"!=typeof CanvasRenderingContext2D},e._getTypeNumber=function(i,n){for(var a=1,s=e._getUTF8Length(i),o=0,r=e.QRCodeLimitLength.length;r>=o;o++){var h=0;switch(n){case t.QRErrorCorrectLevel.L:h=e.QRCodeLimitLength[o][0];break;case t.QRErrorCorrectLevel.M:h=e.QRCodeLimitLength[o][1];break;case t.QRErrorCorrectLevel.Q:h=e.QRCodeLimitLength[o][2];break;case t.QRErrorCorrectLevel.H:h=e.QRCodeLimitLength[o][3]}if(h>=s)break;a++}if(a>e.QRCodeLimitLength.length)throw new Error("Too long data");return a},e._getUTF8Length=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)},e.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],e.G15=1335,e.G18=7973,e.G15_MASK=21522,e.QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],e}();t.QRUtil=e,__reflect(e.prototype,"qr.QRUtil")}(qr||(qr={}));var ArrayUtils;!function(t){function e(t,e){return-1!=t.indexOf(e)}function i(t,e){if(null==e)return-1;var i=t.indexOf(e);return-1!=i&&t.splice(i,1),i}function n(t){return t.slice()}function a(t,e){if(t.length!=e.length)return!1;for(var i=t.length,n=0;i>n;n++)if(t[n]!==e[n])return!1;return!0}t.arrayContainsValue=e,t.removeValueFromArray=i,t.copyArray=n,t.arrayAreEqual=a}(ArrayUtils||(ArrayUtils={}));var DHitTest;!function(t){function e(t,e){return t.y<e.bottom&&t.bottom>e.y&&t.x<e.right&&t.right>e.x}function i(t,i){var n=t.getBounds(),a=i.getBounds();return e(n,a)?void 0:!1}t.hitTestRect=e,t.hitTestObject=i}(DHitTest||(DHitTest={}));var DHtmlString;!function(t){function e(t,e,i){return void 0===i&&(i=-1),-1!=i?"<font color='"+e+"' size='"+i+"'>"+t+"</font>":"<font color='"+e+"'>"+t+"</font>"}t.getColorStr=e}(DHtmlString||(DHtmlString={}));var DMath;!function(t){function e(t){return 0>t?-t:t}function i(t){return t>>0}function n(t,e,i,n){return c.x=t,c.y=e,d.x=i,d.y=n,egret.Point.distance(c,d)}function a(t){return 180*t/Math.PI}function s(t){return t*Math.PI/180}function o(t,e){if(t==e)return t;if(t>e){var n=t;t=e,e=n}var a=t+i(Math.random()*(e-t+1));return a}function r(t,e,i){return Math.min(Math.max(t,e),i)}function h(t,e,i,n,s){void 0===s&&(s=!1);var o=Math.atan2(e-n,t-i)+Math.PI/2;return s?o:a(o)}function l(t,e){t%=360;var i=Math.cos(s(t-90))*e,n=Math.sin(s(t-90))*e;return new egret.Point(i,n)}t.abs=e,t.floor=i;var c=new egret.Point,d=new egret.Point;t.getDistance=n,t.rad2deg=a,t.deg2rad=s,t.randomInt=o,t.range=r,t.getAngle=h,t.getRadianXY=l}(DMath||(DMath={}));var DomImg=function(t){function e(){var e=t.call(this)||this;return e.drawBg(),e.touchEnabled=!0,e}return __extends(e,t),e.prototype.drawBg=function(){var t=new egret.Shape;this.addChildAt(t,0),t.graphics.beginFill(0,.5),t.graphics.drawRect(-10,-10,GameGlobal.stageW+20,GameGlobal.stageH+20),t.graphics.endFill()},e.prototype.showCode=function(t){if(egret.setTimeout(this.regEvent,this,400),this.imgUrl=t,GameGlobal.stage.addChild(this),null==this.myImg){var e=document.getElementById("gameDiv");this.myImg=document.createElement("img"),this.myImg.src=t,this.myImg.style.position="absolute",e.appendChild(this.myImg)}var i=document.body.clientWidth,n=document.body.clientHeight,a=i/3*2,s=(i-a)/2,o=.23*n;document.body.clientWidth/GameGlobal.stageW,document.body.clientHeight/GameGlobal.stageH;this.myImg.style.width=a+"px",this.myImg.style.height=a+"px",this.myImg.style.left=s+"px",this.myImg.style.top=o+"px",this.myImg.style.display="inline"},e.prototype.regEvent=function(){GameGlobal.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hide_qr,this)},e.prototype.hide_qr=function(t){if(this.myImg){var e=document.getElementById("gameDiv");e.removeChild(this.myImg),this.onDestroy(),this.myImg=null,GameGlobal.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.hide_qr,this),this.parent&&this.parent.removeChild(this)}},e.prototype.hideCode=function(){this.myImg&&(this.myImg.style.display="none")},e.prototype.onDestroy=function(){this.codeImg=null},e}(egret.Sprite);__reflect(DomImg.prototype,"DomImg");var DTweener=function(){function t(){}return t.fadeIn=function(t,e,i,n,a){void 0===e&&(e=.3),void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=null),t.alpha=0,null!=i?egret.Tween.get(t).to({alpha:1},1e3*e).call(i,n,a):egret.Tween.get(t).to({alpha:1},1e3*e)},t.fadeOut=function(t,e,i,n,a){void 0===e&&(e=.3),void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=null),t.alpha=1,null!=i?egret.Tween.get(t).to({alpha:0},1e3*e).call(i,n,a):egret.Tween.get(t).to({alpha:0},1e3*e)},t.shake=function(t){var e=80,i=t.x;egret.Tween.get(t).to({x:t.x-10},e),egret.setTimeout(function(){egret.Tween.get(t).to({x:t.x+20},e)},this,2*e),egret.setTimeout(function(){egret.Tween.get(t).to({x:t.x-20},e)},this,3*e),egret.setTimeout(function(){egret.Tween.get(t).to({x:t.x+20},e)},this,4*e),egret.setTimeout(function(){egret.Tween.get(t).to({x:i},e)},this,5*e)},t.shakeScreen=function(t){var e=40,i=t.x,n=t.y;egret.Tween.removeTweens(t);var a=egret.Tween.get(t);a.to({x:t.x-10,y:t.y},e),a.wait(2*e),a.to({x:t.x+20,y:t.y},e),a.wait(3*e),a.to({x:t.x,y:t.y+15},e),a.wait(4*e),a.to({x:t.x,y:t.y-20},e),a.wait(5*e),a.to({x:t.x,y:t.y+10},e),a.wait(6*e),a.to({x:i,y:n},e)},t}();__reflect(DTweener.prototype,"DTweener");var DUtils=function(){function t(){}return t.hitTestRect=function(t,e){return t.y<e.bottom&&t.bottom>e.y&&t.x<e.right&&t.right>e.x},t.getArrayByPage=function(t,e,i){if(void 0===i&&(i=5),null==t)return null;var n=(e-1)*i,a=n+i;return a=Math.min(a,t.length),t.slice(n,a)},t.formatNumber=function(t){for(var e=t.toString(),i=e.split(""),n=new Array,a=new Array,s=i.length-1;s>=0;s--)a.length<3?(a.push(i[s]),0==s&&n.push(a)):(n.push(a),a=[],a.push(i[s]),0==s&&n.push(a));for(var o=new Array,r=0;r<n.length;r++){var h=n[r];if(r!=n.length-1){var l=",";h.push(l)}for(var c=0;c<h.length;c++)o.push(h[c])}for(var d="",s=o.length-1;s>=0;s--)d+=o[s];return d},t.createSimpleButton=function(e,i,n,a,s){void 0===s&&(s="");var o=new egret.Sprite;return null!=s?o.addChild(t.createBitmapByName(s)):(o.graphics.beginFill(0,0),o.graphics.drawRect(0,0,n,a),o.graphics.endFill()),o.x=e,o.y=i,o.touchEnabled=!0,o},t.createTextField=function(t,e,i,n,a,s,o,r){void 0===s&&(s=""),void 0===o&&(o=!1),void 0===r&&(r=egret.TextFieldType.INPUT);var h=new egret.TextField;return h.fontFamily=GameGlobal.DEFAULT_FONT_NAME,h.textAlign=egret.HorizontalAlign.LEFT,h.x=t,h.y=e,h.size=a,h.multiline=o,-1!=i&&(h.width=i),-1!=n&&(h.height=n),h.text=s,h},t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.createMovieClipByName=function(t){var e=new egret.MovieClip,i=RES.getRes(t+"_json"),n=RES.getRes(t+"_png"),a=new egret.MovieClipDataFactory(i,n);return e=new egret.MovieClip(a.generateMovieClipData(t))},t.createSpriteSheetByName=function(t,e){var i=new egret.Bitmap,n=RES.getRes(t);return i.texture=n.getTexture(e),i},t.getRequestParamByName=function(e){var i=new Object;return i=t.getRequestParams(),i[e]},t.getRequestParams=function(){var t=document.location.search,e=new Object;if(-1!=t.indexOf("?"))for(var i=t.substr(1),n=i.split("&"),a=0;a<n.length;a++)e[n[a].split("=")[0]]=n[a].split("=")[1];return e},t.randArray=function(t){t.sort(function(){return.5-Math.random()})},t.createRandomNum=function(t,e){void 0===t&&(t=0);var i=Math.floor(Math.random()*(e-t+1))+t;return i},t}();__reflect(DUtils.prototype,"DUtils");var EffectUtils=function(){function t(){}return t.createGradient=function(t,e){var i=new egret.Matrix;i.createGradientBox(t,e,.5*Math.PI,0,0);var n=new egret.Shape;return n.graphics.beginGradientFill(egret.GradientType.LINEAR,[8307956,15530751],[1,1],[0,255],i),n.graphics.drawRect(0,0,t,e),n.graphics.endFill(),n
},t.typeWordEffect=function(t,e,i){void 0===i&&(i=200);for(var n=e.split(""),a=n.length,s=0;a>s;s++)egret.setTimeout(function(){t.appendText(n[s])},s,i*s)},t.numTextEffect=function(t,e,i,n){void 0===n&&(n=null)},t.grayMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],t.grayFlilter=[new egret.ColorMatrixFilter(t.grayMatrix)],t.grayFlilter1=[new egret.ColorMatrixFilter([.1,.1,0,0,200,.1,.1,0,0,0,.1,.1,0,0,0,0,0,0,1,0])],t.DM_Filter=[new egret.GlowFilter(1348416,.5,30,30,2,1)],t.GZ_Filter=[new egret.GlowFilter(11588940,.5,30,30,2,1)],t.JZ_Filter=[new egret.GlowFilter(13944964,.5,30,30,2,1)],t.RP_Filter=[new egret.GlowFilter(5029887,.5,30,30,2,1)],t.QP_Filter=[new egret.GlowFilter(10658466,.5,30,30,2,1)],t.AI_Filter=[new egret.GlowFilter(13369344,.5,30,30,2,1)],t}();__reflect(EffectUtils.prototype,"EffectUtils");var GameUtils=function(){function t(){}return t.sitId2LR2=function(t,e){return t==e?0:e>t?e-t:12-(t-e)},t.sitId2LR=function(t,e){if(t==e)return 0;if(5==t){if(1==e)return 1;if(4==e)return-1;if(2==e)return 2;if(3==e)return-2}else if(4==t){if(5==e)return 1;if(3==e)return-1;if(1==e)return 2;if(2==e)return-2}else if(3==t){if(4==e)return 1;if(2==e)return-1;if(5==e)return 2;if(1==e)return-2}else if(2==t){if(4==e)return 2;if(3==e)return 1;if(5==e)return-2;if(1==e)return-1}else{if(2==e)return 1;if(3==e)return 2;if(4==e)return-2;if(5==e)return-1}},t.PLAYER_POS_ARR=[[522,423],[731,423],[995,390],[1048,257],[995,132],[810,61],[579,58],[275,59],[103,130],[49,254],[96,390],[286,423]],t}();__reflect(GameUtils.prototype,"GameUtils");var Guid=function(){function t(){}return t.create=function(){var e=new Date,i=e.getTime(),n=Math.random()*Number.MAX_VALUE,a=window.navigator.userAgent,s=t.calculate(i+a+n+t.counter++).toUpperCase(),o=s.substring(0,8)+"-"+s.substring(8,12)+"-"+s.substring(12,16)+"-"+s.substring(16,20)+"-"+s.substring(20,32);return o},t.calculate=function(e){return t.hex_sha1(e)},t.hex_sha1=function(e){return t.binb2hex(t.core_sha1(t.str2binb(e),8*e.length))},t.core_sha1=function(e,i){e[i>>5]|=128<<24-i%32,e[(i+64>>9<<4)+15]=i;for(var n=new Array(80),a=1732584193,s=-271733879,o=-1732584194,r=271733878,h=-1009589776,l=0;l<e.length;l+=16){for(var c=a,d=s,_=o,g=r,u=h,p=0;80>p;p++){16>p?n[p]=e[l+p]:n[p]=t.rol(n[p-3]^n[p-8]^n[p-14]^n[p-16],1);var m=t.safe_add(t.safe_add(t.rol(a,5),t.sha1_ft(p,s,o,r)),t.safe_add(t.safe_add(h,n[p]),t.sha1_kt(p)));h=r,r=o,o=t.rol(s,30),s=a,a=m}a=t.safe_add(a,c),s=t.safe_add(s,d),o=t.safe_add(o,_),r=t.safe_add(r,g),h=t.safe_add(h,u)}return new Array(a,s,o,r,h)},t.sha1_ft=function(t,e,i,n){return 20>t?e&i|~e&n:40>t?e^i^n:60>t?e&i|e&n|i&n:e^i^n},t.sha1_kt=function(t){return 20>t?1518500249:40>t?1859775393:60>t?-1894007588:-899497514},t.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},t.rol=function(t,e){return t<<e|t>>>32-e},t.str2binb=function(t){for(var e=new Array,i=255,n=0;n<8*t.length;n+=8)e[n>>5]|=(t.charCodeAt(n/8)&i)<<24-n%32;return e},t.binb2hex=function(t){for(var e="",i="0123456789abcdef",n=0;n<4*t.length;n++)e+=i.charAt(t[n>>2]>>8*(3-n%4)+4&15)+i.charAt(t[n>>2]>>8*(3-n%4)&15);return e},t.counter=0,t}();__reflect(Guid.prototype,"Guid");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.showLogin=function(){var t=new CommandVo;t.action=HttpCommand.LOGIN,HttpCommand.send(t,this,this.loginResponse)},e.prototype.onSelected=function(t){},e.prototype.onTouchTap=function(t){if(!this._xieyiCB.selected)return void AlertView.getInstance().show("请勾选阅读用户协议！");if(GameGlobal.debug)return void GameEventManager.dispatchEvent(GameEventManager.LOGIN_SUCCESS);if(GameGlobal.useWeixin)LogUtils.log("call app::login"),egret.ExternalInterface.call("login","egret");else{var e=new CommandVo;e.action=HttpCommand.LOGIN,HttpCommand.send(e,this,this.loginResponse)}},e.prototype.loginResponse=function(t){console.log("loginResponse");var e=t.data;MyUserInfo.getInstance().init(e),GameGlobal.SOCKET_IP=e.serverIp,GameGlobal.SOCKET_PORT=e.port,GameModel.instance().token=e.token,egret.ExternalInterface.call("sendToken","http://"+GameGlobal.SOCKET_IP+":"+GameGlobal.SOCKET_PORT+"/game/upload|"+GameModel.instance().token),e.hasOwnProperty("roomId")&&null!=e.roomId&&(GameModel.instance().roomId=e.roomId),GameEventManager.dispatchEvent(GameEventManager.LOGIN_SUCCESS,t)},e.prototype.startLoad=function(){this._wxLoginBtn&&this._wxLoginBtn.stage||(this._progressBar.visible=!0)},e.prototype.createView=function(){this._progressBar=new DProgressBar,this._progressBar.setValue(0),this.addChild(this._progressBar),this._progressBar.y=(GameGlobal.stage.stageHeight-this._progressBar.height>>1)+50,this._progressBar.x=GameGlobal.stage.stageWidth-this._progressBar.width>>1,this._progressBar.visible=!1,this._loadingText=new egret.TextField,this._loadingText.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._loadingText.size=28,this._loadingText.textAlign=egret.HorizontalAlign.CENTER,this._loadingText.width=this._progressBar.width,this._loadingText.text="拼命加载中，请稍后...",this.addChild(this._loadingText),this._loadingText.textColor=16777215,this._loadingText.x=this._progressBar.x,this._loadingText.y=this._progressBar.y-50,this._gameTipTF=new egret.TextField,this._gameTipTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._gameTipTF.size=20,this._gameTipTF.textAlign=egret.HorizontalAlign.LEFT,this._gameTipTF.text="抵制不良游戏，拒绝盗版游戏。注意自我保护，谨防受骗上当。\n适度游戏益脑，沉迷游戏伤身。合理安排时间，享受健康生活。",this.addChild(this._gameTipTF),this._gameTipTF.textColor=16777215,this._gameTipTF.lineSpacing=10,this._gameTipTF.x=GameGlobal.stageW-this._gameTipTF.textWidth>>1,this._gameTipTF.y=GameGlobal.stageH-this._gameTipTF.textHeight-50,this.startLoad()},e.prototype.setProgress=function(t,e){this._progressBar.setValue(t,e)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var InputValidate;!function(t){function e(t){var e=new RegExp("^[\\w-]+(\\.[\\w-]+)*@[\\w-]+(\\.[\\w-]+)+$");return e.test(t)}function i(t){var e=/^(?=.*\d)[a-z\d]{6,15}$/i;return e.test(t)}function n(t){var e=/^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return e.test(t)}function a(t){var e=/[\u4e00-\u9fa5]/;return e.test(t)}function s(t){var e=/[a-zA-z]+:\/\/[^\s]*/;return e.test(t)}function o(t){var e=/\d{3}-\d{8}|\d{4}-\d{7}/;return e.test(t)}function r(t){var e=/[1-9][0-9]{4,}/;return e.test(t)}function h(t){var e=/[1-9]\d{5}(?!\d)/;return e.test(t)}function l(t){var e=/^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[X])$/;return e.test(t)}t.isEmail=e,t.isRightPassword=i,t.isPhone=n,t.isChinese=a,t.isUrl=s,t.isTelephone=o,t.isQQ=r,t.isPost=h,t.isIdCard=l}(InputValidate||(InputValidate={}));var LogUtils=function(){function t(){}return t.log=function(t,e){void 0===e&&(e="black");var i=new Date,n=i.getMinutes(),a=n.toString();console.log(a+":"+i.getSeconds()+":"+i.getMilliseconds()+" %c["+t+"]","color:"+e)},t}();__reflect(LogUtils.prototype,"LogUtils");var md5=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var n=Array(16),a=Array(16),s=0;16>s;s++)n[s]=909522486^i[s],a[s]=1549556828^i[s];var o=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(a.concat(o),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",a="",s=0;s<t.length;s++)i=t.charCodeAt(s),a+=n.charAt(i>>>4&15)+n.charAt(15&i);return a},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",a=t.length,s=0;a>s;s+=3)for(var o=t.charCodeAt(s)<<16|(a>s+1?t.charCodeAt(s+1)<<8:0)|(a>s+2?t.charCodeAt(s+2):0),r=0;4>r;r++)n+=8*s+6*r>8*t.length?this.b64pad:i.charAt(o>>>6*(3-r)&63);return n},t.prototype.rstr2any=function(t,e){var i,n,a,s,o,r=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var l=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),c=Array(l);for(n=0;l>n;n++){for(o=Array(),s=0,i=0;i<h.length;i++)s=(s<<16)+h[i],a=Math.floor(s/r),s-=a*r,(o.length>0||a>0)&&(o[o.length]=a);c[n]=s,h=o}var d="";for(i=c.length-1;i>=0;i--)d+=e.charAt(c[i]);return d},t.prototype.str2rstr_utf8=function(t){for(var e,i,n="",a=-1;++a<t.length;)e=t.charCodeAt(a),i=a+1<t.length?t.charCodeAt(a+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),a++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},t.prototype.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},t.prototype.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,n=-271733879,a=-1732584194,s=271733878,o=0;o<t.length;o+=16){var r=i,h=n,l=a,c=s;i=this.md5_ff(i,n,a,s,t[o+0],7,-680876936),s=this.md5_ff(s,i,n,a,t[o+1],12,-389564586),a=this.md5_ff(a,s,i,n,t[o+2],17,606105819),n=this.md5_ff(n,a,s,i,t[o+3],22,-1044525330),i=this.md5_ff(i,n,a,s,t[o+4],7,-176418897),s=this.md5_ff(s,i,n,a,t[o+5],12,1200080426),a=this.md5_ff(a,s,i,n,t[o+6],17,-1473231341),n=this.md5_ff(n,a,s,i,t[o+7],22,-45705983),i=this.md5_ff(i,n,a,s,t[o+8],7,1770035416),s=this.md5_ff(s,i,n,a,t[o+9],12,-1958414417),a=this.md5_ff(a,s,i,n,t[o+10],17,-42063),n=this.md5_ff(n,a,s,i,t[o+11],22,-1990404162),i=this.md5_ff(i,n,a,s,t[o+12],7,1804603682),s=this.md5_ff(s,i,n,a,t[o+13],12,-40341101),a=this.md5_ff(a,s,i,n,t[o+14],17,-1502002290),n=this.md5_ff(n,a,s,i,t[o+15],22,1236535329),i=this.md5_gg(i,n,a,s,t[o+1],5,-165796510),s=this.md5_gg(s,i,n,a,t[o+6],9,-1069501632),a=this.md5_gg(a,s,i,n,t[o+11],14,643717713),n=this.md5_gg(n,a,s,i,t[o+0],20,-373897302),i=this.md5_gg(i,n,a,s,t[o+5],5,-701558691),s=this.md5_gg(s,i,n,a,t[o+10],9,38016083),a=this.md5_gg(a,s,i,n,t[o+15],14,-660478335),n=this.md5_gg(n,a,s,i,t[o+4],20,-405537848),i=this.md5_gg(i,n,a,s,t[o+9],5,568446438),s=this.md5_gg(s,i,n,a,t[o+14],9,-1019803690),a=this.md5_gg(a,s,i,n,t[o+3],14,-187363961),n=this.md5_gg(n,a,s,i,t[o+8],20,1163531501),i=this.md5_gg(i,n,a,s,t[o+13],5,-1444681467),s=this.md5_gg(s,i,n,a,t[o+2],9,-51403784),a=this.md5_gg(a,s,i,n,t[o+7],14,1735328473),n=this.md5_gg(n,a,s,i,t[o+12],20,-1926607734),i=this.md5_hh(i,n,a,s,t[o+5],4,-378558),s=this.md5_hh(s,i,n,a,t[o+8],11,-2022574463),a=this.md5_hh(a,s,i,n,t[o+11],16,1839030562),n=this.md5_hh(n,a,s,i,t[o+14],23,-35309556),i=this.md5_hh(i,n,a,s,t[o+1],4,-1530992060),s=this.md5_hh(s,i,n,a,t[o+4],11,1272893353),a=this.md5_hh(a,s,i,n,t[o+7],16,-155497632),n=this.md5_hh(n,a,s,i,t[o+10],23,-1094730640),i=this.md5_hh(i,n,a,s,t[o+13],4,681279174),s=this.md5_hh(s,i,n,a,t[o+0],11,-358537222),a=this.md5_hh(a,s,i,n,t[o+3],16,-722521979),n=this.md5_hh(n,a,s,i,t[o+6],23,76029189),i=this.md5_hh(i,n,a,s,t[o+9],4,-640364487),s=this.md5_hh(s,i,n,a,t[o+12],11,-421815835),a=this.md5_hh(a,s,i,n,t[o+15],16,530742520),n=this.md5_hh(n,a,s,i,t[o+2],23,-995338651),i=this.md5_ii(i,n,a,s,t[o+0],6,-198630844),s=this.md5_ii(s,i,n,a,t[o+7],10,1126891415),a=this.md5_ii(a,s,i,n,t[o+14],15,-1416354905),n=this.md5_ii(n,a,s,i,t[o+5],21,-57434055),i=this.md5_ii(i,n,a,s,t[o+12],6,1700485571),s=this.md5_ii(s,i,n,a,t[o+3],10,-1894986606),a=this.md5_ii(a,s,i,n,t[o+10],15,-1051523),n=this.md5_ii(n,a,s,i,t[o+1],21,-2054922799),i=this.md5_ii(i,n,a,s,t[o+8],6,1873313359),s=this.md5_ii(s,i,n,a,t[o+15],10,-30611744),a=this.md5_ii(a,s,i,n,t[o+6],15,-1560198380),n=this.md5_ii(n,a,s,i,t[o+13],21,1309151649),i=this.md5_ii(i,n,a,s,t[o+4],6,-145523070),s=this.md5_ii(s,i,n,a,t[o+11],10,-1120210379),a=this.md5_ii(a,s,i,n,t[o+2],15,718787259),n=this.md5_ii(n,a,s,i,t[o+9],21,-343485551),i=this.safe_add(i,r),n=this.safe_add(n,h),a=this.safe_add(a,l),s=this.safe_add(s,c)}return[i,n,a,s]},t.prototype.md5_cmn=function(t,e,i,n,a,s){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,s)),a),i)},t.prototype.md5_ff=function(t,e,i,n,a,s,o){return this.md5_cmn(e&i|~e&n,t,e,a,s,o)},t.prototype.md5_gg=function(t,e,i,n,a,s,o){return this.md5_cmn(e&n|i&~n,t,e,a,s,o)},t.prototype.md5_hh=function(t,e,i,n,a,s,o){return this.md5_cmn(e^i^n,t,e,a,s,o)},t.prototype.md5_ii=function(t,e,i,n,a,s,o){return this.md5_cmn(i^(e|~n),t,e,a,s,o)},t.prototype.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();__reflect(md5.prototype,"md5");var MovieClipUtils=function(){function t(){}return t.playOnce=function(t,e){void 0===e&&(e=null),null==e&&(e=this._onPlayOnceEnd),t.gotoAndPlay(1),this._all.put(t,e),1==this._all.size()&&EnterFrameManager.addEnterFrameHandler(this._enterFrameHandler,this)},t._enterFrameHandler=function(){for(var t in this._all.keys){var e=this._all.keys[t];if(e.currentFrame==e.totalFrames){e.stop();var i=this._all.get(e);i(e),this._all.remove(e)}}0==this._all.size()&&EnterFrameManager.removeEnterFrameHandler(this._enterFrameHandler)},t._onPlayOnceEnd=function(t){null!=t.parent&&t.parent.removeChild(t)},t.remove=function(t,e){void 0===e&&(e=!1);var i=this._all.remove(t);e&&i instanceof Function&&i(t)},t._all=new HashMap,t}();__reflect(MovieClipUtils.prototype,"MovieClipUtils");var ServerDate=function(){function t(){}return t.setServerTime=function(t){this._serverTime=t,this._lastTime=egret.getTimer()},t.getServerTime=function(){return this._serverTime+egret.getTimer()-this._lastTime},t}();__reflect(ServerDate.prototype,"ServerDate");var ShakeManager=function(){function t(){this.count=0,this.timer=new egret.Timer(1e3)}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.shakeObj=function(t,e,i,n){this.target=t,this.initX=t.x,this.initY=t.y,this.maxDis=n,this.count=e*i,this.rate=i,this.timer.delay=1e3/i,this.timer.repeatCount=this.count,this.timer.addEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this),this.timer.reset(),this.timer.start()},t.prototype.shaking=function(){egret.Tween.removeTweens(this.target),this.target.x=this.initX-this.maxDis+Math.random()*this.maxDis*2,this.target.y=this.initY-this.maxDis+Math.random()*this.maxDis*2,egret.Tween.get(this.target).to({x:this.initX,y:this.initY},999/this.rate)},t.prototype.shakeComplete=function(){this.target&&(egret.Tween.removeTweens(this.target),this.target.x=this.initX,this.target.y=this.initY),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.shaking,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.shakeComplete,this)},t.prototype.stop=function(){this.shakeComplete()},t._instance=null,t}();__reflect(ShakeManager.prototype,"ShakeManager");var StringUtils;!function(t){function e(t,e){for(var i=e.length,n=0;i>n;n++)t=t.replace("{"+n+"}",e[n]);return t}function i(t,e,i){return void 0===i&&(i=!1),i?t.toLowerCase()==e.toLowerCase():t==e}function n(t){return t.replace(/\r\n/gm,"\n")}function a(t){return s(o(t))}function s(t){return t.replace(/^\s*/,"")}function o(t){return t.replace(/\s*$/,"")}t.format=e,t.isEqual=i,t.fixNewline=n,t.trim=a,t.ltrim=s,t.rtrim=o}(StringUtils||(StringUtils={}));var TextFieldUtils=function(){function t(){}return t.flickerTextField=function(e,i,n,a){if(void 0===i&&(i=16711680),void 0===n&&(n=1),void 0===a&&(a=.1),!t._allFlickerTextFields.containsKey(e)){var s=e;s.touchEnabled=!1,s.border=s.background=!1,s.type=egret.TextFieldType.DYNAMIC;var o=Math.floor(30*n),r=Math.floor(30*a);t._allFlickerTextFields.put(e,[s,i,o,r,0]),1==t._allFlickerTextFields.size()&&EnterFrameManager.addEnterFrameHandler(this.__flickerTextField,this)}},t.stopFlickerTextField=function(e){var i=t._allFlickerTextFields.get(e);null!=i&&(i[2]=0)},t.__flickerTextField=function(){for(var e=t._allFlickerTextFields.keys,i=e.length,n=0;i>n;n++){var a=e[n],s=t._allFlickerTextFields.get(a),o=s[0],r=s[1],h=s[2],l=s[3],c=s[4]++;if(null!=o.parent&&o.parent.removeChild(o),o.textColor=r,o.x=o.x,o.y=o.y,c>=h)t._allFlickerTextFields.remove(a);else if(a.parent&&Math.floor(c/l)%2==0){var d=a.parent.getChildIndex(a)+1;a.parent.addChildAt(o,d)}}},t._allFlickerTextFields=new HashMap,t}();__reflect(TextFieldUtils.prototype,"TextFieldUtils");var BetInfoView=function(t){function e(){var e=t.call(this)||this;return e._curRound=1,e._totalRound=1,e._dizhu=10,e._danzhuLimit=10,e._roomId=1,e._chip=0,e.initView(),e}return __extends(e,t),e.prototype.resize=function(){this._chipBg.y=GameGlobal.stageH-491,this._chipTF.y=GameGlobal.stageH-485},e.prototype.updateRound=function(t,e){this._curRound=t,this._curRound=Math.max(1,this._curRound),this._totalRound=e,this._roomIdTF.text="房号："+this._roomId+"  第"+this._curRound+"/"+this._totalRound+"局",this._chip=0,this._chipTF.text=this._chip.toString()},e.prototype.init=function(t,e){void 0===e&&(e=10),this._roomId=t,this._curRound=1,this._totalRound=e,this._chip=0,this._chipTF.text=this._chip.toString(),this._roomIdTF.text="房号："+this._roomId+"  第"+this._curRound+"/"+this._totalRound+"局",this.updateCurrentRound(1)},e.prototype.updateCurrentRound=function(t){this._dizhuTF.text="当局押注轮次 "+t+"/"+e.MAXROUND},e.prototype.addChip=function(t){this._chip+=t,console.log("current chip = "+this._chip),this._chipTF.text=this._chip.toString()},e.prototype.initView=function(){this._roomIdTF=new egret.TextField,this._roomIdTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._roomIdTF.textColor=16777215,this._roomIdTF.size=25,this._roomIdTF.bold=!0,this._roomIdTF.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this._roomIdTF),this._roomIdTF.x=476,this._roomIdTF.text="房号：0  第1/1局",this._dizhuTF=new egret.TextField,this._dizhuTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._dizhuTF.textColor=16777215,this._dizhuTF.bold=!0,this._dizhuTF.size=25,this._dizhuTF.textAlign=egret.HorizontalAlign.LEFT,this.addChild(this._dizhuTF),this._dizhuTF.text="当局押注轮次 1/"+e.MAXROUND,this._chipBg=new egret.Bitmap,this._chipBg.texture=RES.getRes("game_json.xiazhujineBg"),this.addChild(this._chipBg),this._chipBg.x=340,this._chipBg.y=GameGlobal.stageH-491,this._chipTF=new egret.TextField,this._chipTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._chipTF.textColor=16777215,this._chipTF.size=17,this._chipTF.textAlign=egret.HorizontalAlign.LEFT,this._chipTF.x=385,this._chipTF.y=GameGlobal.stageH-485,this.addChild(this._chipTF),this._chipTF.text="0"},e.MAXROUND=30,e}(egret.Sprite);__reflect(BetInfoView.prototype,"BetInfoView");var BindIdView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.show=function(){this._inputTF.text="请输入推荐人号码"},e.prototype.hide=function(){GameEventManager.removeEvent(NetAction.bind.toString(),this.onBindResponse,this)},e.prototype.showComplete=function(){this.touchEnabled=!0;var t=new egret.Bitmap;t.texture=RES.getRes("bindBg_png"),this.addChild(t),this._inputTF=new egret.TextField,this._inputTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._inputTF.textColor=0,this._inputTF.size=40,this._inputTF.type=egret.TextFieldType.INPUT,this.addChild(this._inputTF),this._inputTF.x=126,this._inputTF.y=200,this._inputTF.width=480,this._inputTF.height=58,this._inputTF.text="请输入推荐人号码",this._inputTF.addEventListener(egret.FocusEvent.FOCUS_IN,this.onInputFocusIn,this),this._inputTF.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onInputFocusOut,this),this._bindBtn=new DButton("ui_json.bindBtn"),this._bindBtn.x=this.width-this._bindBtn.width>>1,this._bindBtn.y=324,this.addChild(this._bindBtn),this._bindBtn.touchEnabled=!0,this._closeBtn=new DButton("ui_json.closeBtn"),this._closeBtn.x=665,this._closeBtn.y=10,this.addChild(this._closeBtn),this._closeBtn.touchEnabled=!0,this._bindBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap2,this),this.iframeWidth=this.width,this.iframeHeight=this.height},e.prototype.onInputFocusIn=function(t){"请输入推荐人号码"==this._inputTF.text&&(this._inputTF.text="")},e.prototype.onTouchTap2=function(t){GameGlobal.iframeLayer.hideIFrame(e)},e.prototype.onInputFocusOut=function(t){""==this._inputTF.text&&(this._inputTF.text="请输入推荐人号码")},e.prototype.onTouchTap=function(t){var e=this._inputTF.text.trim();if(""==e)return void AlertView.getInstance().show("请输入推广码！",AlertView.ALERT_MODE);GameEventManager.addEvent(NetAction.bind.toString(),this.onBindResponse,this);var i={};i.msgType=NetAction.bind,i.gameType=0,i.msg={proxyId:e},SocketCommand.getInstance().send(i)},e.prototype.onBindResponse=function(t){AlertView.getInstance().show("恭喜，绑定成功！",AlertView.ALERT_MODE),GameGlobal.iframeLayer.hideIFrame(e)},e}(IFrameBase);__reflect(BindIdView.prototype,"BindIdView");var BiPaiView=function(t){function e(){var e=t.call(this)||this;return e._timeoutId=-1,e.initView(),e}return __extends(e,t),e.getInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.show=function(t){var e=this;this._data=t,GameGlobal.stage.addChild(this);var i={nickName:MyUserInfo.getInstance().userName,headImgUrl:MyUserInfo.getInstance().faceUrl};this._leftPlayerView.setPlayerInfo(i);var n=t.loserId,a=t.winnerId,s={};s=this._data.winnerId==MyUserInfo.getInstance().userId?GameGlobal.mapLayer.getBattle().getPlayerInfoById(n):GameGlobal.mapLayer.getBattle().getPlayerInfoById(a),this._rightPlayerView.setPlayerInfo(s),SoundManager.instance.playSound("vs_mp3"),egret.clearTimeout(this._timeoutId),this._timeoutId=egret.setTimeout(this.timeoutHandle,this,3e3),this._vsImg.y=-100,egret.Tween.get(this._vsImg).to({y:49},100,egret.Ease.backIn).call(function(){null==e._zhadanMc&&(e._zhadanMc=DUtils.createMovieClipByName("zhadan")),e._zhadanMc.frameRate=12,e._zhadanMc.gotoAndStop(1),SoundManager.instance.playSound("bomb_mp3"),e._data.winnerId==MyUserInfo.getInstance().userId?(e._zhadanMc.x=215,e._zhadanMc.y=-64):(e._zhadanMc.x=675,e._zhadanMc.y=-64),e.addChild(e._zhadanMc),MovieClipUtils.playOnce(e._zhadanMc,function(){GameEventManager.dispatchEvent("compareComplete",e._data)})},this)},e.prototype.timeoutHandle=function(){egret.clearTimeout(this._timeoutId),this.hide()},e.prototype.hide=function(){GameGlobal.stage.contains(this)&&GameGlobal.stage.removeChild(this)},e.prototype.initView=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("bipaiBg_png"),this.addChild(this._bg),this._leftPlayerView=new PlayerBaseInfoView,this.addChild(this._leftPlayerView),this._leftPlayerView.x=55,this._leftPlayerView.y=20,this._rightCardGoup=new CardGroup,this._rightCardGoup.x=676,this._rightCardGoup.y=40,this.addChild(this._rightCardGoup),this._leftCardGoup=new CardGroup,this._leftCardGoup.x=216,this._leftCardGoup.y=40,this.addChild(this._leftCardGoup),this._rightPlayerView=new PlayerBaseInfoView,this.addChild(this._rightPlayerView),this._rightPlayerView.x=966,this._rightPlayerView.y=20,this._vsImg=new egret.Bitmap,this._vsImg.texture=RES.getRes("game_json.vs"),this.addChild(this._vsImg),this._vsImg.x=485,this._vsImg.y=49,this.touchEnabled=!0,this.y=168},e}(egret.Sprite);__reflect(BiPaiView.prototype,"BiPaiView");var BuyFangkaView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("buyBg_png"),this.addChild(this._bg),this._wxTF=new egret.TextField,this._wxTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._wxTF.textColor=9063179,this._wxTF.size=25,this._wxTF.bold=!0,this._wxTF.textAlign=egret.HorizontalAlign.LEFT,this._wxTF.x=263,this._wxTF.y=180,this.addChild(this._wxTF),this._wxTF2=new egret.TextField,this._wxTF2.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._wxTF2.textColor=9063179,this._wxTF2.size=25,this._wxTF2.bold=!0,this._wxTF2.textAlign=egret.HorizontalAlign.LEFT,this._wxTF2.x=263,this._wxTF2.y=235,this.addChild(this._wxTF2),this._closeBtn=new DButton("ui_json.closeBtn"),this.addChild(this._closeBtn),this._closeBtn.x=467,this._closeBtn.y=50,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.iframeWidth=this.width,this.iframeHeight=this.height;var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,t.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1},e.prototype.onTouchTap=function(t){GameGlobal.iframeLayer.hideIFrame(e)},e}(IFrameBase);__reflect(BuyFangkaView.prototype,"BuyFangkaView");var CardGroup=function(t){function e(){var e=t.call(this)||this;return e._isMySelf=!0,e._cardViews=[],e.initView(),e}return __extends(e,t),Object.defineProperty(e.prototype,"isMySelf",{set:function(t){this._isMySelf=t},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t=this._cardViews.length,e=0;t>e;e++){var i=this._cardViews[e];i.showValue(!1),i.data=null}},e.prototype.setPokerSize=function(t,e){void 0===e&&(e=22);for(var i=this._cardViews.length,n=0;i>n;n++){var a=this._cardViews[n];a.x=n*e}},e.prototype.setPokerData=function(t){for(var e=t.length,i=[],n=0;e>n;n++){var a=new Card(t[n].cardValue,t[n].cardSuit);i.push(a)}for(var e=i.length,n=0;e>n;n++){var s=this._cardViews[n];s.data=i[n]}},e.prototype.showPokerValue=function(t,e){void 0===e&&(e=!1);for(var i=this._cardViews.length,n=0;i>n;n++){var a=this._cardViews[n];a.showValue(t,e),this._isMySelf}},e.prototype.initView=function(){this.resetCards()},e.prototype.resetCards=function(){for(;this.numChildren>0;)this.removeChildAt(0);this._cardViews=[];for(var t,e=3,i=0;e>i;i++)t=new CardView,t.x=22*i,t.scaleX=t.scaleY=1.6,this.addChild(t),this._cardViews.push(t)},e}(egret.Sprite);__reflect(CardGroup.prototype,"CardGroup");var CardView=function(t){function e(){var e=t.call(this)||this;return e._view=new egret.Bitmap,e._view.texture=RES.getRes("game_json.cardBg"),e.addChild(e._view),e._view.anchorOffsetX=.5*e._view.width,e._view.anchorOffsetY=.5*e._view.height,e._view.x=.5*e._view.width,e._view.y=.5*e._view.height,e.touchEnabled=!0,e}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),e.prototype.showValue=function(t,e){var i=this;void 0===e&&(e=!1),null!=this._data&&(egret.Tween.removeTweens(this._view),t?e?(this._view.scaleX=-1,egret.Tween.get(this._view).to({scaleX:1},500).call(function(){i._view.texture=RES.getRes("poker_json.card"+i._data.getNum()+"_"+i._data.getColor())},this)):this._view.texture=RES.getRes("poker_json.card"+this._data.getNum()+"_"+this._data.getColor()):this._view.texture=RES.getRes("game_json.cardBg"))},e}(egret.Sprite);__reflect(CardView.prototype,"CardView");var ChatPaopao=function(t){function e(e){void 0===e&&(e=0);var i=t.call(this)||this;return i._direction=0,i._direction=e,i.initView(),i}return __extends(e,t),e.prototype.show=function(t,e){if(void 0===e&&(e=1),this._contentTF.text=t,3==e){var i=ChatView.WORDS.indexOf(t);0==MyUserInfo.getInstance().gender?SoundManager.instance.playSound("word-"+i+"_mp3"):SoundManager.instance.playSound("word-"+i+"2_mp3")}},e.prototype.initView=function(){this._bg=new egret.Bitmap,this.addChild(this._bg),this._bg.width=104,this._bg.height=46,this._contentTF=new egret.TextField,this._contentTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._contentTF.size=10,this._contentTF.textColor=16777215,this._contentTF.textAlign=egret.HorizontalAlign.LEFT,this._contentTF.multiline=!0,this._contentTF.wordWrap=!0,this._contentTF.width=94,this._contentTF.height=34,this._contentTF.border=!0,this._contentTF.text="",this._contentTF.x=7,this._contentTF.y=7,this.addChild(this._contentTF),this._contentTF.lineSpacing=5,0==this._direction?(this._bg.texture=RES.getRes("game_json.paopaoBg"),this._contentTF.x=7,this._contentTF.y=7):(this._bg.texture=RES.getRes("game_json.paopaoBg2"),this._contentTF.x=7,this._contentTF.y=7)},e}(egret.Sprite);__reflect(ChatPaopao.prototype,"ChatPaopao");var ChatView=function(t){function e(){var e=t.call(this)||this;return e._textConfig=[["chat_kjBtn",1],["chat_zsBtn",2],["chat_wnBtn",3],["chat_syBtn",4],["chat_ccBtn",5],["chat_hhBtn",6],["chat_dyBtn",7],["chat_jjBtn",8],["chat_zjBtn",9],["chat_tkBtn",10]],e._currentTab=-1,e.initView(),e}return __extends(e,t),e.getInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.show=function(){GameGlobal.stage.addChild(this),this.showTab(1)},e.prototype.onTouchStage=function(t){},e.prototype.hide=function(){this._inputTF.text="",GameGlobal.stage.contains(this)&&GameGlobal.stage.removeChild(this)},e.prototype.showTab=function(t){this._currentTab!=t&&(this._currentTab=t,1==this._currentTab?(this._textContainer.visible=!0,this._emotionContainer.visible=!1,this._tabText.texture=RES.getRes("game_json.fayan-text"),this._tabText2.texture=RES.getRes("game_json.biaoqing-text2"),this._tab.texture=RES.getRes("game_json.chat_tabBg"),this._tab2.texture=RES.getRes("game_json.chat_tabBg2_over"),this._inputBg.visible=this._submitBtn.visible=!0,this._inputTF.visible=!0):(this._textContainer.visible=!1,this._emotionContainer.visible=!0,this._tabText.texture=RES.getRes("game_json.fayan-text2"),this._tabText2.texture=RES.getRes("game_json.biaoqing-text"),this._tab.texture=RES.getRes("game_json.chat_tabBg_over"),this._tab2.texture=RES.getRes("game_json.chat_tabBg2"),this._inputBg.visible=this._submitBtn.visible=!1,this._inputTF.visible=!1))},e.prototype.onTouchTap=function(t){if(t.currentTarget==this._tab)this.showTab(1);else if(t.currentTarget==this._tab2)this.showTab(2);else if(t.currentTarget==this._submitBtn){var e=this._inputTF.text.trim();if(""==e)return void AlertView.getInstance().show("请输入聊天内容！",AlertView.ALERT_MODE);var i={};i.msgType=NetAction.chatMsg,i.msg={chatType:1,chatMsg:e},SocketCommand.getInstance().send(i),this.hide()}},e.prototype.initView=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("chatBg_png"),this.addChild(this._bg),this._tab=new egret.Bitmap,this._tab.texture=RES.getRes("game_json.chat_tabBg"),this.addChild(this._tab),this._tab2=new egret.Bitmap,this._tab2.texture=RES.getRes("game_json.chat_tabBg2"),this.addChild(this._tab2),this._tab.touchEnabled=this._tab2.touchEnabled=!0,this._tab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._tab2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._tabText=new egret.Bitmap,this._tabText.texture=RES.getRes("game_json.fayan-text"),this.addChild(this._tabText),this._tabText2=new egret.Bitmap,this._tabText2.texture=RES.getRes("game_json.biaoqing-text"),this.addChild(this._tabText2),this._inputBg=new egret.Bitmap,this._inputBg.texture=RES.getRes("game_json.inputBg2"),this.addChild(this._inputBg),this._inputTF=new egret.TextField,this._inputTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._inputTF.type=egret.TextFieldType.INPUT,this._inputTF.textColor=7553297,this._inputTF.size=20,this._inputTF.textAlign=egret.HorizontalAlign.LEFT,this._inputTF.width=306,this.addChild(this._inputTF),this._inputTF.x=30,this._inputTF.y=300,this._submitBtn=new DButton("game_json.sendBtn"),this.addChild(this._submitBtn),this._textContainer=new egret.DisplayObjectContainer,this.addChild(this._textContainer),this._textContainer.x=20,this._textContainer.y=82,this._emotionContainer=new egret.DisplayObjectContainer,this.addChild(this._emotionContainer),this._emotionContainer.x=35,this._emotionContainer.y=81,this._tab.x=16,this._tab.y=30,this._tab2.x=233,this._tab2.y=30,this._tabText.x=87,this._tabText.y=40,this._tabText2.x=318,this._tabText2.y=42,this._inputBg.x=23,this._inputBg.y=292,this._submitBtn.x=346,this._submitBtn.y=293;
for(var t=e.WORDS.length,i=0;t>i;i++){var n=new QuickChatItem;n.setData(e.WORDS[i]),n.y=42*i,this._textContainer.addChild(n),n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchText,this)}t=e.emotionConfig.length;for(var i=0;t>i;i++){var a=new DButton("emotion_json."+e.emotionConfig[i][0]);this._emotionContainer.addChild(a),a.x=84*(i%5),a.y=88*Math.floor(i/5),a.id=e.emotionConfig[i][0],a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchEmotion,this)}this._emotionContainer.visible=!1,this._submitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onTouchText=function(t){var e=t.currentTarget,i=e.getData(),n={};n.msgType=NetAction.chatMsg,n.msg={chatType:3,chatMsg:i},SocketCommand.getInstance().send(n),this.hide()},e.prototype.onTouchEmotion=function(t){var e=t.currentTarget,i=e.id,n={};n.msgType=NetAction.chatMsg,n.msg={chatType:2,chatMsg:i},SocketCommand.getInstance().send(n),this.hide()},e._instance=null,e.WORDS=["别看牌，俺们闷到底","不要偷鸡，俺的牌很大","青山不改，绿水长流，后会有期","不要走，决战到天亮","冲动是魔鬼，冷静"],e.emotionConfig=[["bq1",1],["bq2",2],["bq3",3],["bq4",4],["bq5",5],["bq6",6],["bq7",7],["bq8",8],["bq9",9],["bq10",10],["bq11",11],["bq12",12],["bq13",13],["bq14",14],["b115",15]],e}(egret.Sprite);__reflect(ChatView.prototype,"ChatView");var QuickChatItem=function(t){function e(){var e=t.call(this)||this;return e._data="",e.initView(),e}return __extends(e,t),e.prototype.setData=function(t){this._data=t,this._contentTF.text=t},e.prototype.getData=function(){return this._data},e.prototype.initView=function(){var t=new egret.Bitmap;t.texture=RES.getRes("chatItemBg_png"),this.addChild(t),this._contentTF=new egret.TextField,this._contentTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._contentTF.textColor=7553297,this._contentTF.size=22,this._contentTF.bold=!0,this._contentTF.textAlign=egret.HorizontalAlign.CENTER,this._contentTF.width=t.width,this._contentTF.height=t.height,this._contentTF.x=2,this._contentTF.y=6,this.addChild(this._contentTF)},e}(egret.Sprite);__reflect(QuickChatItem.prototype,"QuickChatItem");var ChipView=function(t){function e(){var e=t.call(this)||this;return e._chipImg=new egret.Bitmap,e._chipImg.texture=RES.getRes("game_json.chip2"),e.addChild(e._chipImg),e._chipImg.anchorOffsetX=.5*e._chipImg.width,e._chipImg.anchorOffsetY=.5*e._chipImg.height,e._chipImg.x=.5*e._chipImg.width,e._chipImg.y=.5*e._chipImg.height,e}return __extends(e,t),e.prototype.setValue=function(t){this._chipImg.texture=RES.getRes("game_json.chip"+t)},e}(egret.Sprite);__reflect(ChipView.prototype,"ChipView");var CountDownView=function(t){function e(){var e=t.call(this)||this;return e._leftTime=10,e.initView(),e}return __extends(e,t),e.prototype.start=function(t){void 0===t&&(t=10),this._leftTime=t,this._tf.text=this._leftTime.toString(),this._timer.stop(),this._timer.reset(),this._timer.start(),this.visible=!0},e.prototype.stop=function(){this._timer.stop(),this._timer.reset(),this._timer.start(),this.visible=!1},e.prototype.initView=function(){this._icon=new egret.Bitmap,this._icon.texture=RES.getRes("game_json.bull_clock"),this.addChild(this._icon),this._tf=new egret.TextField,this._tf.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._tf.size=28,this._tf.textColor=16777215,this._tf.textAlign=egret.HorizontalAlign.CENTER,this._tf.width=this._icon.width,this.addChild(this._tf),this._tf.x=3,this._tf.y=16,this._tf.text="0",this.visible=!1,this._timer=new egret.Timer(1e3),this._timer.addEventListener(egret.TimerEvent.TIMER,this.onTimerHandle,this)},e.prototype.onTimerHandle=function(t){this._leftTime--,this._tf.text=this._leftTime.toString(),this._leftTime<=0&&this.stop()},e}(egret.Sprite);__reflect(CountDownView.prototype,"CountDownView");var CreateRoomView=function(t){function e(){var e=t.call(this)||this;return e._totalGames=8,e.init(),e}return __extends(e,t),e.prototype.show=function(){this._ownFangkaTF.text="剩余房卡："+MyUserInfo.getInstance().gold.toString()+"张"},e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this.addChild(this._bg),this._bg.texture=RES.getRes("createRoomBg_png");var t=new egret.TextField;t.fontFamily=GameGlobal.DEFAULT_FONT_NAME,t.textColor=9063179,t.size=29,t.bold=!0,t.textAlign=egret.HorizontalAlign.LEFT,t.x=72,t.y=165,t.text="选择模式",this.addChild(t),this._tenRoundChkBox=new DCheckBox,this._tenRoundChkBox.setSkin("ui_json.checkbox-icon","ui_json.checkbox-icon2"),this.addChild(this._tenRoundChkBox),this._tenRoundChkBox.setLabel("8局",!1,35,-1),this._tenRoundChkBox.x=231,this._tenRoundChkBox.y=176,this._tenRoundChkBox.selected=!0,this._twentyRoundChkBox=new DCheckBox,this._twentyRoundChkBox.setSkin("ui_json.checkbox-icon","ui_json.checkbox-icon2"),this.addChild(this._twentyRoundChkBox),this._twentyRoundChkBox.setLabel("16局",!1,35,-1),this._twentyRoundChkBox.x=392,this._twentyRoundChkBox.y=176,this._twentyRoundChkBox.selected=!1,this._aaPayChkBox=new DCheckBox,this._aaPayChkBox.setSkin("ui_json.checkbox-icon","ui_json.checkbox-icon2"),this.addChild(this._aaPayChkBox),this._aaPayChkBox.setLabel("AA支付",!1,35,-1),this._aaPayChkBox.x=231,this._aaPayChkBox.y=268,this._aaPayChkBox.selected=!0,this._hostPayChkBox=new DCheckBox,this._hostPayChkBox.setSkin("ui_json.checkbox-icon","ui_json.checkbox-icon2"),this.addChild(this._hostPayChkBox),this._hostPayChkBox.setLabel("房主支付",!1,35,-1),this._hostPayChkBox.x=392,this._hostPayChkBox.y=268,this._hostPayChkBox.selected=!1;var e=new egret.TextField;e.fontFamily=GameGlobal.DEFAULT_FONT_NAME,e.textColor=9063179,e.size=29,e.bold=!0,e.textAlign=egret.HorizontalAlign.LEFT,e.x=72,e.y=262,e.text="支付方式",this.addChild(e),this._needFangkaTF=new egret.TextField,this._needFangkaTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._needFangkaTF.textColor=9063179,this._needFangkaTF.size=25,this._needFangkaTF.bold=!0,this._needFangkaTF.textAlign=egret.HorizontalAlign.LEFT,this._needFangkaTF.x=131,this._needFangkaTF.y=346,this.addChild(this._needFangkaTF),this._needFangkaTF.text="所需房卡：1张",this._ownFangkaTF=new egret.TextField,this._ownFangkaTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._ownFangkaTF.textColor=9063179,this._ownFangkaTF.size=25,this._ownFangkaTF.bold=!0,this._ownFangkaTF.textAlign=egret.HorizontalAlign.LEFT,this._ownFangkaTF.x=497,this._ownFangkaTF.y=346,this.addChild(this._ownFangkaTF),this._ownFangkaTF.text="剩余房卡：1张",this._tipTF=new egret.TextField,this._tipTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._tipTF.textColor=16711680,this._tipTF.size=20,this._tipTF.textAlign=egret.HorizontalAlign.LEFT,this._tipTF.y=407,this.addChild(this._tipTF),this._tipTF.text="注：房卡在开始游戏后第一局牌局结束后扣除，提前解散不扣除房卡。",this._tipTF.x=this.width-this._tipTF.textWidth>>1,this._createBtn=new DButton("ui_json.createRoomBtn2"),this.addChild(this._createBtn),this._createBtn.x=261,this._createBtn.y=442,this._closeBtn=new DButton("ui_json.closeBtn"),this._closeBtn.x=787,this._closeBtn.y=37,this.addChild(this._closeBtn),this.iframeWidth=this.width,this.iframeHeight=this.height;var i=new egret.Shape;i.graphics.beginFill(0,.5),i.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),i.graphics.endFill(),this.addChildAt(i,0),i.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,i.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._createBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._tenRoundChkBox.addEventListener(GameEventManager.SELECTED,this.onSelected,this),this._twentyRoundChkBox.addEventListener(GameEventManager.SELECTED,this.onSelected,this),this._aaPayChkBox.addEventListener(GameEventManager.SELECTED,this.onSelected,this),this._hostPayChkBox.addEventListener(GameEventManager.SELECTED,this.onSelected,this)},e.prototype.onSelected=function(t){var e;t.currentTarget==this._aaPayChkBox?(this._hostPayChkBox.selected=!1,this._aaPayChkBox.selected=!0,e=Math.floor(this._totalGames/8),this._needFangkaTF.text="所需房卡："+e+"张"):t.currentTarget==this._hostPayChkBox?(this._hostPayChkBox.selected=!0,this._aaPayChkBox.selected=!1,e=4,16==this._totalGames&&(e=7),this._needFangkaTF.text="所需房卡："+e+"张"):t.currentTarget==this._tenRoundChkBox?(this._totalGames=8,this._twentyRoundChkBox.selected=!1,this._tenRoundChkBox.selected=!0,this._aaPayChkBox.selected?(e=Math.floor(this._totalGames/8),this._needFangkaTF.text="所需房卡："+e+"张"):(e=4,this._needFangkaTF.text="所需房卡："+e+"张")):t.currentTarget==this._twentyRoundChkBox&&(this._totalGames=16,this._tenRoundChkBox.selected=!1,this._twentyRoundChkBox.selected=!0,this._aaPayChkBox.selected?(e=Math.floor(this._totalGames/8),this._needFangkaTF.text="所需房卡："+e+"张"):(e=7,this._needFangkaTF.text="所需房卡："+e+"张"))},e.prototype.onTouchTap=function(t){if(t.currentTarget==this._closeBtn)GameGlobal.iframeLayer.hideIFrame(e);else if(t.currentTarget==this._createBtn){var i=this._aaPayChkBox.selected?2:1,n={};n.msgType=NetAction.createRoom,n.gameType=GameGlobal.GAME_TYPE,n.msg={payType:i,playerId:MyUserInfo.getInstance().userId,totalGames:this._totalGames,playerNumLimit:GameGlobal.playerNumLimit},SocketCommand.getInstance().send(n)}},e}(IFrameBase);__reflect(CreateRoomView.prototype,"CreateRoomView");var FeedBackView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.show=function(){this._titleTF.text="请输入您的联系方式",this._contentTF.text="请输入内容"},e.prototype.showComplete=function(){var t=this;this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("feedbackBg_png"),this.addChild(this._bg),this._closeBtn=new DButton("ui_json.closeBtn"),this.addChild(this._closeBtn),this._closeBtn.x=787,this._closeBtn.y=37,this._adviceCheckbox=new DCheckBox,this._adviceCheckbox.setSkin("ui_json.checkbox-icon","ui_json.checkbox-icon2"),this.addChild(this._adviceCheckbox),this._adviceCheckbox.x=69,this._adviceCheckbox.y=157,this._adviceCheckbox.setLabel("ui_json.tousujianyi-text",!0,35,-3),this._feedbackCheckbox=new DCheckBox,this._feedbackCheckbox.setSkin("ui_json.checkbox-icon","ui_json.checkbox-icon2"),this.addChild(this._feedbackCheckbox),this._feedbackCheckbox.x=231,this._feedbackCheckbox.y=157,this._feedbackCheckbox.setLabel("ui_json.wentifankui-text",!0,35,-3),this._feedbackCheckbox.selected=!1,this._titleTF=new egret.TextField,this._titleTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._titleTF.type=egret.TextFieldType.INPUT,this._titleTF.textColor=16777215,this._titleTF.size=25,this._titleTF.textAlign=egret.HorizontalAlign.LEFT,this._titleTF.x=437,this._titleTF.y=154,this.addChild(this._titleTF),this._titleTF.width=306,this._titleTF.text="请输入您的联系方式",this._contentTF=new egret.TextField,this._contentTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._contentTF.textColor=16777215,this._contentTF.size=25,this._contentTF.textAlign=egret.HorizontalAlign.LEFT,this._contentTF.x=101,this._contentTF.y=221,this._contentTF.multiline=!0,this._contentTF.wordWrap=!0,this._contentTF.width=644,this._contentTF.height=156,this.addChild(this._contentTF),this._contentTF.text="请输入内容",this._contentTF.type=egret.TextFieldType.INPUT,this._titleTF.addEventListener(egret.TouchEvent.FOCUS_IN,function(){"请输入您的联系方式"==t._titleTF.text&&(t._titleTF.text="")},this),this._titleTF.addEventListener(egret.TouchEvent.FOCUS_OUT,function(){""==t._titleTF.text&&(t._titleTF.text="请输入您的联系方式")},this),this._contentTF.addEventListener(egret.TouchEvent.FOCUS_IN,function(){"请输入内容"==t._contentTF.text&&(t._contentTF.text="")},this),this._contentTF.addEventListener(egret.TouchEvent.FOCUS_OUT,function(){""==t._contentTF.text&&(t._contentTF.text="请输入内容")},this),this._confirmBtn=new DButton("ui_json.confirmSubmitBtn"),this.addChild(this._confirmBtn),this._confirmBtn.x=261,this._confirmBtn.y=426,this.iframeWidth=this.width,this.iframeHeight=this.height;var e=new egret.Shape;e.graphics.beginFill(0,.5),e.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),e.graphics.endFill(),this.addChildAt(e,0),e.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,e.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._confirmBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._feedbackCheckbox.addEventListener(GameEventManager.SELECTED,this.onSelectFeedback,this),this._adviceCheckbox.addEventListener(GameEventManager.SELECTED,this.onSelectAdvice,this)},e.prototype.onSelectFeedback=function(t){this._feedbackCheckbox.selected?this._adviceCheckbox.selected=!1:this._adviceCheckbox.selected=!0},e.prototype.onSelectAdvice=function(t){this._adviceCheckbox.selected?this._feedbackCheckbox.selected=!1:this._feedbackCheckbox.selected=!0},e.prototype.onTouchTap=function(t){if(t.currentTarget==this._closeBtn)GameGlobal.iframeLayer.hideIFrame(e);else if(t.currentTarget==this._confirmBtn){var i=1;this._feedbackCheckbox.selected&&(i=2),GameEventManager.addEvent(NetAction.feedback.toString(),this.onFeedbackResponse,this);var n={};n.msgType=NetAction.feedback,n.gameType=0,n.msg={mobilePhone:this._titleTF.text.trim(),feedBackType:i,feedBack:this._contentTF.text.trim()},SocketCommand.getInstance().send(n)}},e.prototype.onFeedbackResponse=function(t){GameEventManager.removeEvent(NetAction.feedback.toString(),this.onFeedbackResponse,this);var i=t.data;i.data;AlertView.getInstance().show("提交成功，感谢您的反馈！"),GameGlobal.iframeLayer.hideIFrame(e)},e}(IFrameBase);__reflect(FeedBackView.prototype,"FeedBackView");var GameResult=function(t){function e(){var e=t.call(this)||this;return e._showJiesuan=!1,e.init(),e}return __extends(e,t),e.prototype.updateBtn=function(t){1==t?this._showJiesuan=!0:this._showJiesuan=!1},e.prototype.setData=function(t){this._data=t;var e=t.curWinnerId;e==MyUserInfo.getInstance().userId?(this._resultImg.texture=RES.getRes("game_json.winText"),SoundManager.instance.playSound("win_mp3")):(this._resultImg.texture=RES.getRes("game_json.failText"),SoundManager.instance.playSound("fail_mp3"));for(var i=t.playerList,n=0;n<i.length;n++){var a=i[n];if(a.playerId==MyUserInfo.getInstance().userId){var s=a.cardList;null!=s&&3==s.length}}for(;this._listContainer.numChildren>0;)this._listContainer.removeChildAt(0);for(var o,r=i.length,h=0,n=0;r>n;n++){var a=i[n];0!=a.status&&(o=new PlayerResultTile,o.setData(a),this._listContainer.addChild(o),o.y=40*h,h++)}},e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this.addChild(this._bg),this._bg.texture=RES.getRes("jiesuanBg_png"),this._resultImg=new egret.Bitmap,this._resultImg.texture=RES.getRes("game_json.winText"),this.addChild(this._resultImg),this._resultImg.x=173,this._resultImg.y=-23;var t=new egret.TextField;t.fontFamily=GameGlobal.DEFAULT_FONT_NAME,t.textColor=15644463,t.size=25,t.bold=!0,t.textAlign=egret.HorizontalAlign.LEFT,t.x=38,t.y=80,t.text="玩家信息",this.addChild(t);var e=new egret.TextField;e.fontFamily=GameGlobal.DEFAULT_FONT_NAME,e.textColor=15644463,e.size=25,e.bold=!0,e.textAlign=egret.HorizontalAlign.LEFT,e.x=280,e.y=80,e.text="总成绩",this.addChild(e);var i=new egret.TextField;i.fontFamily=GameGlobal.DEFAULT_FONT_NAME,i.textColor=15644463,i.size=25,i.bold=!0,i.textAlign=egret.HorizontalAlign.LEFT,i.x=487,i.y=80,i.text="牌型",this.addChild(i),this._listContainer=new egret.DisplayObjectContainer,this.addChild(this._listContainer),this._listContainer.x=43,this._listContainer.y=153,this._closeBtn=new DButton("game_json.closeBtn3"),this.addChild(this._closeBtn),this._closeBtn.x=522,this._closeBtn.y=-18,this.iframeWidth=this.width,this.iframeHeight=this.height;var n=new egret.Shape;n.graphics.beginFill(0,.5),n.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),n.graphics.endFill(),this.addChildAt(n,0),n.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,n.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onTouchTap=function(t){if(this._showJiesuan){GameGlobal.iframeLayer.showIFrame(JieSuanView),GameGlobal.iframeLayer.hideIFrame(e);var i=GameGlobal.iframeLayer.getIFrame(JieSuanView);i.setData(this._data)}else GameEventManager.dispatchEvent(GameEventManager.NEXT_ROUND)},e}(IFrameBase);__reflect(GameResult.prototype,"GameResult");var PlayerResultTile=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.setData=function(t){this._data=t,this._winTF.text=t.curScore;var e=GameGlobal.mapLayer.getBattle().getPlayerInfoById(t.playerId);if(null!=e){var i=e.nickName;i.length>10&&(i=i.substr(0,10)+"..."),this._nickNameTF.text=i;var n=e.headImgUrl;null!=n&&this.loadFace(n)}var a=t.cardList;null!=a&&3==a.length&&(this._cardGroup.setPokerData(a),this._cardGroup.showPokerValue(!0))},e.prototype.loadFace=function(t){var e=new egret.ImageLoader;e.addEventListener(egret.Event.COMPLETE,this.imageComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFaceError,this),e.load(t)},e.prototype.onLoadFaceError=function(t){console.log("load face ioerror")},e.prototype.imageComplete=function(t){console.log("load face complete"),this._faceImg.texture=t.target.data,this._faceImg.width=34,this._faceImg.height=35},e.prototype.initView=function(){this._faceImg=new egret.Bitmap,this.addChild(this._faceImg),this._nickNameTF=new egret.TextField,this._nickNameTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._nickNameTF.textColor=16777215,this._nickNameTF.size=20,this._nickNameTF.bold=!0,this._nickNameTF.textAlign=egret.HorizontalAlign.LEFT,this._nickNameTF.x=51,this._nickNameTF.y=5,this._nickNameTF.text="--",this.addChild(this._nickNameTF),this._cardGroup=new CardGroup,this._cardGroup.x=408,this._cardGroup.y=-18,this.addChild(this._cardGroup),this._cardGroup.isMySelf=!1,this._cardGroup.setPokerSize(.61,25);var t=new egret.Bitmap;this.addChild(t),t.texture=RES.getRes("game_json.chipDefault"),t.x=242,t.y=4,this._winTF=new egret.TextField,this._winTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._winTF.textColor=16777215,this._winTF.size=25,this._winTF.bold=!0,this._winTF.textAlign=egret.HorizontalAlign.LEFT,this._winTF.x=285,this._winTF.y=2,this._winTF.text="--",this.addChild(this._winTF)},e}(egret.Sprite);__reflect(PlayerResultTile.prototype,"PlayerResultTile");var GameSettingView=function(t){function e(){var e=t.call(this)||this;return e._buttons=[],e._buttonNames=["setBtn2","helpBtn","quitBtn2"],e.initView(),e}return __extends(e,t),e.prototype.initView=function(){for(var t,e=this._buttonNames.length,i=0;e>i;i++)t=new DButton("game_json."+this._buttonNames[i]),this.addChild(t),t.y=69*i,t.name=this._buttonNames[i],t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onTouchTap=function(t){var e=t.currentTarget.name;"setBtn2"==e?GameGlobal.iframeLayer.showIFrame(SettingView):"helpBtn"==e?GameGlobal.iframeLayer.showIFrame(RuleView):(AlertView.getInstance().setConfirmCallBack(this.quitConfirm,this),AlertView.getInstance().show("是否确定解散房间？",AlertView.CONFIRM_MODE))},e.prototype.quitConfirm=function(){var t={};t.msgType=NetAction.dissolveRoom,t.token=GameModel.instance().token,t.gameType=GameGlobal.GAME_TYPE,t.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(t)},e}(egret.Sprite);__reflect(GameSettingView.prototype,"GameSettingView");var GameView=function(t){function e(){var e=t.call(this)||this;return e._otherPlayerViews=[],e._playerDataHash=new HashMap,e._roomInfo=null,e._isRecording=!1,e._lastStakeScore=1,e._lastPlayerId="",e._currentPlayerId="",e._fapaiTimerId=-1,e._isShowChat=!1,e._isTweening=!1,e._isShowOption=!1,e.initView(),e}return __extends(e,t),e.prototype.getPlayerInfoById=function(t){return this._playerDataHash.get(t)},e.prototype.init=function(t){if(void 0===t&&(t=null),this.dispose(),this._roomInfo=t,null==this._roomInfo)throw new Error("battle data is null!!!");GameModel.instance().roomId=this._roomInfo.roomId;var i=this._roomInfo.roomOwnerId,n=this._roomInfo.roomBankerId,a=this._roomInfo.stakeButtom,s=-1;this._roomInfo.hasOwnProperty("status")&&(s=this._roomInfo.status),this._betInfoView.init(this._roomInfo.roomId,this._roomInfo.totalGames),this._roomInfo.hasOwnProperty("curGame")&&this._betInfoView.updateRound(this._roomInfo.curGame,this._roomInfo.totalGames),this._playerDataHash=new HashMap;for(var o=this._roomInfo.playerList,r=o.length,h=1,l=PlayerView.NOT_READY,c=[],d=0;r>d;d++){var _=o[d],g=_.playerId;if(this._playerDataHash.put(g,_),g==MyUserInfo.getInstance().userId){if(this._myPlayerView.setData(_),this._myPlayerView.updateScore(_.totalScore),h=_.order,l=_.status,this._readyBtn.visible=this._readyFlag.visible=!1,this._myPlayerView.updateStatus(l),l==PlayerView.READYED?this._readyBtn.visible=!1:l==PlayerView.NOT_READY?(this._readyBtn.visible=!0,this._readyFlag.visible=!1):l==PlayerView.WATCHER?(this._myPlayerView.canLook=!1,this._myPlayerView.lookPoker([],!1)):l==PlayerView.LOOKED?(this._myPlayerView.lookPoker(_.cardList,!1),this._myPlayerView.canLook=!1,this._1fenBtn.setSkin("game_json.4fenBtn","game_json.4fenBtn2"),this._1fenBtn.value=4,this._2fenBtn.setSkin("game_json.10fenBtn","game_json.10fenBtn2"),this._2fenBtn.value=10,this._3fenBtn.setSkin("game_json.20fenBtn","game_json.20fenBtn2"),this._3fenBtn.value=20):(this._myPlayerView.canLook=!0,this._myPlayerView.lookPoker([],!1)),_.hasOwnProperty("onlineStatus")&&null!=_.onlineStatus&&this._myPlayerView.setOffline(1!=_.onlineStatus),s==e.GAMEING){0!=l&&this.betChip(MyUserInfo.getInstance().userId,a);var u=_.stakeScoreList;if(null!=u&&u.length>0)for(var p=u.length,m=0;p>m;m++)this.betChip(MyUserInfo.getInstance().userId,u[m])}}else c.push(o[d])}GameModel.instance().myOrder=h,this._otherPlayerViews=[],r=c.length;for(var f,d=0;r>d;d++){f=new OtherPlayerView;var T=c[d],y=T.order,v=T.status,E=GameUtils.sitId2LR2(h,y);if(f.x=GameUtils.PLAYER_POS_ARR[E][0],f.y=GameUtils.PLAYER_POS_ARR[E][1],1==E||11==E?f.y=GameGlobal.stageH-217:(2==E||10==E)&&(f.y=GameGlobal.stageH-250),f.setPosition(E),f.setData(T),this.addChild(f),f.updateScore(T.totalScore),this._otherPlayerViews.push(f),f.updateStatus(T.status),4==T.status?f.lookPoker(T.cardList,!1):f.lookPoker([],!1),T.hasOwnProperty("onlineStatus")&&null!=T.onlineStatus&&f.setOffline(1!=T.onlineStatus),s==e.GAMEING){GameGlobal.iframeLayer.hideIFrame(GameResult),0!=v&&this.betChip(T.playerId,a);var u=T.stakeScoreList;if(null!=u&&u.length>0){this._lastPlayerId=T.playerId;for(var p=u.length,m=0;p>m;m++)this.betChip(T.playerId,u[m])}SoundManager.instance.playSound("send-chip_mp3")}}if(this.addChild(this._emotionContainer),i==MyUserInfo.getInstance().userId?this._myPlayerView.isFang=!0:(f=this.getPlayerView(i),f.isFang=!0),null!=n&&""!=n&&(n==MyUserInfo.getInstance().userId?this._myPlayerView.isZhuang=!0:(f=this.getPlayerView(n),f.isZhuang=!0)),s==e.ROUND_END){this._inviteBtn.visible=!1,GameGlobal.iframeLayer.showIFrame(GameResult);var F=GameGlobal.iframeLayer.getIFrame(GameResult);F.setData(this._roomInfo),F.updateBtn(0)}else if(s==e.GAME_END){this._inviteBtn.visible=!1,GameGlobal.iframeLayer.showIFrame(GameResult);var F=GameGlobal.iframeLayer.getIFrame(GameResult);F.setData(this._roomInfo),F.updateBtn(1)}else if(s==e.GAMEING&&(this._inviteBtn.visible=!1,this._roomInfo.hasOwnProperty("curPlayerId"))){var w=this._roomInfo.curPlayerId;this.updatePlayerTurn(w)}var C=GameGlobal.inviteDesc;C=C.replace("{0}",GameGlobal.playerNumLimit.toString()),C=C.replace("{1}",this._roomInfo.roomId),C=C.replace("{2}",this._roomInfo.totalGames),C=C.replace("{3}",this._roomInfo.stakeLimit),GameGlobal.jssdk.setTitle("好友约你扎金花（房间号："+this._roomInfo.roomId+"）",C),SoundManager.instance.playMusic("table_mp3")},e.prototype.clearTable=function(){egret.clearTimeout(this._fapaiTimerId),this._giveUpBtn.setEnabled(!1),this._compareBtn.setEnabled(!1),this._1fenBtn.setEnabled(!1),this._2fenBtn.setEnabled(!1),this._3fenBtn.setEnabled(!1),this._cancelCompareBtn.visible=!1,this._compareBtn.visible=!0,this._inviteBtn.visible=!0,this._readyFlag.visible=!1,this._readyBtn.visible=!0,this._myPlayerView.showMyTurn(!1);for(var t=this._otherPlayerViews.length,e=0;t>e;e++){var i=this._otherPlayerViews[e];i.reset(),i.visible=!1,i.stage&&this.removeChild(i)}for(this._otherPlayerViews=[],this._playerDataHash=new HashMap,this._myPlayerView.reset(),this._myPlayerView.visible=!0,this._lastPlayerId="",this._currentPlayerId="",this._isShowOption&&this.showOrHideOptionView();this._chipContainer.numChildren>0;)this._chipContainer.removeChildAt(0);for(;this._emotionContainer.numChildren>0;){var n=this._emotionContainer.removeChildAt(0);n instanceof egret.Bitmap&&egret.Tween.removeTweens(n)}},e.prototype.dispose=function(){this.clearTable(),this._isShowChat=!1,ChatView.getInstance().hide(),GameModel.instance().roomId=0},e.prototype.initView=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("bg4_jpg"),this._bg.width=GameGlobal.stageW,this._bg.height=GameGlobal.stageH,this.addChild(this._bg),this._bg2=new egret.Bitmap,this._bg2.texture=RES.getRes("bg5_png"),this.addChild(this._bg2),this._bg2.y=GameGlobal.stageH-556,this._bg2.x=72,this._betInfoView=new BetInfoView,this.addChild(this._betInfoView),this._betInfoView.x=177,this._betInfoView.y=15,this._optionBtn=new DButton("game_json.optionBtn2"),this._optionBtn.x=13,this._optionBtn.y=7,this.addChild(this._optionBtn),this._yuyinBtn=new DButton("game_json.yuyinBtn"),this.addChild(this._yuyinBtn),this._yuyinBtn.x=27,this._yuyinBtn.y=480,this._yuyinBtn.visible=!1,this._chatBtn=new DButton("game_json.chatBtn"),this.addChild(this._chatBtn),this._chatBtn.x=26,this._chatBtn.y=557,this._giveUpBtn=new DButton("game_json.qipaiBtn","game_json.qipaiBtn2"),this._giveUpBtn.x=119,this._giveUpBtn.y=543,this.addChild(this._giveUpBtn),this._compareBtn=new DButton("game_json.bipaiBtn","game_json.bipaiBtn2"),this._compareBtn.x=315,this._compareBtn.y=543,this.addChild(this._compareBtn),this._compareBtn.setEnabled(!1),this._cancelCompareBtn=new DButton("game_json.cancelBipaiBtn"),this._cancelCompareBtn.x=315,this._cancelCompareBtn.y=GameGlobal.stageH-97,this.addChild(this._cancelCompareBtn),this._cancelCompareBtn.visible=!1,this._readyBtn=new DButton("game_json.readyBtn"),this._readyBtn.x=320,this._readyBtn.y=GameGlobal.stageH-329,this.addChild(this._readyBtn),this._inviteBtn=new DButton("game_json.inviteBtn"),this._inviteBtn.x=600,this._inviteBtn.y=GameGlobal.stageH-329,this.addChild(this._inviteBtn),this._readyFlag=new egret.Bitmap,this._readyFlag.texture=RES.getRes("game_json.readyed"),this._readyFlag.x=545,this._readyFlag.y=GameGlobal.stageH-232,this.addChild(this._readyFlag),this._readyFlag.visible=!1,this._settingView=new GameSettingView,this._settingView.x=19,this._settingView.y=96,this.addChild(this._settingView),this._settingView.visible=!1,this.initFenBtns(),this._chipContainer=new egret.DisplayObjectContainer,this.addChild(this._chipContainer),this._myPlayerView=new MyPlayerView,this._myPlayerView.x=522,this._myPlayerView.y=GameGlobal.stageH-217,this.addChild(this._myPlayerView),this._emotionContainer=new egret.DisplayObjectContainer,this.addChild(this._emotionContainer),this._refreshBtn=new DButton("game_json.refreshBtn"),this.addChild(this._refreshBtn),this._refreshBtn.y=10,this._refreshBtn.x=GameGlobal.stageW-this._refreshBtn.width-20,this._refreshBtn.visible=!1,this._countDownView=new CountDownView,this.addChild(this._countDownView),this._countDownView.x=GameGlobal.stageW-this._countDownView.width>>1,this._countDownView.y=GameGlobal.stageH-390,this.addEvents(),this.resize()},e.prototype.addEvents=function(){this._optionBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._readyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._inviteBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._giveUpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._compareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._cancelCompareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._chatBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._yuyinBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._1fenBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._2fenBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._3fenBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._refreshBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._yuyinBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this._yuyinBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this._yuyinBtn.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchRelease,this),GameEventManager.addEvent(NetAction.ready.toString(),this.onReadyResponse,this),GameEventManager.addEvent(NetAction.sayPoker.toString(),this.onSayPokerResponse,this),GameEventManager.addEvent(NetAction.look.toString(),this.onLookPokerResponse,this),GameEventManager.addEvent(NetAction.giveup.toString(),this.onGiveupPokerResponse,this),GameEventManager.addEvent(NetAction.follow.toString(),this.onFollowResponse,this),GameEventManager.addEvent(NetAction.compare.toString(),this.onCompareResponse,this),GameEventManager.addEvent(NetAction.autoCompare.toString(),this.onAutoCompareResponse,this),GameEventManager.addEvent(NetAction.chatMsg.toString(),this.onChatMsgResponse,this),GameEventManager.addEvent(NetAction.offline.toString(),this.onOfflineResponse,this),GameEventManager.addEvent(NetAction.online.toString(),this.onOnlineResponse,this),GameEventManager.addEvent(NetAction.autodissolveRoom.toString(),this.autodissolveRoomResponse,this),GameEventManager.addEvent(NetAction.countDown.toString(),this.onCountDownResponse,this),GameEventManager.addEvent("compareComplete",this.onCompareComplete,this),GameEventManager.addEvent(GameEventManager.NEXT_ROUND,this.onNextRound,this),GameGlobal.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchStage,this);var t=this;egret.ExternalInterface.addCallback("recordEndPlay",function(e){LogUtils.log("recordEndPlay"),t._myPlayerView.showRecord(!0),SoundManager.instance.isMusicOn=!1}),egret.ExternalInterface.addCallback("playMyRecordEnd",function(e){LogUtils.log("playMyRecordEnd"),t._myPlayerView.showRecord(!1),SoundManager.instance.isMusicOn=!0}),egret.ExternalInterface.addCallback("uploadRecordComplete",function(t){LogUtils.log("uploadRecordComplete::send record chat message");var e={};e.msgType=NetAction.chatMsg,e.msg={chatType:6,chatMsg:t},SocketCommand.getInstance().send(e)})},e.prototype.onCountDownResponse=function(t){var e=t.data;e.data;this._countDownView.start()},e.prototype.onTouchBegin=function(t){null==this._recordMc&&(this._recordMc=DUtils.createMovieClipByName("record")),this._recordMc.frameRate=12,this._recordMc.play(-1),this.addChild(this._recordMc),this._recordMc.x=GameGlobal.stageW-this._recordMc.width>>1,this._recordMc.y=GameGlobal.stageH-this._recordMc.height>>1,this._isRecording=!0,egret.ExternalInterface.call("recordBegin","recordBegin")},e.prototype.onTouchEnd=function(t){this._recordMc&&this.contains(this._recordMc)&&this.removeChild(this._recordMc),this._isRecording=!1,egret.ExternalInterface.call("recordEnd","recordEnd")},e.prototype.onTouchRelease=function(t){LogUtils.log("onTouchReleaseOutSize"),this._recordMc&&this.contains(this._recordMc)&&this.removeChild(this._recordMc),this._isRecording=!1,this._myPlayerView.showRecord(!1),egret.ExternalInterface.call("recordCancel","recordCancel")},e.prototype.onOfflineResponse=function(t){var e=t.data,i=e.data,n=i.playerId;if(n!=MyUserInfo.getInstance().userId){var a=this.getPlayerView(n);a&&a.setOffline(!0)}},e.prototype.onOnlineResponse=function(t){var e=t.data,i=e.data,n=i.playerId;if(n!=MyUserInfo.getInstance().userId){var a=this.getPlayerView(n);a.setOffline(!1)}},e.prototype.sendEmotionToPlayer=function(t,e,i){var n=this,a=new egret.Bitmap;a.texture=RES.getRes("emotion_json."+t),a.anchorOffsetX=.5*a.width,a.anchorOffsetY=.5*a.height;
var s=this._myPlayerView.getChipBornPos();if(e!=MyUserInfo.getInstance().userId){var o=this.getPlayerView(e);s=o.getChipBornPos()}a.x=s[0],a.y=s[1],this._emotionContainer.addChild(a);var r=[0,0];if(i!=MyUserInfo.getInstance().userId){var o=this.getPlayerView(i);r=o.getChipBornPos()}else r=this._myPlayerView.getChipBornPos();egret.Tween.get(a).to({x:r[0],y:r[1]},800).call(function(e){egret.Tween.removeTweens(e),n._emotionContainer.contains(e)&&n._emotionContainer.removeChild(e);var i=DUtils.createMovieClipByName(t);i.frameRate=12,i.anchorOffsetX=.5*i.width,i.anchorOffsetY=.5*i.height,i.x=a.x,i.y=a.y,n._emotionContainer.addChild(i),MovieClipUtils.playOnce(i,null)},this,[a])},e.prototype.onChatMsgResponse=function(t){var e=t.data,i=e.data,n=i.playerId,a=i.chatType,s=i.chatMsg,o=i.otherPlayerId;if(5==a)return void this.sendEmotionToPlayer(s,n,o);if(6==a){if(o==MyUserInfo.getInstance().userId)return;var r=this;egret.ExternalInterface.addCallback("playRecordEnd",function(t){var e=r.getPlayerView(t);e&&e.showRecord(!1),SoundManager.instance.isMusicOn=!0}),SoundManager.instance.isMusicOn=!1;var h=r.getPlayerView(o);h.showRecord(!0),egret.ExternalInterface.call("playRecord",o+"|"+s)}if(n==MyUserInfo.getInstance().userId)this._myPlayerView.showChatMsg(a,s);else{var h=this.getPlayerView(n);h.showChatMsg(a,s)}},e.prototype.autodissolveRoomResponse=function(t){var e=t.data;e.playerId;AlertView.getInstance().setConfirmCallBack(this.autodissolveRoomConfirm,this),AlertView.getInstance().show("由于玩家离开时间较长，房间自动解散，是否返回大厅？",AlertView.CONFIRM_MODE)},e.prototype.autodissolveRoomConfirm=function(){GameEventManager.dispatchEvent(GameEventManager.QUIT_ROOM)},e.prototype.onCompareComplete=function(t){var e=t.data;this.playerGetChip(e.winnerId)},e.prototype.onTouchStage=function(t){t.target!=this._chatBtn&&this._isShowChat&&ChatView.getInstance()!=t.target&&t.target.parent!=ChatView.getInstance()&&(ChatView.getInstance().hide(),this._isShowChat=!1)},e.prototype.onNextRound=function(){for(var t=this._otherPlayerViews.length,e=0;t>e;e++){var i=this._otherPlayerViews[e];i.setCompareFlag(!1),i.showMyTurn(!1),i.isZhuang=!1,i.updateStatus(-1)}this._giveUpBtn.setEnabled(!1),this._compareBtn.setEnabled(!1),this._1fenBtn.setEnabled(!1),this._2fenBtn.setEnabled(!1),this._3fenBtn.setEnabled(!1),this._cancelCompareBtn.visible=!1,this._compareBtn.visible=!0;var n={};n.msgType=NetAction.ready,n.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(n),GameGlobal.iframeLayer.hideIFrame(GameResult)},e.prototype.onJiesuanResponse=function(t){var e=t.data,i=e.data;GameGlobal.iframeLayer.showIFrame(JieSuanView);var n=GameGlobal.iframeLayer.getIFrame(JieSuanView);n.setData(i)},e.prototype.onAutoCompareResponse=function(t){for(var e=t.data,i=e.data,n=i.playerList,a=n.length,s=0;a>s;s++){var o=n[s].playerId,r=n[s].status;if(o==MyUserInfo.getInstance().userId)this._myPlayerView.updateStatus(r),this._myPlayerView.updateScore(n[s].totalScore),this._myPlayerView.lookPoker(n[s].cardList);else{var h=this.getPlayerView(o);h.updateStatus(r),h.updateScore(n[s].totalScore),h.lookPoker(n[s].cardList)}}var l=i.curWinnerId;this.playerGetChip(l),this._cancelCompareBtn.visible=!1,this._compareBtn.visible=!0,GameGlobal.iframeLayer.showIFrame(GameResult);var c=GameGlobal.iframeLayer.getIFrame(GameResult);c.setData(i);var r=i.status;4==r?c.updateBtn(1):c.updateBtn(0)},e.prototype.playerGetChip=function(t){var e=this,i=this._chipContainer.numChildren,n=[];if(t==MyUserInfo.getInstance().userId)n=this._myPlayerView.getChipBornPos();else{var a=this.getPlayerView(t);n=a.getChipBornPos()}for(var s,o=0;i>o;o++)s=this._chipContainer.getChildAt(o),egret.Tween.get(s).to({x:n[0],y:n[1]},500).to({alpha:0},100).call(function(){s&&e._chipContainer.contains(s)&&e._chipContainer.removeChild(s)},this);SoundManager.instance.playSound("get-chip_mp3")},e.prototype.onCompareResponse=function(t){var e=t.data,i=e.data,n=i.stakeScore,a=i.curPlayerId,s=(i.winnerId,i.loserId);this._lastStakeScore=n;for(var o=this._otherPlayerViews.length,r=0;o>r;r++){var h=this._otherPlayerViews[r];h.touchEnabled=!1,h.setCompareFlag(!1)}if(s==MyUserInfo.getInstance().userId)this._myPlayerView.updateStatus(PlayerView.GIVEUP2);else{var h=this.getPlayerView(s);h&&h.updateStatus(PlayerView.GIVEUP2)}BiPaiView.getInstance().show(i),this.updatePlayerTurn(a)},e.prototype.updatePlayerTurn=function(t,e){void 0===e&&(e=1);for(var i=this._otherPlayerViews.length,n=0;i>n;n++){var a=this._otherPlayerViews[n];a.showMyTurn(!1)}if(this._myPlayerView.showMyTurn(!1),this._giveUpBtn.setEnabled(!1),this._compareBtn.setEnabled(!1),this._1fenBtn.setEnabled(!1),this._2fenBtn.setEnabled(!1),this._3fenBtn.setEnabled(!1),this._currentPlayerId=t,this._countDownView.stop(),t!=MyUserInfo.getInstance().userId){var a=this.getPlayerView(t);a.showMyTurn(!0)}else{this._myPlayerView.showMyTurn(!0),this._giveUpBtn.setEnabled(!0);var s=this.getActivePlayerList(),o=s.length;1>=o?this._compareBtn.setEnabled(!0):this._compareBtn.setEnabled(this._myPlayerView.isKanpai),this.updateBetRule(),this._countDownView.start(120)}},e.prototype.updateBetRule=function(){if(LogUtils.log("this._lastPlayerId = "+this._lastPlayerId+",lastStakeScoe = "+this._lastStakeScore),""!=this._lastPlayerId&&this._lastPlayerId!=MyUserInfo.getInstance().userId){this._1fenBtn.setEnabled(!0),this._2fenBtn.setEnabled(!0),this._3fenBtn.setEnabled(!0);var t=this.getPlayerView(this._lastPlayerId);if(null!=t)if(LogUtils.log("playerView.isKanpai = "+t.isKanpai),LogUtils.log("_myPlayerView.isKanpai = "+this._myPlayerView.isKanpai),t.isKanpai)if(this._myPlayerView.isKanpai)this._1fenBtn.value<this._lastStakeScore&&this._1fenBtn.setEnabled(!1),this._2fenBtn.value<this._lastStakeScore&&this._2fenBtn.setEnabled(!1),this._3fenBtn.value<this._lastStakeScore&&this._3fenBtn.setEnabled(!1);else{var e=this._lastStakeScore;e>10&&(e/=2),this._1fenBtn.value<e&&this._1fenBtn.setEnabled(!1),this._2fenBtn.value<e&&this._2fenBtn.setEnabled(!1),this._3fenBtn.value<e&&this._3fenBtn.setEnabled(!1)}else this._myPlayerView.isKanpai?(this._1fenBtn.value<2*this._lastStakeScore&&this._1fenBtn.setEnabled(!1),this._2fenBtn.value<2*this._lastStakeScore&&this._2fenBtn.setEnabled(!1),this._3fenBtn.value<2*this._lastStakeScore&&this._3fenBtn.setEnabled(!1)):(this._1fenBtn.value<this._lastStakeScore&&this._1fenBtn.setEnabled(!1),this._2fenBtn.value<this._lastStakeScore&&this._2fenBtn.setEnabled(!1),this._3fenBtn.value<this._lastStakeScore&&this._3fenBtn.setEnabled(!1))}else this._1fenBtn.setEnabled(!0),this._2fenBtn.setEnabled(!0),this._3fenBtn.setEnabled(!0)},e.prototype.onFollowResponse=function(t){var e=t.data,i=e.data,n=i.playerId,a=i.stakeScore,s=(i.stakeTimes,i.curPlayerId),o=i.totalStakeTimes;void 0!=o&&null!=o&&this._betInfoView.updateCurrentRound(o),this._lastStakeScore=a,this._lastPlayerId=n,this.betChip(n,a),SoundManager.instance.playSound("send-chip_mp3"),this.updatePlayerTurn(s,a)},e.prototype.onGiveupPokerResponse=function(t){var e=t.data,i=e.data,n=i.playerId;if(n==MyUserInfo.getInstance().userId)this._myPlayerView.updateStatus(PlayerView.GIVEUP);else{var a=this.getPlayerView(n);a.updateStatus(PlayerView.GIVEUP)}var s=i.curPlayerId;this.updatePlayerTurn(s),SoundManager.instance.playSound("fold_mp3")},e.prototype.onLookPokerResponse=function(t){var e=t.data,i=e.data,n=i.playerId,a=(i.cardType,i.cardList);if(n==MyUserInfo.getInstance().userId)this._myPlayerView.lookPoker(a),this._myPlayerView.updateStatus(PlayerView.LOOKED),this._myPlayerView.canLook=!1,this._1fenBtn.setSkin("game_json.4fenBtn","game_json.4fenBtn2"),this._1fenBtn.value=4,this._2fenBtn.setSkin("game_json.10fenBtn","game_json.10fenBtn2"),this._2fenBtn.value=10,this._3fenBtn.setSkin("game_json.20fenBtn","game_json.20fenBtn2"),this._3fenBtn.value=20,this._compareBtn.setEnabled(this._currentPlayerId==MyUserInfo.getInstance().userId);else{var s=this.getPlayerView(n);s.updateStatus(PlayerView.LOOKED),this._cancelCompareBtn.visible&&(s.setCompareFlag(!0),s.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOtherPlayer,this))}this._currentPlayerId==MyUserInfo.getInstance().userId&&this.updateBetRule(),SoundManager.instance.playSound("check_mp3")},e.prototype.onReadyResponse=function(t){var e=t.data,i=e.data,n=i.playerId;if(n==MyUserInfo.getInstance().userId)this._readyBtn.visible=!1,this._1fenBtn.setSkin("game_json.2fenBtn","game_json.2fenBtn2"),this._1fenBtn.value=2,this._2fenBtn.setSkin("game_json.5fenBtn","game_json.5fenBtn2"),this._2fenBtn.value=5,this._3fenBtn.setSkin("game_json.10fenBtn","game_json.10fenBtn2"),this._3fenBtn.value=10,this._myPlayerView.updateStatus(PlayerView.READYED);else{var a=this.getPlayerView(n);a.updateStatus(PlayerView.READYED)}this._myPlayerView.hidePoker()},e.prototype.onSayPokerResponse=function(t){var e=t.data,i=e.data,n=i.roomBankerId;this._betInfoView.updateRound(i.curGame,i.totalGames),this._countDownView.stop(),this._inviteBtn.visible=!1,this._readyBtn.visible=this._readyFlag.visible=!1,this._betInfoView.updateRound(i.curGame,i.totalGames);for(var a=this._roomInfo.playerList,s=0;s<a.length;s++){if(a[s].playerId==MyUserInfo.getInstance().userId)this._myPlayerView.updateStatus(PlayerView.NOT_READY),this._myPlayerView.isZhuang=!1;else{var o=this.getPlayerView(a[s].playerId);o.updateStatus(PlayerView.NOT_READY),o.isZhuang=!1}this.betChip(a[s].playerId)}if(SoundManager.instance.playSound("send-chip_mp3"),n==MyUserInfo.getInstance().userId)this._myPlayerView.isZhuang=!0;else{var o=this.getPlayerView(n);o.isZhuang=!0}this._lastStakeScore=0,this._lastPlayerId="",this._currentPlayerId="";var r=i.curPlayerId;this.updatePlayerTurn(r),r==MyUserInfo.getInstance().userId?(this._giveUpBtn.setEnabled(!0),this._1fenBtn.setEnabled(!0),this._2fenBtn.setEnabled(!0),this._3fenBtn.setEnabled(!0)):(this._giveUpBtn.setEnabled(!1),this._1fenBtn.setEnabled(!1),this._2fenBtn.setEnabled(!1),this._3fenBtn.setEnabled(!1)),this._1fenBtn.setSkin("game_json.2fenBtn","game_json.2fenBtn2"),this._1fenBtn.value=2,this._2fenBtn.setSkin("game_json.5fenBtn","game_json.5fenBtn2"),this._2fenBtn.value=5,this._3fenBtn.setSkin("game_json.10fenBtn","game_json.10fenBtn2"),this._3fenBtn.value=10,egret.clearTimeout(this._fapaiTimerId),this._fapaiTimerId=egret.setTimeout(this.fapai,this,500),GameGlobal.iframeLayer.hideIFrame(GameResult)},e.prototype.fapai=function(){this._myPlayerView.sayPoker(),this._myPlayerView.canLook=!0;for(var t=this._otherPlayerViews.length,e=0;t>e;e++){var i=this._otherPlayerViews[e];i.sayPoker()}SoundManager.instance.playSound("start_mp3")},e.prototype.betChip=function(t,e){void 0===e&&(e=2);var i=new ChipView,n=this._myPlayerView.getChipBornPos();if(t!=MyUserInfo.getInstance().userId){var a=this.getPlayerView(t);a.updateBetNum(e),n=a.getChipBornPos()}else this._myPlayerView.updateBetNum(e);i.x=n[0],i.y=n[1],this._chipContainer.addChild(i);var s=this.getRandomChipPos();egret.Tween.get(i).to({x:s[0],y:s[1]},300),i.setValue(e),this._betInfoView.addChip(e)},e.prototype.getActivePlayerList=function(){for(var t=this._otherPlayerViews.length,e=[],i=0;t>i;i++){var n=this._otherPlayerViews[i];n.isOffline()||n.getStatus()!=PlayerView.GIVEUP&&n.getStatus()!=PlayerView.GIVEUP2&&n.getStatus()!=PlayerView.WATCHER&&e.push(n)}return e},e.prototype.getRandomChipPos=function(){var t=.5*GameGlobal.stage.stageWidth,e=.5*GameGlobal.stage.stageHeight-50;return[t+DUtils.createRandomNum(-30,30),e+DUtils.createRandomNum(-30,30)]},e.prototype.getPlayerView=function(t){for(var e=this._otherPlayerViews.length,i=0;e>i;i++){var n=this._otherPlayerViews[i],a=n.getData();if(a.playerId.toString()==t)return this._otherPlayerViews[i]}return null},e.prototype.onTouchTap=function(t){if(t.currentTarget==this._optionBtn)this.showOrHideOptionView();else if(t.currentTarget==this._readyBtn){var e={};e.msgType=NetAction.ready,e.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(e)}else if(t.currentTarget==this._inviteBtn)ShareGuideView.getInstance().show();else if(t.currentTarget==this._giveUpBtn){var e={};e.msgType=NetAction.giveup,e.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(e)}else if(t.currentTarget==this._compareBtn){this._compareBtn.visible=!1,this._cancelCompareBtn.visible=!0;for(var i=this._otherPlayerViews.length,n=this.getActivePlayerList(),a=n.length,s=0;a>s;s++){var o=n[s];o.touchEnabled=!0,(1>=a||o.isKanpai&&o.getStatus()!=PlayerView.GIVEUP&&o.getStatus()!=PlayerView.GIVEUP2&&o.getStatus()!=PlayerView.WATCHER)&&(o.setCompareFlag(!0),o.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOtherPlayer,this))}0==MyUserInfo.getInstance().gender?SoundManager.instance.playSound("vs_mp3"):SoundManager.instance.playSound("vs2_mp3")}else if(t.currentTarget==this._cancelCompareBtn){this._compareBtn.visible=!0,this._cancelCompareBtn.visible=!1;for(var i=this._otherPlayerViews.length,s=0;i>s;s++){var o=this._otherPlayerViews[s];o.touchEnabled=!1,o.setCompareFlag(!1),o.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOtherPlayer,this)}}else if(t.currentTarget==this._1fenBtn){var e={};e.msgType=NetAction.follow,e.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId,curStakeScore:this._1fenBtn.value},SocketCommand.getInstance().send(e)}else if(t.currentTarget==this._2fenBtn){var e={};e.msgType=NetAction.follow,e.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId,curStakeScore:this._2fenBtn.value},SocketCommand.getInstance().send(e)}else if(t.currentTarget==this._3fenBtn){var e={};e.msgType=NetAction.follow,e.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId,curStakeScore:this._3fenBtn.value},SocketCommand.getInstance().send(e)}else if(t.currentTarget==this._chatBtn)this._isShowChat?(ChatView.getInstance().hide(),this._isShowChat=!1):(ChatView.getInstance().show(),ChatView.getInstance().x=15,ChatView.getInstance().y=GameGlobal.stageH-373,this._isShowChat=!0);else if(t.currentTarget==this._refreshBtn){var e={};e.msgType=NetAction.refreshRoom,e.msg={refreshType:1},e.gameType=0,SocketCommand.getInstance().send(e)}},e.prototype.onTouchOtherPlayer=function(t){var e=t.currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchOtherPlayer,this);var i=e.getData(),n=i.playerId;this._cancelCompareBtn.visible=!1,this._compareBtn.visible=!0;var a=this.getCurrentMinBet();this.betChip(MyUserInfo.getInstance().userId,a),SoundManager.instance.playSound("send-chip_mp3");var s={};s.msgType=NetAction.compare,s.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId,curStakeScore:2,otherPlayerId:n},SocketCommand.getInstance().send(s)},e.prototype.getCurrentMinBet=function(){var t=2;return t=this._1fenBtn.isEnabled?this._1fenBtn.value:this._2fenBtn.isEnabled?this._2fenBtn.value:this._3fenBtn.value},e.prototype.showOrHideOptionView=function(){this._isShowOption=!this._isShowOption,this._optionBtn.setSkin(this._isShowOption?"game_json.optionBtn":"game_json.optionBtn2"),this._settingView.visible=this._isShowOption},e.prototype.initFenBtns=function(){this._1fenBtn=new DButton("game_json.2fenBtn","game_json.2fenBtn2"),this.addChild(this._1fenBtn),this._1fenBtn.x=545,this._1fenBtn.y=550,this._1fenBtn.value=2,this._2fenBtn=new DButton("game_json.5fenBtn","game_json.5fenBtn2"),this.addChild(this._2fenBtn),this._2fenBtn.x=726,this._2fenBtn.y=550,this._2fenBtn.value=5,this._3fenBtn=new DButton("game_json.10fenBtn","game_json.10fenBtn2"),this.addChild(this._3fenBtn),this._3fenBtn.x=907,this._3fenBtn.y=550,this._3fenBtn.value=10},e.prototype.resize=function(){this._chatBtn.y=GameGlobal.stageH-83,this._giveUpBtn.y=GameGlobal.stageH-97,this._compareBtn.y=GameGlobal.stageH-97,this._cancelCompareBtn.y=GameGlobal.stageH-97,this._1fenBtn.y=this._2fenBtn.y=this._3fenBtn.y=GameGlobal.stageH-90,this._myPlayerView.y=GameGlobal.stageH-217,this._bg2.y=GameGlobal.stageH-556,this._readyBtn.y=GameGlobal.stageH-329,this._inviteBtn.y=GameGlobal.stageH-329,this._readyFlag.y=GameGlobal.stageH-232,this._readyFlag.visible=!1;for(var t=this._otherPlayerViews.length,e=0;t>e;e++){var i=this._otherPlayerViews[e];1==i.getPosition()||11==i.getPosition()?i.y=GameGlobal.stageH-217:(2==i.getPosition()||10==i.getPosition())&&(i.y=GameGlobal.stageH-250)}if(this._betInfoView.resize(),this._countDownView.y=GameGlobal.stageH-390,GameGlobal.iframeLayer.isIframeShow(JieSuanView)){var n=GameGlobal.iframeLayer.getIFrame(JieSuanView);n.resize()}},e.READY_STATUS=1,e.GAMEING=2,e.ROUND_END=3,e.GAME_END=4,e}(egret.Sprite);__reflect(GameView.prototype,"GameView");var HallView=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.resize=function(){this._createBtn.y=GameGlobal.stageH-509,this._joinBtn.y=GameGlobal.stageH-509},e.prototype.initView=function(){this._bg=new egret.Bitmap,this.addChild(this._bg),this._bg.texture=RES.getRes("bg3_png"),this._bg.width=GameGlobal.stageW,this._bg.height=GameGlobal.stageH,this._createBtn=new DButton("createRoomBtn_png"),this.addChild(this._createBtn),this._createBtn.x=196,this._createBtn.y=GameGlobal.stageH-509,this._joinBtn=new DButton("joinRoomBtn_png"),this.addChild(this._joinBtn),this._joinBtn.x=655,this._joinBtn.y=GameGlobal.stageH-509,this._quitBtn=new DButton("ui_json.quitBtn"),this.addChild(this._quitBtn),this._quitBtn.x=12,this._quitBtn.y=39,this._mallBtn=new DButton("ui_json.mallBtn"),this.addChild(this._mallBtn),this._mallBtn.x=12,this._mallBtn.y=107,this._mallBtn.visible=!1,this._zhanjiBtn=new DButton("ui_json.zhanjiBtn"),this.addChild(this._zhanjiBtn),this._zhanjiBtn.x=12,this._zhanjiBtn.y=107,this._ruleBtn=new DButton("ui_json.wanfaBtn"),this.addChild(this._ruleBtn),this._ruleBtn.x=12,this._ruleBtn.y=223,this._shareBtn=new DButton("ui_json.shareBtn"),this.addChild(this._shareBtn),this._shareBtn.x=12,this._shareBtn.y=364,this._logo=new egret.Bitmap,this._logo.x=471,this._logo.y=1,this._logo.texture=RES.getRes("ui_json.logo3"),this.addChild(this._logo),this._selfInfoView=new SelfInfoView,this._selfInfoView.x=76,this._selfInfoView.y=-1,this.addChild(this._selfInfoView),this._noticeView=new NoticeView,this._noticeView.x=426,this._noticeView.y=110,this.addChild(this._noticeView),this._setBtn=new DButton("ui_json.setBtn"),this.addChild(this._setBtn),this._setBtn.x=1028,this._setBtn.y=14,this._feedBackBtn=new DButton("ui_json.feedbackBtn"),this.addChild(this._feedBackBtn),this._feedBackBtn.x=925,this._feedBackBtn.y=10,this._feedBackBtn.visible=!1,this._setBtn.scaleX=this._setBtn.scaleY=.6,this._feedBackBtn.scaleX=this._feedBackBtn.scaleY=.6,this._tuiguangBtn=new DButton("ui_json.tgBtn"),this.addChild(this._tuiguangBtn),this._tuiguangBtn.scaleX=this._tuiguangBtn.scaleY=.6,this._tuiguangBtn.x=1028,this._tuiguangBtn.y=10,this._tuiguangBtn.visible=!1,this.addEvents()},e.prototype.addEvents=function(){this._quitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._createBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._setBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._ruleBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._feedBackBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._joinBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._zhanjiBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._mallBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._tuiguangBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),GameEventManager.addEvent(NetAction.notice.toString(),this.onNoticeResponse,this)},e.prototype.onNoticeResponse=function(t){var e=t.data,i=e.data,n=i.noticeContent;this._noticeView.addNotice(n)},e.prototype.onTouchTap=function(t){t.currentTarget==this._quitBtn?(AlertView.getInstance().setConfirmCallBack(this.quitConfirm,this),AlertView.getInstance().show("确定要离开游戏吗？",AlertView.CONFIRM_MODE)):t.currentTarget==this._setBtn?GameGlobal.iframeLayer.showIFrame(SettingView):t.currentTarget==this._shareBtn?ShareGuideView.getInstance().show():t.currentTarget==this._ruleBtn?GameGlobal.iframeLayer.showIFrame(RuleView):t.currentTarget==this._feedBackBtn?GameGlobal.iframeLayer.showIFrame(FeedBackView):t.currentTarget==this._joinBtn?GameGlobal.iframeLayer.showIFrame(JoinRoomView):t.currentTarget==this._zhanjiBtn?GameGlobal.iframeLayer.showIFrame(MyZhanjiView):t.currentTarget==this._mallBtn?GameGlobal.iframeLayer.showIFrame(MallView):t.currentTarget==this._tuiguangBtn?GameGlobal.iframeLayer.showIFrame(BindIdView):GameGlobal.iframeLayer.showIFrame(CreateRoomView)},e.prototype.quitConfirm=function(){egret.ExternalInterface.call("exitGame","exitGame")},e}(egret.Sprite);__reflect(HallView.prototype,"HallView");var JieSuanView=function(t){function e(){var e=t.call(this)||this;return e._isDissolve=!1,e._timerId=-1,e.init(),e}return __extends(e,t),e.prototype.setData=function(t,e){void 0===e&&(e=!1),this._isDissolve=e,this._data=t},e.prototype.show=function(){if(null!=this._data){for(var t=this._data.playerList;this._listContainer.numChildren>0;)this._listContainer.removeChildAt(0);for(var e,i=this._data.roomOwnerId,n=this._data.totalWinnerId,a=t.length,s=0;a>s;s++)e=new JieSuanTile,e.scaleX=e.scaleY=.8,e.x=s%6*180,e.y=150*Math.floor(s/6),this._listContainer.addChild(e),e.setData(t[s]),t[s].playerId==i?e.isFang=!0:e.isFang=!1,t[s].playerId==n?e.isWin=!0:e.isWin=!1;if(!this._isDissolve){var o={};o.msgType=NetAction.backToHall,o.msg={playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(o)}this.resize(),egret.clearTimeout(this._timerId),this._timerId=egret.setTimeout(this.onDrawTimeOut,this,500)}},e.prototype.onDrawTimeOut=function(){var t=this;egret.clearTimeout(this._timerId),this.visible=!1;var e=new egret.RenderTexture;e.drawToTexture(this,new egret.Rectangle(0,0,this.width,this.height));var i="";i=e.toDataURL("image/png"),GameGlobal.resultImgBase64=i,this._timerId=egret.setTimeout(function(){egret.clearTimeout(t._timerId),ShareResultView.getInstance().show()},this,100)},e.prototype.resize=function(){this._shareBtn.x=570,this._shareBtn.y=GameGlobal.stageH-105},e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this.addChild(this._bg),this._bg.texture=RES.getRes("resultBg_png"),this._listContainer=new egret.Sprite,this.addChild(this._listContainer),this._listContainer.x=43,this._listContainer.y=157,this._shareBtn=new DButton("game_json.shareBtn2"),this.addChild(this._shareBtn),this._shareBtn.x=GameGlobal.stageW-this._shareBtn.width>>1,this._shareBtn.y=GameGlobal.stageH-105,this.iframeWidth=this.width,this.iframeHeight=this.height;var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,t.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onTouchTap=function(t){if(t.currentTarget==this._shareBtn){this.visible=!1;var e=new egret.RenderTexture;e.drawToTexture(this,new egret.Rectangle(0,0,this.width,this.height));var i="";i=e.toDataURL("image/png"),GameGlobal.resultImgBase64=i,ShareResultView.getInstance().show()}else if(t.currentTarget==this._backBtn){GameEventManager.addEvent(NetAction.backToHall.toString(),this.backToHallResponse,this);var n={};n.msgType=NetAction.backToHall,n.msg={playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(n)}},e.prototype.backToHallResponse=function(t){GameEventManager.dispatchEvent(GameEventManager.QUIT_ROOM)},e}(IFrameBase);__reflect(JieSuanView.prototype,"JieSuanView");var JieSuanTile=function(t){function e(){var e=t.call(this)||this;return e._isFang=!1,e._isWin=!1,e.initView(),e}return __extends(e,t),e.prototype.setData=function(t){this._data=t,this._idNameTF.text="ID:"+t.playerId,this._totalScoreTF.text=t.totalScore;var e=GameGlobal.mapLayer.getBattle().getPlayerInfoById(t.playerId),i=e.nickName;i.length>10&&(i=i.substr(0,10)+"..."),this._nickNameTF.text=i,this.isFang=!1,this.isWin=!1,this._faceImg.texture=RES.getRes("game_json.testFace"),this._faceImg.width=90,this._faceImg.height=91;var n=e.headImgUrl;null!=n&&this.loadFace(n)},e.prototype.loadFace=function(t){var e=new egret.ImageLoader;e.addEventListener(egret.Event.COMPLETE,this.imageComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFaceError,this),e.load(t)},e.prototype.onLoadFaceError=function(t){console.log("load face ioerror")},e.prototype.imageComplete=function(t){console.log("load face complete"),this._faceImg.texture=t.target.data,this._faceImg.width=90,this._faceImg.height=91},Object.defineProperty(e.prototype,"isFang",{set:function(t){this._fangFlag.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWin",{set:function(t){this._winFlag.visible=t},enumerable:!0,configurable:!0}),e.prototype.initView=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("game_json.resultTile"),this._faceImg=new egret.Bitmap,this._faceImg.x=11,this._faceImg.y=15,this.addChild(this._faceImg),this._nickNameTF=new egret.TextField,this._nickNameTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._nickNameTF.textColor=16777215,this._nickNameTF.size=20,this._nickNameTF.bold=!0,this._nickNameTF.textAlign=egret.HorizontalAlign.LEFT,this._nickNameTF.x=108,this._nickNameTF.y=19,this.addChild(this._nickNameTF),this._idNameTF=new egret.TextField,this._idNameTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._idNameTF.textColor=16777215,this._idNameTF.size=20,this._idNameTF.bold=!0,this._idNameTF.textAlign=egret.HorizontalAlign.LEFT,this._idNameTF.x=108,this._idNameTF.y=46,this.addChild(this._idNameTF),this._fangFlag=new egret.Bitmap,this._fangFlag.texture=RES.getRes("game_json.fangzhuflag"),this.addChild(this._fangFlag),this._fangFlag.x=110,this._fangFlag.y=74,this._fangFlag.visible=!1,this._winFlag=new egret.Bitmap,this._winFlag.texture=RES.getRes("game_json.winFlag"),this.addChild(this._winFlag),this._winFlag.x=-36,this._winFlag.y=-17,this._winFlag.visible=!1;var t=new egret.TextField;t.fontFamily=GameGlobal.DEFAULT_FONT_NAME,t.textColor=16777215,t.size=24,t.textAlign=egret.HorizontalAlign.LEFT,this.addChild(t),t.x=14,t.y=130,t.bold=!0,t.text="总成绩",this._totalScoreTF=new egret.TextField,this._totalScoreTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._totalScoreTF.textColor=16777215,this._totalScoreTF.size=24,this._totalScoreTF.textAlign=egret.HorizontalAlign.RIGHT,this.addChild(this._totalScoreTF),this._totalScoreTF.x=114,this._totalScoreTF.y=130,this._totalScoreTF.width=80,this._totalScoreTF.text="0"},e}(egret.Sprite);__reflect(JieSuanTile.prototype,"JieSuanTile");var JoinRoomView=function(t){function e(){var e=t.call(this)||this;return e._numTFs=[],e._tfIndex=-1,e.init(),e}return __extends(e,t),e.prototype.show=function(){this.clearNumTF()},e.prototype.hide=function(){this.clearNumTF()},e.prototype.initButtons=function(){for(var t,e=12,i=0;e>i;i++)t=new DButton(9==i?"ui_json.resetBtn":10==i?"ui_json.data0":11==i?"ui_json.delNumBtn":"ui_json.data"+(i+1)),t.index=i,t.x=56+i%3*161,t.y=235+79*Math.floor(i/3),this.addChild(t),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onTouchTap=function(t){if(t.currentTarget==this._closeBtn)GameGlobal.iframeLayer.hideIFrame(e);else{var i=t.currentTarget,n=i.index;if(9==n?this.clearNumTF():10==n?this.addNumTF(-1):11==n?this.removeNumTF():this.addNumTF(n),this._tfIndex>=this._numTFs.length-1){var a=this.getRoomId();LogUtils.log("roomId = "+a);var s={};s.msgType=NetAction.enterRoom,s.msg={roomId:a,playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(s)}}},e.prototype.getRoomId=function(){for(var t="",e=this._numTFs.length,i=0;e>i;i++)t+=this._numTFs[i].text;return t},e.prototype.addNumTF=function(t){this._tfIndex++,this._tfIndex=Math.min(this._numTFs.length-1,this._tfIndex);var e=this._numTFs[this._tfIndex];e.text=(t+1).toString()},e.prototype.clearNumTF=function(){this._tfIndex=-1;for(var t=this._numTFs.length,e=0;t>e;e++)this._numTFs[e].text=""},e.prototype.removeNumTF=function(){if(-1!=this._tfIndex){var t=this._numTFs[this._tfIndex];t.text="",this._tfIndex--,this._tfIndex=Math.max(-1,this._tfIndex)}},e.prototype.initNumTF=function(){for(;this._tfContainer.numChildren>0;)this._tfContainer.removeChildAt(0);this._numTFs=[];for(var t,e=6,i=0;e>i;i++)t=new egret.TextField,t.fontFamily=GameGlobal.DEFAULT_FONT_NAME,t.textColor=6898186,t.size=40,t.textAlign=egret.HorizontalAlign.CENTER,t.width=60,t.text="",t.x=67+77*i,2==i?t.x=227:3==i?t.x=307:4==i?t.x=386:5==i&&(t.x=467),t.y=135,this._numTFs.push(t),this._tfContainer.addChild(t)},e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("joinRoomBg_png"),this.addChild(this._bg),this._numBg=new egret.Bitmap,this._numBg.texture=RES.getRes("ui_json.inputBg"),this.addChild(this._numBg),this._numBg.x=63,this._numBg.y=126,this._tfContainer=new egret.DisplayObjectContainer,this.addChild(this._tfContainer),this.initNumTF(),this.initButtons(),this._inputTipTF=new egret.TextField,this._inputTipTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._inputTipTF.textColor=9063179,this._inputTipTF.size=25,this._inputTipTF.textAlign=egret.HorizontalAlign.LEFT,this._inputTipTF.x=222,this._inputTipTF.y=199,this.addChild(this._inputTipTF),this._inputTipTF.text="请输入房间号",this._closeBtn=new DButton("ui_json.closeBtn"),this.addChild(this._closeBtn),this._closeBtn.x=537,this._closeBtn.y=11,this.iframeWidth=this.width,this.iframeHeight=this.height;var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,t.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e}(IFrameBase);__reflect(JoinRoomView.prototype,"JoinRoomView");var MallView=function(t){function e(){var e=t.call(this)||this;return e._data=null,e.init(),e}return __extends(e,t),e.prototype.show=function(){GameEventManager.addEvent(NetAction.mallList.toString(),this.onMallListResponse,this);var t={};t.msgType=NetAction.mallList,t.gameType=0,SocketCommand.getInstance().send(t)},e.prototype.hide=function(){GameEventManager.removeEvent(NetAction.mallList.toString(),this.onMallListResponse,this)},e.prototype.onMallListResponse=function(t){var e=t.data,i=e.data;this.updateMallList(i)},e.prototype.updateMallList=function(t){for(;this._listContainer.numChildren>0;)this._listContainer.removeChildAt(0);for(var e,i=t.length,n=0;i>n;n++)e=new MallItemTile,e.setData(t[n]),e.x=n%4*200,e.y=229*Math.floor(n/4),this._listContainer.addChild(e),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTile,this);this._scrollView.setScrollPosition(0,0)},e.prototype.onTouchTile=function(t){var e=t.currentTarget;this._data=e.getData(),GameEventManager.addEvent(NetAction.checkBind.toString(),this.onCheckBindResponse,this);var i={};i.msgType=NetAction.checkBind,i.gameType=0,SocketCommand.getInstance().send(i)},e.prototype.onCheckBindResponse=function(t){GameEventManager.removeEvent(NetAction.checkBind.toString(),this.onCheckBindResponse,this),GameEventManager.addEvent(NetAction.buy.toString(),this.onBuyResponse,this);var e={};e.msgType=NetAction.buy,e.gameType=0,e.msg={productId:this._data.productId},SocketCommand.getInstance().send(e)},e.prototype.onBuyResponse=function(t){var e=t.data,i=e.data,n=JSON.stringify(i);egret.ExternalInterface.call("pay",n)},e.prototype.unifiedOrderResponse=function(t){var e=t.data,i=JSON.stringify(e);egret.ExternalInterface.call("pay",i)},e.prototype.onTouchTap=function(t){GameGlobal.iframeLayer.hideIFrame(e)
},e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("mallBg_png"),this.addChild(this._bg),this._closeBtn=new DButton("ui_json.closeBtn"),this.addChild(this._closeBtn),this._closeBtn.x=832,this._closeBtn.y=63,this._listContainer=new egret.DisplayObjectContainer,this.addChild(this._listContainer),this._scrollView=new egret.ScrollView,this._scrollView.setContent(this._listContainer),this._scrollView.x=68,this._scrollView.y=128,this._scrollView.width=this.width,this._scrollView.height=540,this._scrollView.horizontalScrollPolicy="off",this.addChild(this._scrollView),this.iframeWidth=this.width,this.iframeHeight=this.height;var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,t.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e}(IFrameBase);__reflect(MallView.prototype,"MallView");var MallItemTile=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.setData=function(t){this._data=t,this._countTF.text="房卡"+t.roomCardNum+"张",this._priceTF.text="￥"+t.showPrice+"元"},e.prototype.getData=function(){return this._data},e.prototype.onTouchTap=function(t){this.dispatchEvent(new DEvent("buyGoods"))},e.prototype.initView=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("mallItemBg_png"),this.addChild(this._bg),this._countTF=new egret.TextField,this._countTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._countTF.textColor=16777215,this._countTF.size=20,this.addChild(this._countTF),this._countTF.textAlign=egret.HorizontalAlign.CENTER,this._countTF.width=148,this._countTF.height=30,this._countTF.text="房卡10张",this._countTF.x=3,this._countTF.y=3,this._buyBtn=new DButton("ui_json.buyBtnBg"),this.addChild(this._buyBtn),this._buyBtn.x=5,this._buyBtn.y=150,this._priceTF=new egret.TextField,this._priceTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._priceTF.textColor=16777215,this._priceTF.size=26,this._priceTF.bold=!0,this.addChild(this._priceTF),this._priceTF.textAlign=egret.HorizontalAlign.CENTER,this._priceTF.width=104,this._priceTF.height=42,this._priceTF.text="10元",this._priceTF.x=27,this._priceTF.y=159,this.touchChildren=!1,this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e}(egret.Sprite);__reflect(MallItemTile.prototype,"MallItemTile");var MyPlayerView=function(t){function e(){var e=t.call(this)||this;return e._isSelf=!0,e._kanpaiTip=new egret.Bitmap,e._kanpaiTip.texture=RES.getRes("game_json.kanpaiTip"),e.addChild(e._kanpaiTip),e._kanpaiTip.scaleX=e._kanpaiTip.scaleY=.6,e._kanpaiTip.x=78,e._kanpaiTip.y=60,e._kanpaiTip.visible=!1,e._cardGroup.touchChildren=!1,e._cardGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onTouchCard,e),e}return __extends(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this._cardGroup.showPokerValue(!1),this._cardGroup.visible=!1,this._kanpaiTip.visible=!1},e.prototype.hidePoker=function(){this._kanpaiTip.visible=!1,this._cardGroup.showPokerValue(!1),this._cardGroup.visible=!1,this._giveuped.visible=!1},e.prototype.lookPoker=function(e,i){void 0===i&&(i=!0),t.prototype.lookPoker.call(this,e,i),null!=e&&e.length>0&&(this._kanpaiTip.visible=!1)},e.prototype.updateStatus=function(e){t.prototype.updateStatus.call(this,e),this._kanpaiTip.visible=e==PlayerView.NOT_LOOK&&this._cardGroup.visible},Object.defineProperty(e.prototype,"canLook",{set:function(t){t?(this._kanpaiTip.visible=!0,this._cardGroup.touchEnabled=!0):(this._kanpaiTip.visible=!1,this._cardGroup.touchEnabled=!1)},enumerable:!0,configurable:!0}),e.prototype.onTouchCard=function(t){var e={};e.msgType=NetAction.look,e.msg={roomId:GameModel.instance().roomId,playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(e)},e}(PlayerView);__reflect(MyPlayerView.prototype,"MyPlayerView");var MyZhanjiView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.show=function(){GameEventManager.addEvent(NetAction.zhanji.toString(),this.onZhanjiResponse,this);var t={};t.msgType=NetAction.zhanji,SocketCommand.getInstance().send(t)},e.prototype.hide=function(){GameEventManager.removeEvent(NetAction.zhanji.toString(),this.onZhanjiResponse,this)},e.prototype.onZhanjiResponse=function(t){GameEventManager.removeEvent(NetAction.zhanji.toString(),this.onZhanjiResponse,this);var e=t.data,i=e.data;this.updateList(i)},e.prototype.updateList=function(t){for(;this._listContainer.numChildren>0;)this._listContainer.removeChildAt(0);for(var e,i=t.length,n=0;i>n;n++)e=new ZhanjiTile,e.setData(t[n],n+1),this._listContainer.addChild(e),e.y=107*n;this._scrollView.setScrollPosition(0,0)},e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("zhanjiBg_png"),this.addChild(this._bg),this._bg.x=2,this._bg.y=13,this._closeBtn=new DButton("ui_json.quitBtn"),this._closeBtn.x=12,this._closeBtn.y=39,this.addChild(this._closeBtn),this._listContainer=new egret.DisplayObjectContainer,this._scrollView=new egret.ScrollView,this._scrollView.setContent(this._listContainer),this._scrollView.width=1134,this._scrollView.height=425,this.addChild(this._scrollView),this._scrollView.y=221,this._scrollView.x=33,this.iframeWidth=1134,this.iframeHeight=615;var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,t.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onTouchTap=function(t){GameGlobal.iframeLayer.hideIFrame(e)},e}(IFrameBase);__reflect(MyZhanjiView.prototype,"MyZhanjiView");var ZhanjiTile=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.setData=function(t,e){void 0===e&&(e=1),this._numTF.text=e.toString();var i=t.roomId,n=t.createTime,a=new Date(n),s=[a.getFullYear(),a.getMonth()+1,a.getDate()].join("/");s+=" "+a.toTimeString().substr(0,8),this._fanghaoTF.text="房间号："+i.toString(),this._timeTF.text=s;var o=t.recordList,r=o.length;this._playerTF.text="";for(var h=0;r>h;h++)this._playerTF.appendText(o[h].nickName+" "+o[h].score+"\n")},e.prototype.initView=function(){this._numTF=new egret.TextField,this._numTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._numTF.textColor=16440976,this._numTF.size=42,this._numTF.bold=!0,this._numTF.textAlign=egret.HorizontalAlign.LEFT,this.addChild(this._numTF),this._numTF.x=136,this._numTF.y=18,this._numTF.text="1",this._fanghaoTF=new egret.TextField,this._fanghaoTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._fanghaoTF.textColor=16440976,this._fanghaoTF.size=29,this._fanghaoTF.bold=!0,this._fanghaoTF.textAlign=egret.HorizontalAlign.CENTER,this._fanghaoTF.width=299,this.addChild(this._fanghaoTF),this._fanghaoTF.x=346,this._fanghaoTF.y=4,this._fanghaoTF.text="房间号：",this._timeTF=new egret.TextField,this._timeTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._timeTF.textColor=16440976,this._timeTF.size=29,this._timeTF.bold=!0,this._timeTF.textAlign=egret.HorizontalAlign.CENTER,this._timeTF.width=299,this.addChild(this._timeTF),this._timeTF.x=346,this._timeTF.y=49,this._timeTF.text="",this._playerTF=new egret.TextField,this._playerTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._playerTF.textColor=16440976,this._playerTF.size=20,this._playerTF.bold=!0,this._playerTF.textAlign=egret.HorizontalAlign.LEFT,this._playerTF.multiline=!0,this._playerTF.wordWrap=!0,this._playerTF.width=310,this._playerTF.height=88,this.addChild(this._playerTF),this._playerTF.x=775,this._playerTF.y=4,this._lineBg=new egret.Bitmap,this._lineBg.texture=RES.getRes("lineBg_png"),this.addChild(this._lineBg),this._lineBg.x=0,this._lineBg.y=96},e}(egret.Sprite);__reflect(ZhanjiTile.prototype,"ZhanjiTile");var NoticeView=function(t){function e(){var e=t.call(this)||this;return e._notices=[],e._noticeIndex=0,e.initView(),e}return __extends(e,t),e.prototype.addNotice=function(t){this._notices.push(t),1==this._notices.length&&this.nextNotice(),this.visible=!0},e.prototype.nextNotice=function(){var t=this;this._noticeIndex>=this._notices.length&&(this._noticeIndex=0);var e=this._notices[this._noticeIndex],i=2e4;this._noticeTF.text=e,egret.Tween.removeTweens(this._noticeTF),egret.Tween.get(this._noticeTF).to({x:45-this._noticeTF.textWidth},i).call(function(){t._noticeTF.x=t._bg.width+5,t._noticeIndex++,t.nextNotice()},this)},e.prototype.initView=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("ui_json.noticeBg"),this.addChild(this._bg);var t=new egret.Shape;t.graphics.beginFill(0),t.graphics.drawRect(0,0,336,this._bg.height),this.addChild(t),t.x=40,this._noticeTF=new egret.TextField,this._noticeTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._noticeTF.textColor=16777215,this._noticeTF.size=16,this._noticeTF.textAlign=egret.HorizontalAlign.LEFT,this.addChild(this._noticeTF),this._noticeTF.text="",this._noticeTF.x=this._bg.width+5,this._noticeTF.y=6,this._noticeTF.mask=t,this.visible=!1},e}(egret.Sprite);__reflect(NoticeView.prototype,"NoticeView");var OtherPlayerView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setCompareFlag=function(t){this._compareFlag.visible=t,this._compareFlag.visible?this._faceImg.touchEnabled=!1:this._faceImg.touchEnabled=!0},e.prototype.getPosition=function(){return this._position},e.prototype.setPosition=function(t){this._position=t,t>=2&&6>=t&&(this._cardGroup.x=-89),this._kanpaied.x=this._cardGroup.x+(this._cardGroup.width-96>>1),this._kanpaied.y=77,this._giveuped.x=this._cardGroup.x+(this._cardGroup.width-96>>1),this._giveuped.y=77,this._bipaiFail.x=this._cardGroup.x+(this._cardGroup.width-96>>1),this._bipaiFail.y=77},e.prototype.setData=function(e){t.prototype.setData.call(this,e)},e.prototype.reset=function(){t.prototype.reset.call(this)},e.prototype.initView=function(){t.prototype.initView.call(this),this._cardGroup.isMySelf=!1,this._kanpaied.x=this._cardGroup.x+6,this._kanpaied.y=this._cardGroup.y+50,this._giveuped.x=this._cardGroup.x+6,this._giveuped.y=this._cardGroup.y+50,this._bipaiFail.x=this._cardGroup.x+6,this._bipaiFail.y=this._cardGroup.y+50,this._compareFlag=new egret.Bitmap,this._compareFlag.texture=RES.getRes("game_json.bi"),this.addChild(this._compareFlag),this._compareFlag.anchorOffsetX=.5*this._compareFlag.width,this._compareFlag.anchorOffsetY=.5*this._compareFlag.height,this._compareFlag.x=this.x+this._faceImg.x+.5*this._faceImg.width,this._compareFlag.y=this.y+this._faceImg.y+.5*this._faceImg.height,this._compareFlag.visible=!1},e}(PlayerView);__reflect(OtherPlayerView.prototype,"OtherPlayerView");var PlayerBaseInfoView=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.setPlayerInfo=function(t){null!=t&&(this._data=t,this._nickNameTF.text=t.nickName,this.loadFace(t.headImgUrl))},e.prototype.loadFace=function(t){var e=new egret.URLLoader;e.dataFormat=egret.URLLoaderDataFormat.TEXTURE,e.addEventListener(egret.Event.COMPLETE,this.imageComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFaceError,this);var i=new egret.URLRequest(t);e.load(i)},e.prototype.onLoadFaceError=function(t){console.log("load face ioerror")},e.prototype.imageComplete=function(t){console.log("load face complete"),this._faceImg.texture=t.target.data,this._faceImg.width=101,this._faceImg.height=96},e.prototype.initView=function(){this._faceBg=new egret.Bitmap,this._faceBg.texture=RES.getRes("game_json.faceBg"),this.addChild(this._faceBg),this._faceImg=new egret.Bitmap,this._faceImg.texture=RES.getRes("game_json.testFace"),this._faceImg.x=7,this._faceImg.y=28,this.addChild(this._faceImg),this._nickNameTF=new egret.TextField,this._nickNameTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._nickNameTF.size=16,this._nickNameTF.textColor=16777215,this._nickNameTF.textAlign=egret.HorizontalAlign.CENTER,this._nickNameTF.width=104,this._nickNameTF.x=6,this._nickNameTF.y=4,this.addChild(this._nickNameTF),this._nickNameTF.text="...",this._goldTF=new egret.TextField,this._goldTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._goldTF.size=20,this._goldTF.textColor=16767830,this._goldTF.textAlign=egret.HorizontalAlign.CENTER,this._goldTF.width=104,this._goldTF.x=6,this._goldTF.y=131,this.addChild(this._goldTF),this._goldTF.text="0"},e}(egret.Sprite);__reflect(PlayerBaseInfoView.prototype,"PlayerBaseInfoView");var PlayerInfoView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.setData=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var i="",n="";if(null==t?(n=MyUserInfo.getInstance().userName,this._userIdTF.text=MyUserInfo.getInstance().userId,this._ipTF.text=MyUserInfo.getInstance().ip,i=MyUserInfo.getInstance().faceUrl):(n=t.nickName,this._userIdTF.text=t.playerId,this._ipTF.text=t.ip,i=t.headImgUrl,this._ipTF.text=t.ip),n.length>10&&(n=n.substr(0,10)+"..."),this._nickNameTF.text=n,e){GameEventManager.removeEvent(NetAction.playerInfo.toString(),this.onPlayerInfoResponse,this),GameEventManager.addEvent(NetAction.playerInfo.toString(),this.onPlayerInfoResponse,this);var t={};t.msgType=NetAction.playerInfo,t.token=GameModel.instance().token,SocketCommand.getInstance().send(t)}this._faceImg.texture=RES.getRes("game_json.testFace"),this._faceImg.width=124,this._faceImg.height=124,this.loadFace(i)},e.prototype.onPlayerInfoResponse=function(t){var e=t.data,i=e.data;null!=i.address&&(this._ipTF.text=i.address)},e.prototype.loadFace=function(t){var e=new egret.ImageLoader;e.addEventListener(egret.Event.COMPLETE,this.imageComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFaceError,this),e.load(t)},e.prototype.onLoadFaceError=function(t){console.log("load face ioerror")},e.prototype.imageComplete=function(t){console.log("load face complete"),this._faceImg.texture=t.target.data,this._faceImg.width=124,this._faceImg.height=124},e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("selfInfoBg_png"),this.addChild(this._bg),this._closeBtn=new DButton("ui_json.closeBtn"),this.addChild(this._closeBtn),this._closeBtn.x=467,this._closeBtn.y=50;var t=new egret.Bitmap;t.texture=RES.getRes("ui_json.faceImg2"),this.addChild(t),t.x=54,t.y=166,this._faceImg=new egret.Bitmap,this.addChild(this._faceImg),this._faceImg.x=54,this._faceImg.y=166,this._faceImg.mask=t,this._nichengImg=new egret.Bitmap,this._nichengImg.texture=RES.getRes("ui_json.nicheng-text"),this.addChild(this._nichengImg),this._nichengImg.x=194,this._nichengImg.y=181,this._nickNameTF=new egret.TextField,this._nickNameTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._nickNameTF.textColor=9063179,this._nickNameTF.size=25,this._nickNameTF.textAlign=egret.HorizontalAlign.LEFT,this.addChild(this._nickNameTF),this._nickNameTF.x=267,this._nickNameTF.y=176,this._nickNameTF.text=MyUserInfo.getInstance().userName,this._userIdTF=new egret.TextField,this._userIdTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._userIdTF.textColor=9063179,this._userIdTF.size=25,this._userIdTF.textAlign=egret.HorizontalAlign.LEFT,this.addChild(this._userIdTF),this._userIdTF.x=267,this._userIdTF.y=214,this._userIdTF.text=MyUserInfo.getInstance().userId,this._ipTF=new egret.TextField,this._ipTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._ipTF.textColor=9063179,this._ipTF.size=25,this._ipTF.textAlign=egret.HorizontalAlign.LEFT,this.addChild(this._ipTF),this._ipTF.x=267,this._ipTF.y=251,this._ipTF.text=MyUserInfo.getInstance().ip,this.iframeWidth=this.width,this.iframeHeight=this.height;var e=new egret.Shape;e.graphics.beginFill(0,.5),e.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),e.graphics.endFill(),this.addChildAt(e,0),e.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,e.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this.setData()},e.prototype.onTouchTap=function(t){GameGlobal.iframeLayer.hideIFrame(e)},e}(IFrameBase);__reflect(PlayerInfoView.prototype,"PlayerInfoView");var PlayerInfoView2=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.setData=function(t){void 0===t&&(t=null),this._data=t;var e="";this._ipTF.text="",this._distanceTF.text="";var i="";if(null==t)i=MyUserInfo.getInstance().userName,this._userIdTF.text=MyUserInfo.getInstance().userId,this._ipTF.text=MyUserInfo.getInstance().ip,e=MyUserInfo.getInstance().faceUrl,this._distanceTF.text="";else{i=t.nickName,this._userIdTF.text="ID："+t.playerId,this._ipTF.text=t.ip,e=t.headImgUrl,GameEventManager.removeEvent(NetAction.playerInfo.toString(),this.onPlayerInfoResponse,this),GameEventManager.addEvent(NetAction.playerInfo.toString(),this.onPlayerInfoResponse,this);var n={};n.msgType=NetAction.playerInfo,n.token=GameModel.instance().token,n.msg={otherPlayerId:t.playerId},SocketCommand.getInstance().send(n)}i.length>8&&(i=i.substr(0,8)+"..."),this._nickNameTF.text=i,this.loadFace(e)},e.prototype.onPlayerInfoResponse=function(t){var e=t.data,i=e.data;this._distanceTF.text=i.distance},e.prototype.loadFace=function(t){var e=new egret.ImageLoader;e.addEventListener(egret.Event.COMPLETE,this.imageComplete,this),e.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFaceError,this),e.load(t)},e.prototype.onLoadFaceError=function(t){console.log("load face ioerror")},e.prototype.imageComplete=function(t){console.log("load face complete"),this._faceImg.texture=t.target.data,this._faceImg.width=105,this._faceImg.height=108},e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("infoBg_png"),this.addChild(this._bg),this._faceImg=new egret.Bitmap,this.addChild(this._faceImg),this._faceImg.x=55,this._faceImg.y=42,this._nickNameTF=new egret.TextField,this._nickNameTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._nickNameTF.textColor=16777215,this._nickNameTF.size=29,this._nickNameTF.bold=!0,this._nickNameTF.textAlign=egret.HorizontalAlign.LEFT,this.addChild(this._nickNameTF),this._nickNameTF.x=192,this._nickNameTF.y=35,this._nickNameTF.text="--",this._userIdTF=new egret.TextField,this._userIdTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._userIdTF.textColor=16777215,this._userIdTF.size=25,this._userIdTF.bold=!0,this._userIdTF.textAlign=egret.HorizontalAlign.LEFT,this.addChild(this._userIdTF),this._userIdTF.x=194,this._userIdTF.y=81,this._ipTF=new egret.TextField,this._ipTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._ipTF.textColor=16777215,this._ipTF.size=25,this._ipTF.bold=!0,this._ipTF.textAlign=egret.HorizontalAlign.LEFT,this.addChild(this._ipTF),this._ipTF.x=194,this._ipTF.y=118,this._distanceTF=new egret.TextField,this._distanceTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,this._distanceTF.textColor=16777215,this._distanceTF.size=25,this._distanceTF.bold=!0,this._distanceTF.textAlign=egret.HorizontalAlign.LEFT,this.addChild(this._distanceTF),this._distanceTF.x=194,this._distanceTF.y=155,this._xhImg=new DButton("emotion_json.xh"),this._xhImg.x=35,this._xhImg.y=208,this.addChild(this._xhImg),this._xhImg=new DButton("emotion_json.xh"),this._xhImg.x=35,this._xhImg.y=208,this.addChild(this._xhImg),this._pjImg=new DButton("emotion_json.pj"),this._pjImg.x=133,this._pjImg.y=202,this.addChild(this._pjImg),this._jdImg=new DButton("emotion_json.jd"),this._jdImg.x=221,this._jdImg.y=204,this.addChild(this._jdImg),this._dzhImg=new DButton("emotion_json.dzh"),this._dzhImg.x=294,this._dzhImg.y=205,this.addChild(this._dzhImg),this._hcImg=new DButton("emotion_json.hc"),this._hcImg.x=372,this._hcImg.y=213,this.addChild(this._hcImg),this._closeBtn=new DButton("game_json.closeBtn3"),this.addChild(this._closeBtn),this._closeBtn.x=385,this._closeBtn.y=-29,this.iframeWidth=this.width,this.iframeHeight=this.height;var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,t.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._xhImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._pjImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._jdImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._dzhImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._hcImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.hide=function(){GameEventManager.removeEvent(NetAction.playerInfo.toString(),this.onPlayerInfoResponse,this)},e.prototype.onTouchTap=function(t){if(t.currentTarget==this._closeBtn)GameGlobal.iframeLayer.hideIFrame(e);else{var i="xh";t.currentTarget==this._xhImg||(t.currentTarget==this._pjImg?i="pj":t.currentTarget==this._jdImg?i="jd":t.currentTarget==this._dzhImg?i="dzh":t.currentTarget==this._hcImg&&(i="hc"));var n={};n.msgType=NetAction.chatMsg,n.msg={chatType:5,chatMsg:i,otherPlayerId:this._data.playerId},SocketCommand.getInstance().send(n),GameGlobal.iframeLayer.hideIFrame(e)}},e}(IFrameBase);__reflect(PlayerInfoView2.prototype,"PlayerInfoView2");var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._jsSDK=new JSSDK,e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e._game=null,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),egret.Capabilities.isMobile||(this.stage.scaleMode=egret.StageScaleMode.SHOW_ALL,this.stage.orientation="auto"),GameGlobal.init(this,this.stage),window.isUseWeixin&&(GameGlobal.useWeixin=window.isUseWeixin()),window.getCdnUrl&&(GameGlobal.CDN_URL=window.getCdnUrl()),window.getHttpApi&&(GameGlobal.HTTP_API_URL=window.getHttpApi()),window.getToken&&(GameGlobal.token=window.getToken()),window.getRoomId&&(GameGlobal.roomId=window.getRoomId()),window.getPlayerNumLimit&&(GameGlobal.playerNumLimit=window.getPlayerNumLimit()),this.addChild(this._jsSDK),GameGlobal.jssdk=this._jsSDK,RES.registerVersionController(new DefaultVersionController),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/"),this.showVersion()},e.prototype.shareComplete=function(){},e.prototype.createLogTF=function(){},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("loading",1),RES.loadGroup("sound",0)},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()},e.prototype.onResourceLoadComplete=function(t){this._logTF.text="onResourceLoadComplete!!!","preload"==t.groupName?(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.isResourceLoadEnd=!0,this.createScene()):"loading"==t.groupName?(this._logTF.text="loading complete!!!",this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.loadGroup("preload"),this.showVersion()):"sound"==t.groupName&&(this._logTF.text="load sound complete!!!",SoundManager.instance.playMusic("preloadMusic_mp3"))},e.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){this._logTF.text="Group:"+t.groupName+" has failed to load",console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.startCreateScene=function(){GameEventManager.addEvent(GameEventManager.LOGIN_SUCCESS,this.onLoginSuccess,this);var t=this;egret.ExternalInterface.addCallback("loginCallBack",function(e){LogUtils.log("app call::loginCallBack"),GameModel.instance().code=e;var i=new CommandVo;i.action=HttpCommand.LOGIN,HttpCommand.send(i,t,t.loginResponse)}),this.loadingView&&this.loadingView.showLogin(),egret.ExternalInterface.addCallback("exitGame",function(e){LogUtils.log("exitGameCallBack"),AlertView.getInstance().setConfirmCallBack(t.quitConfirm,t),AlertView.getInstance().show("确定要离开游戏吗？",AlertView.CONFIRM_MODE)}),egret.ExternalInterface.addCallback("sendLog",function(e){t._logTF.appendText(e+"\n")})},e.prototype.loginResponse=function(t){LogUtils.log("loginResponse");var e=t.data;MyUserInfo.getInstance().init(e),GameGlobal.SOCKET_IP=e.serverIp,GameGlobal.SOCKET_PORT=e.port,GameModel.instance().token=e.token,egret.ExternalInterface.call("sendToken",GameGlobal.UPDATE_VOICE_API+"|"+GameModel.instance().token),e.hasOwnProperty("roomId")&&null!=e.roomId&&(GameModel.instance().roomId=e.roomId),this.onLoginSuccess()},e.prototype.showVersion=function(){null==this._versionTF&&(this._versionTF=new egret.TextField,this._versionTF.textAlign=egret.HorizontalAlign.LEFT,this._versionTF.textColor=16777215,this._versionTF.size=14,this._versionTF.text="v"+GameGlobal.version,GameGlobal.stage.addChild(this._versionTF),this._versionTF.x=GameGlobal.stageW-this._versionTF.textWidth-10,this._versionTF.y=GameGlobal.stageH-this._versionTF.textHeight-10,this._versionTF.touchEnabled=!0,this._versionTF.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchVersion,this)),this._versionTF.visible=!0,this.showLog()},e.prototype.onTouchVersion=function(t){this._logTF.text=""},e.prototype.showLog=function(){null==this._logTF&&(this._logTF=new egret.TextField,this._logTF.textAlign=egret.HorizontalAlign.LEFT,this._logTF.textColor=16777215,this._logTF.size=14,this._logTF.text="",this._logTF.x=10,this._logTF.y=10,this._logTF.width=300,this._logTF.multiline=!0,this._logTF.wordWrap=!0,this._logTF.visible=!1,GameGlobal.logTF=this._logTF),GameGlobal.stage.addChild(this._logTF)},e.prototype.onLoginSuccess=function(t){void 0===t&&(t=null),LogUtils.log("onLoginSuccess"),GameEventManager.addEvent(GameEventManager.SOCKET_CONNECTED,this.onSocketConnected,this),SocketCommand.getInstance().connect(),DataLoading.getInstance().show()},e.prototype.onSocketConnected=function(t){if(LogUtils.log("onSocketConnected"),GameEventManager.removeEvent(GameEventManager.SOCKET_CONNECTED,this.onSocketConnected,this),0!=GameModel.instance().roomId)""!=GameGlobal.roomId?(AlertView.getInstance().setConfirmCallBack(this.startGame,this),AlertView.getInstance().show("您已经在房间中（房间号："+GameModel.instance().roomId+"），点击确认直接进入",AlertView.ALERT_MODE)):this.startGame();else{GameEventManager.addEvent(NetAction.enterHall.toString(),this.onEnterHallResponse,this);var e={};e.msgType=NetAction.enterHall,e.gameType=0,e.token=GameModel.instance().token,e.msg={playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(e)}},e.prototype.onEnterHallResponse=function(t){if(void 0===t&&(t=null),GameEventManager.removeEvent(NetAction.enterHall.toString(),this.onEnterHallResponse,this),DataLoading.getInstance().hide(),this.startGame(),""!=GameGlobal.roomId){DataLoading.getInstance().show();var e=GameGlobal.roomId,i={};i.msgType=NetAction.enterRoom,i.msg={roomId:e,playerId:MyUserInfo.getInstance().userId},SocketCommand.getInstance().send(i)}},e.prototype.startGame=function(){DataLoading.getInstance().hide(),this.loadingView&&this.stage.contains(this.loadingView)&&this.stage.removeChild(this.loadingView),this._game=new Game,this.addChild(this._game),this._game.init(),egret.ExternalInterface.addCallback("getPositionCallBack",function(t){var e=t.split("|"),i=e[0],n=e[1],a=e[2];MyUserInfo.getInstance().longitude=i,MyUserInfo.getInstance().latitude=n,MyUserInfo.getInstance().city=a;var s={};s.msgType=NetAction.updatePosition,s.token=GameModel.instance().token,s.gameType=0,s.msg={address:MyUserInfo.getInstance().city,x:i,y:n},SocketCommand.getInstance().send(s)}),LogUtils.log("call app::getPosition"),egret.ExternalInterface.call("getPosition","getPosition")},e.prototype.quitConfirm=function(){egret.ExternalInterface.call("exitGame","exitGame")},e}(eui.UILayer);__reflect(Main.prototype,"Main");var RuleView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("ruleBg_png"),this.addChild(this._bg),this._ruleImg=new egret.Bitmap,this._ruleImg.texture=RES.getRes("helpText_png"),this.addChild(this._ruleImg),this._scrollView=new egret.ScrollView,this._scrollView.setContent(this._ruleImg),this._scrollView.width=this.width,this._scrollView.height=310,this.addChild(this._scrollView),this._scrollView.horizontalScrollPolicy="off",this._scrollView.x=81,this._scrollView.y=176,this._closeBtn=new DButton("ui_json.closeBtn"),this.addChild(this._closeBtn),this._closeBtn.x=787,this._closeBtn.y=37,this.iframeWidth=this.width,this.iframeHeight=540;var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,t.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onTouchTap=function(t){GameGlobal.iframeLayer.hideIFrame(e)},e}(IFrameBase);__reflect(RuleView.prototype,"RuleView");var SelfInfoView=function(t){function e(){var e=t.call(this)||this;e._bg=new egret.Bitmap,e._bg.texture=RES.getRes("ui_json.selfInfoBg"),e.addChild(e._bg),e._faceImg=new egret.Bitmap,e._faceImg.x=28,e._faceImg.y=17,e.addChild(e._faceImg),e._maskImg=new egret.Bitmap,e._maskImg.texture=RES.getRes("ui_json.faceKuang"),e.addChild(e._maskImg),e._maskImg.x=28,e._maskImg.y=17,e._faceImg.mask=e._maskImg,e._fangkaImg=new egret.Bitmap,e._fangkaImg.texture=RES.getRes("ui_json.fangka"),e.addChild(e._fangkaImg),e._fangkaImg.x=109,e._fangkaImg.y=70,e._nickNameTF=new egret.TextField,e._nickNameTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,e._nickNameTF.textColor=16777215,e._nickNameTF.bold=!0,e._nickNameTF.size=17,e._nickNameTF.textAlign=egret.HorizontalAlign.LEFT,e._nickNameTF.x=112,e._nickNameTF.y=19,e.addChild(e._nickNameTF);var i=MyUserInfo.getInstance().userName;return i.length>12&&(i=i.substr(0,12)+"..."),e._nickNameTF.text=i,e._idTF=new egret.TextField,e._idTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,e._idTF.textColor=16777215,e._idTF.bold=!0,e._idTF.size=17,e._idTF.textAlign=egret.HorizontalAlign.LEFT,e._idTF.x=112,e._idTF.y=46,e.addChild(e._idTF),e._idTF.text="ID："+MyUserInfo.getInstance().userId,e._fangkaTF=new egret.TextField,e._fangkaTF.fontFamily=GameGlobal.DEFAULT_FONT_NAME,e._fangkaTF.textColor=16777215,e._fangkaTF.bold=!0,e._fangkaTF.size=17,e._fangkaTF.textAlign=egret.HorizontalAlign.LEFT,e._fangkaTF.x=138,e._fangkaTF.y=76,e.addChild(e._fangkaTF),e._fangkaTF.text=MyUserInfo.getInstance().gold.toString(),e._addBtn=new DButton("ui_json.addFangkaBtn"),e.addChild(e._addBtn),e._addBtn.x=213,e._addBtn.y=70,e._faceImg.touchEnabled=!0,e._faceImg.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onTouchTap,e),e._addBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onTouchTap,e),GameEventManager.addEvent(GameEventManager.UPDATE_USER_GOLD,e.updateUserGold,e),e.loadFace(),e
}return __extends(e,t),e.prototype.loadFace=function(){var t=new egret.ImageLoader;t.addEventListener(egret.Event.COMPLETE,this.imageComplete,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFaceError,this),t.load(MyUserInfo.getInstance().faceUrl)},e.prototype.updateUserGold=function(t){this._fangkaTF.text=MyUserInfo.getInstance().gold.toString()},e.prototype.onLoadFaceError=function(t){console.log("load face ioerror")},e.prototype.imageComplete=function(t){console.log("load face complete"),this._faceImg.texture=t.target.data,this._faceImg.width=this._maskImg.width,this._faceImg.height=this._maskImg.height},e.prototype.onTouchTap=function(t){t.currentTarget==this._addBtn||GameGlobal.iframeLayer.showIFrame(PlayerInfoView)},e}(egret.Sprite);__reflect(SelfInfoView.prototype,"SelfInfoView");var SettingView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("setBg_png"),this.addChild(this._bg),this._closeBtn=new DButton("ui_json.closeBtn"),this.addChild(this._closeBtn),this._closeBtn.x=467,this._closeBtn.y=44,this._musicOn=new egret.Bitmap,this._musicOn.texture=RES.getRes("ui_json.musicOn"),this.addChild(this._musicOn),this._musicOn.x=87,this._musicOn.y=167,this._soundOn=new egret.Bitmap,this._soundOn.texture=RES.getRes("ui_json.musicOn"),this.addChild(this._soundOn),this._soundOn.x=87,this._soundOn.y=235,this._musicToggle=new DToggleButton,this._musicToggle.x=329,this._musicToggle.y=166,this.addChild(this._musicToggle),this._soundToggle=new DToggleButton,this._soundToggle.x=329,this._soundToggle.y=235,this.addChild(this._soundToggle),this.iframeWidth=this.width,this.iframeHeight=this.height;var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,t.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._musicToggle.addEventListener(DEvent.CHANGE,this.onMusicToggle,this),this._soundToggle.addEventListener(DEvent.CHANGE,this.onSoundToggle,this)},e.prototype.onTouchTap=function(t){GameGlobal.iframeLayer.hideIFrame(e)},e.prototype.onMusicToggle=function(t){var e=this._musicToggle.isSelected;this._musicOn.texture=e?RES.getRes("ui_json.musicOn"):RES.getRes("ui_json.musicOff"),SoundManager.instance.isMusicOn=e},e.prototype.onSoundToggle=function(t){var e=this._soundToggle.isSelected;this._soundOn.texture=e?RES.getRes("ui_json.musicOn"):RES.getRes("ui_json.musicOff"),SoundManager.instance.isSoundOn=e},e}(IFrameBase);__reflect(SettingView.prototype,"SettingView");var ShareGuideView=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.getInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.show=function(){GameGlobal.stage.addChild(this)},e.prototype.hide=function(){GameGlobal.stage.contains(this)&&GameGlobal.stage.removeChild(this)},e.prototype.initView=function(){this._img=new egret.Bitmap,this._img.texture=RES.getRes("guide_png"),this.addChild(this._img);var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),this._img.x=GameGlobal.stageW-this._img.width,this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapHandle,this)},e.prototype.onTouchTapHandle=function(t){this.hide()},e}(egret.Sprite);__reflect(ShareGuideView.prototype,"ShareGuideView");var ShareResultView=function(t){function e(){var e=t.call(this)||this;return e._faceImgDiv=null,e.initView(),e}return __extends(e,t),e.getInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.show=function(){GameGlobal.stage.addChild(this);var t=document.body.clientWidth,e=document.body.clientHeight;GameGlobal.gameDiv=document.getElementById("gameDiv"),this._faceImgDiv=document.createElement("img");.5*(t-GameGlobal.stageW),.5*(e-GameGlobal.stageH);this._faceImgDiv.src=GameGlobal.resultImgBase64,this._faceImgDiv.style.position="absolute",GameGlobal.gameDiv.appendChild(this._faceImgDiv),this._faceImgDiv.style.width="100%"},e.prototype.hide=function(){GameGlobal.stage.contains(this)&&GameGlobal.stage.removeChild(this),this._faceImgDiv&&this._faceImgDiv.src&&GameGlobal.gameDiv.removeChild(this._faceImgDiv)},e.prototype.initView=function(){var t=new egret.Shape;t.graphics.beginFill(0),t.graphics.drawRect(0,0,GameGlobal.stageW,GameGlobal.stageH),t.graphics.endFill(),this.addChild(t),this.touchEnabled=!0},e.prototype.onTouchTapHandle=function(t){this.hide()},e}(egret.Sprite);__reflect(ShareResultView.prototype,"ShareResultView");var ShareView=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.showComplete=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("shareBg_png"),this.addChild(this._bg),this._closeBtn=new DButton("ui_json.closeBtn"),this.addChild(this._closeBtn),this._closeBtn.x=467,this._closeBtn.y=44,this._shareBtn=new DButton("ui_json.shareWeixinBtn"),this.addChild(this._shareBtn),this._shareBtn.x=74,this._shareBtn.y=161,this._shareBtn2=new DButton("ui_json.shareWeixinBtn2"),this.addChild(this._shareBtn2),this._shareBtn2.x=284,this._shareBtn2.y=161,this.iframeWidth=this.width,this.iframeHeight=this.height;var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRect(0,0,GameGlobal.stage.stageWidth,GameGlobal.stage.stageHeight),t.graphics.endFill(),this.addChildAt(t,0),t.x=-(GameGlobal.stage.stageWidth-this.iframeWidth)>>1,t.y=-(GameGlobal.stage.stageHeight-this.iframeHeight)>>1,this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this),this._shareBtn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTap,this)},e.prototype.onTouchTap=function(t){t.currentTarget==this._closeBtn?GameGlobal.iframeLayer.hideIFrame(e):t.currentTarget==this._shareBtn||t.currentTarget==this._shareBtn2},e}(IFrameBase);__reflect(ShareView.prototype,"ShareView");